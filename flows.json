[{"id":"ef48c238.0f7e8","type":"tab","label":"A/D Scale "},{"id":"12124d8b.4d0582","type":"tab","label":"remote-connection"},{"id":"ad95d4a5.52ad28","type":"tab","label":"UPS "},{"id":"3d4d40c4.e1825","type":"tab","label":"Horn/Buzzer"},{"id":"64a9fd5e.6ad034","type":"tab","label":"Auto Tune"},{"id":"53d40aa7.5b81e4","type":"tab","label":"VIS Input/Output"},{"id":"20f50063.3774f","type":"tab","label":"Setpoints"},{"id":"f0743a39.64d748","type":"tab","label":"Control"},{"id":"2c485e.00c557a2","type":"tab","label":"Digital Inputs/Outputs"},{"id":"6071e158.8de25","type":"tab","label":"Runtimes and counters"},{"id":"8e16fc15.cc08a","type":"tab","label":"Network"},{"id":"cca480c2.ef11a","type":"tab","label":"Startup"},{"id":"effccbe2.760e38","type":"tab","label":"wlan0"},{"id":"b06e8bbc.e7da68","type":"tab","label":"Eth0"},{"id":"4575c9f5.6d3c98","type":"tab","label":"Test Modbus"},{"id":"7283d585.e71dec","type":"json-db-collection","z":"","name":"","collection":"setBC","save":true},{"id":"ead59310.5540f","type":"json-db-collection","z":"","name":"","collection":"setBR","save":true},{"id":"15bbd325.70754d","type":"json-db-collection","z":"","name":"","collection":"setBVC","save":true},{"id":"6ad73776.cbc2a8","type":"json-db-collection","z":"","name":"","collection":"setBV","save":true},{"id":"845fc459.19ca08","type":"json-db-collection","z":"","name":"","collection":"setAC","save":true},{"id":"1cbf6fdb.473b7","type":"json-db-collection","z":"","name":"","collection":"startup","save":true},{"id":"113808e1.92cd37","type":"json-db-collection","z":"20f50063.3774f","name":"setSP0","collection":"setSP00","save":true},{"id":"d84aa291.07366","type":"json-db-collection","z":"20f50063.3774f","name":"setPS1","collection":"setPS01","save":true},{"id":"24ee5abf.b93816","type":"json-db-collection","z":"20f50063.3774f","name":"setSP2","collection":"setSP02","save":true},{"id":"3ad35766.b13238","type":"json-db-collection","z":"20f50063.3774f","name":"setSP3","collection":"setSP03","save":true},{"id":"b11366d7.148a48","type":"json-db-collection","z":"20f50063.3774f","name":"setSP4","collection":"setSP04","save":true},{"id":"63bebb30.430614","type":"json-db-collection","z":"","name":"","collection":"wlan0","save":true},{"id":"6d847241.48231c","type":"json-db-collection","z":"","name":"","collection":"dns","save":true},{"id":"c7bf2fd0.3893d","type":"modbus-client","z":"","name":"","clienttype":"tcp","bufferCommands":true,"stateLogEnabled":true,"tcpHost":"192.168.0.112","tcpPort":"503","tcpType":"DEFAULT","serialPort":"/dev/ttyUSB0","serialType":"RTU-BUFFERD","serialBaudrate":"38400","serialDatabits":"8","serialStopbits":"1","serialParity":"none","serialConnectionDelay":"100","unit_id":"1","commandDelay":"1","clientTimeout":"1000","reconnectTimeout":"2000"},{"id":"84864c39.f78f6","type":"vis in","z":"3d4d40c4.e1825","language":"en","x":172,"y":189,"wires":[["b329db6.029da28"]]},{"id":"f7f1337.6c1f3d","type":"exec","z":"3d4d40c4.e1825","command":"sudo i2cset -y 1 0x6B 0x0e 1047 w","addpay":false,"append":"","useSpawn":"","timer":"","name":"","x":469,"y":126.5,"wires":[[],[],[]]},{"id":"fce256cd.7031b8","type":"inject","z":"3d4d40c4.e1825","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":183,"y":121,"wires":[["f7f1337.6c1f3d"]]},{"id":"b329db6.029da28","type":"exec","z":"3d4d40c4.e1825","command":"sudo i2cset -y 1 0x6B 0x10 10","addpay":false,"append":"","useSpawn":"","timer":"","name":"","x":466,"y":187,"wires":[[],[],[]]},{"id":"607a7b9b.4a20f4","type":"function","z":"2c485e.00c557a2","name":"Input 2: X2","func":"msg.payload = msg.payload[0];\nreturn msg;","outputs":1,"noerr":0,"x":431.5,"y":125.296875,"wires":[["22919791.8eb148"]]},{"id":"1752ca53.ef0e36","type":"function","z":"2c485e.00c557a2","name":"Input 1: X1","func":"msg.payload = msg.payload[0];\nreturn msg;\n\n","outputs":1,"noerr":0,"x":438.8929138183594,"y":67.22544860839844,"wires":[["7b97bf94.72d1e"]]},{"id":"fe2ca684.ce76c8","type":"function","z":"2c485e.00c557a2","name":"Array","func":"\n\nvar newMsgPS1 = { payload: msg.payload [0] };\nvar newMsgPS2 = { payload: msg.payload [1] };\nreturn [newMsgPS1, newMsgPS2];\n","outputs":"2","noerr":0,"x":251.357177734375,"y":423.58258056640625,"wires":[[],[]]},{"id":"a6e21276.7bae1","type":"comment","z":"2c485e.00c557a2","name":"*** Read Modbus Settings ","info":"Global Network Settings\nIP: 169.254.119.60\nMask: 255.255.255.0\nGlobal IP: 169.254.255.255\n\nControl Network Settings\nIP: 169.254.119.10\nMask: 255.255.255.0\nGlobal IP: 169.254.119.1\n\nNode Red Modbus TCP Settings\nIP: 169.254.119.10\nPort: 502\nUnit: 1\n\n\n**Make sure Control Network Settings IP and Node Red Modbus IP address match***\n**Must have Static IP address for Modbus TCP/IP to work properly***\n\n\n\n","x":556.357177734375,"y":28.58258056640625,"wires":[]},{"id":"6ea42281.719d5c","type":"comment","z":"2c485e.00c557a2","name":"Inputs Read Only","info":"","x":170.35717010498047,"y":116.58257865905762,"wires":[]},{"id":"a8a401bf.f438d","type":"comment","z":"2c485e.00c557a2","name":"Output Read/Write ","info":"","x":1136.3571701049805,"y":448.5825881958007,"wires":[]},{"id":"fe59ce7b.924d3","type":"range","z":"2c485e.00c557a2","minin":"0x000","maxin":"0x0520","minout":"0","maxout":"15.00","action":"scale","round":false,"name":"IMPINGER PRESS","x":644.5357666015625,"y":234.18972778320312,"wires":[["93d63a53.0dc328","4c6e86e1.114ff8"]]},{"id":"5a21a609.7a6d68","type":"range","z":"2c485e.00c557a2","minin":"0x000","maxin":"0x0520","minout":"0.00","maxout":"15.00","action":"scale","round":false,"name":"FAN PRESS","x":442.07147216796875,"y":397.5468444824219,"wires":[["acce9aa5.0a89a8","a485ae8.06b775"]]},{"id":"4c6e86e1.114ff8","type":"function","z":"2c485e.00c557a2","name":"custom function","func":"// declare place holder variables\nvar originalval1 = msg.payload;\nvar varps1 = \"\";\n\n\n// convert string of originalval to float with 1 decimal place\n// run originalval thru a simple minus operation to form the 'temp' number\nvarps1 = parseFloat(originalval1).toFixed(1);\n\n// output the originalval after deduction \nmsg.payload = varps1;\n\n\nreturn msg;","outputs":1,"noerr":0,"x":760.6428833007812,"y":330.4397277832031,"wires":[["451f592.c5872a8"]]},{"id":"a485ae8.06b775","type":"function","z":"2c485e.00c557a2","name":"custom function","func":"// declare place holder variables\nvar originalval2 = msg.payload;\nvar varps2 = \"\";\n\n\n// convert string of originalval to float with 1 decimal place\n// run originalval thru a simple minus operation to form the 'temp' number\nvarps2 = parseFloat(originalval2).toFixed(1);\n\n// output the originalval after deduction \nmsg.payload = varps2;\n\n\nreturn msg;","outputs":1,"noerr":0,"x":873.357177734375,"y":376.58258056640625,"wires":[["576c6177.c5183"]]},{"id":"451f592.c5872a8","type":"function","z":"2c485e.00c557a2","name":"actFilt","func":"global.set ('actFilt', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":933.9127197265625,"y":294.8524169921875,"wires":[[]]},{"id":"576c6177.c5183","type":"function","z":"2c485e.00c557a2","name":"actPres","func":"global.set ('actPres', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1123.6746826171875,"y":321.32867431640625,"wires":[["8c458cdf.71e5f"]]},{"id":"e6d6c3b6.41ace","type":"function","z":"2c485e.00c557a2","name":"float","func":"global.set ('flt', msg.payload);\n//if (global.get ('step2')===1) {global.set('flt', 0);}\nreturn msg;","outputs":1,"noerr":0,"x":902.5912818908691,"y":90.85243320465088,"wires":[[]]},{"id":"89661605.aad048","type":"function","z":"2c485e.00c557a2","name":"phase","func":"if (global.get ('phase_check')===0) {global.set('phase', 1);\nreturn msg;}\nelse global.set ('phase', msg.payload); \nreturn msg;","outputs":1,"noerr":0,"x":889.4365158081055,"y":185.99524593353271,"wires":[[]]},{"id":"7b97bf94.72d1e","type":"change","z":"2c485e.00c557a2","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":678.6270141601562,"y":71.42386627197266,"wires":[["e6d6c3b6.41ace"]]},{"id":"22919791.8eb148","type":"change","z":"2c485e.00c557a2","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":691.7698364257812,"y":110.56672668457031,"wires":[["89661605.aad048"]]},{"id":"f86d8aa9.f40bb8","type":"function","z":"2c485e.00c557a2","name":"global get blwr","func":"if (global.get ('blwr') <= 2 && \nglobal.get ('blwr') >0) {\nmsg.payload = 1;\nreturn msg;\n} else\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":505.3413314819336,"y":863.2810134887695,"wires":[["25863c17.d47614"]]},{"id":"16a18181.8666be","type":"inject","z":"2c485e.00c557a2","name":"Inject once at start","topic":"","payload":"","payloadType":"num","repeat":"","crontab":"","once":true,"x":190.13887786865234,"y":603.8762283325195,"wires":[["bb4909e2.ee5838"]]},{"id":"25863c17.d47614","type":"switch","z":"2c485e.00c557a2","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":692.1031723022461,"y":863.8047561645508,"wires":[["954ba0ef.ea0ed"],["954ba0ef.ea0ed"]]},{"id":"954ba0ef.ea0ed","type":"rbe","z":"2c485e.00c557a2","name":"","func":"rbe","gap":"","start":"","inout":"out","x":927.9126052856445,"y":919.7095287867955,"wires":[[]]},{"id":"58c9b7e8.19a5c8","type":"function","z":"2c485e.00c557a2","name":"global get blwr","func":"if (global.get ('blwr') === 2 ) {\nmsg.payload = 1;\nreturn msg;\n} else\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":689.9127426147461,"y":724.2809524536133,"wires":[["512007a.66517f8"]]},{"id":"512007a.66517f8","type":"switch","z":"2c485e.00c557a2","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":884.4841537475586,"y":750.138313293457,"wires":[["7a485094.01233"],["7a485094.01233"]]},{"id":"7a485094.01233","type":"rbe","z":"2c485e.00c557a2","name":"","func":"rbe","gap":"","start":"","inout":"out","x":959.1985092163086,"y":818.7096633911133,"wires":[[]]},{"id":"abce976d.64bc38","type":"function","z":"2c485e.00c557a2","name":"global get ballvalve","func":"if (global.get ('ballvalve') == 1 ) {\nmsg.payload = 1;\nreturn msg;\n} else\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":707.3413314819336,"y":674.2810134887695,"wires":[["69b0006f.cbeb3"]]},{"id":"69b0006f.cbeb3","type":"switch","z":"2c485e.00c557a2","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":899.6269760131836,"y":647.8525466918945,"wires":[["5b4b960d.25d7a8"],[]]},{"id":"35817ce8.2654b4","type":"trigger","z":"2c485e.00c557a2","op1":"","op2":"ddd","op1type":"nul","op2type":"str","duration":"1","extend":false,"units":"s","reset":"99","name":"","x":285.3413314819336,"y":785.602424621582,"wires":[["ab340fb.c92eff","f86d8aa9.f40bb8","633c1a08.97e594"]]},{"id":"bb4909e2.ee5838","type":"delay","z":"2c485e.00c557a2","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":268.1627426147461,"y":726.3881301879883,"wires":[["35817ce8.2654b4"]]},{"id":"ab340fb.c92eff","type":"delay","z":"2c485e.00c557a2","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":271.4127426147461,"y":883.8881912231445,"wires":[["35817ce8.2654b4"]]},{"id":"5b4b960d.25d7a8","type":"trigger","z":"2c485e.00c557a2","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"3","extend":true,"units":"s","reset":"99","name":"valve off delay","x":885.9126815795898,"y":569.566535949707,"wires":[[]]},{"id":"70aef43c.2a131c","type":"change","z":"2c485e.00c557a2","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"filter_pressure","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1286.6269760131836,"y":184.11408233642578,"wires":[["64fb892f.1f34f8"]]},{"id":"8c458cdf.71e5f","type":"change","z":"2c485e.00c557a2","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"scrub_pressure","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1302.6509017944336,"y":291.5667190551758,"wires":[["64fb892f.1f34f8"]]},{"id":"a35684db.4233f8","type":"comment","z":"2c485e.00c557a2","name":"demo mode modification","info":"comment out line 2 for normal operation","x":972.0000228881836,"y":131.61829376220703,"wires":[]},{"id":"7f8b67bb.d5e298","type":"function","z":"2c485e.00c557a2","name":"global set filter_pressure","func":"var filter_pressure = global.get ('filter_pressure') || 0;\nvar newval4 = Math.abs(global.get('actFilt') - global.get ('actPres'));\nglobal.set('filter_pressure', newval4);\nmsg.topic = 'filter_pressure';\nmsg.payload = global.get('filter_pressure');\nreturn msg;","outputs":1,"noerr":0,"x":1144.5000228881836,"y":245.86829376220703,"wires":[["70aef43c.2a131c"]]},{"id":"df1d2409.f23128","type":"inject","z":"2c485e.00c557a2","name":"One Sec PULSE","topic":"","payload":"0","payloadType":"num","repeat":"1","crontab":"","once":true,"x":913.0000228881836,"y":239.86829376220703,"wires":[["7f8b67bb.d5e298"]]},{"id":"633c1a08.97e594","type":"function","z":"2c485e.00c557a2","name":"global get test or  demo mode","func":"if (global.get ('test_mode') ===1) { \nmsg.payload = 1;\nreturn msg;} \nelse\nif (global.get ('demo_mode')===1) {\nmsg.payload = 1;\nreturn msg;}\nelse\nmsg.payload = 0;\nreturn msg;\n","outputs":1,"noerr":0,"x":511.5000228881836,"y":763.868293762207,"wires":[["be72868b.111f68"]]},{"id":"be72868b.111f68","type":"switch","z":"2c485e.00c557a2","name":"switch","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":429.59529876708984,"y":685.4137649536133,"wires":[[],["abce976d.64bc38","58c9b7e8.19a5c8"]]},{"id":"19212d78.e223b3","type":"inject","z":"2c485e.00c557a2","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":912.3571701049805,"y":517.5825881958008,"wires":[[]]},{"id":"ee1fcd5c.fc15f","type":"inject","z":"2c485e.00c557a2","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":1095.3572006225586,"y":628.5825881958008,"wires":[[]]},{"id":"7bf854c7.2a108c","type":"inject","z":"2c485e.00c557a2","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":1062.3572006225586,"y":670.5825881958008,"wires":[[]]},{"id":"678c864e.1ee4c8","type":"inject","z":"2c485e.00c557a2","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":918.3571701049805,"y":459.5825881958007,"wires":[[]]},{"id":"64fb892f.1f34f8","type":"vis in","z":"2c485e.00c557a2","language":"en","x":1538.0000076293945,"y":219.58258438110352,"wires":[[]]},{"id":"ca412788.466ae8","type":"exec","z":"8e16fc15.cc08a","command":"sudo reboot #","addpay":false,"append":"","useSpawn":"","name":"System Reboot","x":655,"y":365,"wires":[[],[],[]]},{"id":"e8a8567c.27acf8","type":"switch","z":"8e16fc15.cc08a","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"reboot","vt":"str"}],"checkall":"true","outputs":1,"x":457,"y":355.5,"wires":[["ca412788.466ae8"]]},{"id":"847006c7.2cac28","type":"exec","z":"8e16fc15.cc08a","command":"sudo ifconfig","addpay":true,"append":"","useSpawn":false,"timer":"","name":"ifconfig","x":438,"y":136.5,"wires":[["424f5350.da3c5c"],[],[]]},{"id":"23b5fd0b.6b17b2","type":"inject","z":"8e16fc15.cc08a","name":"get ip - eth0","topic":"ip","payload":"eth0","payloadType":"str","repeat":"3","crontab":"","once":true,"x":230,"y":103,"wires":[["847006c7.2cac28"]]},{"id":"424f5350.da3c5c","type":"function","z":"8e16fc15.cc08a","name":"Extract network config","func":"// Initialize variables\nvar input, tokens, inet, bcast, mask;\nvar outString = \"CASI \\n\";\n\n// Parse the entire string by spaces, and put each item into an array called tokens\n\ninput = msg.payload;\ntokens = input.split(\":\", 10);\n\n// Get the 7th token (example: \"addr:192.168.0.120\")\n// and get the substring from character 6 to the end\ninet = tokens[7].split(\" \", 1);\noutString += \"\\n\" + \"IP Address: \" + inet[0];\n\n// Get the 8th token (example: \"Bcast:192.168.0.255\")\n// and get the substring from character 7 to the end\nbcast = tokens[8].split(\" \", 1);\noutString += \"\\n\" + \"Bcast: \" + bcast[0];\n\n// Get the 9th token (example: \"Mask:255.255.255.0\")\n// and get the substring from character 6 to the end\nmask = tokens[9].split(\" \", 1);\noutString += \"\\n\" + \"Mask: \" + mask[0];\n\n// Don't send a message if the IF is the known default. Change to default ip.\nif (inet==\"192.168.0.120\") { \n//outString = \"\"; // set output to null if ip is the same so no message is sent\nreturn null;\n}else{\n// return the final output\nreturn {payload: outString};\n}\n","outputs":1,"noerr":0,"x":715.2500076293945,"y":158.75000095367432,"wires":[["9677a8ee.8846f8"]]},{"id":"9677a8ee.8846f8","type":"delay","z":"8e16fc15.cc08a","name":"Delay","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":321,"y":275.5,"wires":[["c2fbb89f.322348"]]},{"id":"c2fbb89f.322348","type":"change","z":"8e16fc15.cc08a","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"network","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":495,"y":275.5,"wires":[["c853d5a.3365a28"]]},{"id":"95962626.a72698","type":"switch","z":"8e16fc15.cc08a","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"ip","vt":"str"}],"checkall":"true","outputs":1,"x":264,"y":178.5,"wires":[["847006c7.2cac28"]]},{"id":"c33eb71.5846748","type":"inject","z":"8e16fc15.cc08a","name":"","topic":"vis.control.data","payload":"{\"val\": \"main/a_home\", \"ack\":true}","payloadType":"json","repeat":"","crontab":"","once":false,"x":102.66667556762695,"y":443.49999618530273,"wires":[["c853d5a.3365a28"]]},{"id":"46a1f22.373780c","type":"debug","z":"8e16fc15.cc08a","name":"","active":true,"console":"false","complete":"false","x":536.5,"y":513.75,"wires":[]},{"id":"53e5f545.ab4c4c","type":"switch","z":"8e16fc15.cc08a","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"nav","vt":"str"}],"checkall":"true","outputs":1,"x":347,"y":491.5,"wires":[["46a1f22.373780c"]]},{"id":"26b3f5a9.03d17a","type":"inject","z":"8e16fc15.cc08a","name":"reboot!","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":285.6666564941406,"y":617.5,"wires":[["fea3f5d6.bac728"]]},{"id":"fea3f5d6.bac728","type":"exec","z":"8e16fc15.cc08a","command":"sudo reboot","addpay":false,"append":"","useSpawn":"","timer":"","name":"reboot Pi","x":521.4523811340332,"y":706.8988380432129,"wires":[[],[],[]]},{"id":"bea1242e.432858","type":"switch","z":"8e16fc15.cc08a","name":"reboot","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reboot","vt":"str"}],"checkall":"true","outputs":1,"x":434.714298248291,"y":563.9286060333252,"wires":[["fea3f5d6.bac728"]]},{"id":"c853d5a.3365a28","type":"vis in","z":"8e16fc15.cc08a","language":"en","x":288.8333536783848,"y":371,"wires":[["95962626.a72698","e8a8567c.27acf8","53e5f545.ab4c4c","bea1242e.432858"]]},{"id":"a54917d.0dd70e8","type":"change","z":"cca480c2.ef11a","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/phase_check","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":535,"y":171.42857933044434,"wires":[["82811296.d1fe1"]]},{"id":"82811296.d1fe1","type":"DataOut","z":"cca480c2.ef11a","collection":"1cbf6fdb.473b7","name":"","path":"/phase_check","error":false,"x":747.1429138183594,"y":170.14287281036377,"wires":[["62cb53d5.9f79dc"]]},{"id":"b4c57573.ea2698","type":"inject","z":"cca480c2.ef11a","name":"","topic":"","payload":"startup","payloadType":"str","repeat":"","crontab":"","once":true,"x":189.2142562866211,"y":161.00001525878906,"wires":[["a54917d.0dd70e8","459e85d3.5191fc","90ef2d89.8f3b3","2824d1c5.b598de"]]},{"id":"62cb53d5.9f79dc","type":"function","z":"cca480c2.ef11a","name":"global set phase_check","func":"var phase_check = global.set('phase_check', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1004.7142333984375,"y":169.00001525878906,"wires":[[]]},{"id":"f6b08b2.80aaa78","type":"comment","z":"cca480c2.ef11a","name":"Read variables from DB on startup","info":"","x":527.5475921630859,"y":110,"wires":[]},{"id":"96e8ac27.9ec85","type":"inject","z":"cca480c2.ef11a","name":"1 SEC PULSE","topic":"","payload":"ddd","payloadType":"str","repeat":"1","crontab":"","once":true,"x":238.99996948242188,"y":711.0951843261719,"wires":[["d76dd997.0332d8","1c327fe9.08327","457f8ba0.c80914","88c4c1b7.5bed7"]]},{"id":"d76dd997.0332d8","type":"function","z":"cca480c2.ef11a","name":"get phase_check","func":"msg.payload = global.get('phase_check');\nmsg.topic = 'phase_check';\nreturn msg;","outputs":1,"noerr":0,"x":566.4126586914062,"y":673,"wires":[["f0e4d973.a406b8"]]},{"id":"23a3b642.14e1fa","type":"change","z":"cca480c2.ef11a","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/phase_check","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":908.4126892089844,"y":673,"wires":[["41e883ab.e7ea5c"]]},{"id":"41e883ab.e7ea5c","type":"DataIn","z":"cca480c2.ef11a","collection":"1cbf6fdb.473b7","name":"","update":false,"path":"/phase_check","x":1109.8412780761719,"y":670.857177734375,"wires":[]},{"id":"f0e4d973.a406b8","type":"rbe","z":"cca480c2.ef11a","name":"","func":"rbe","gap":"","start":"","inout":"out","x":742.4999694824219,"y":673,"wires":[["23a3b642.14e1fa"]]},{"id":"d5ae8a4c.cf79a8","type":"comment","z":"cca480c2.ef11a","name":"Set variables to database if changed","info":"","x":632.5,"y":610,"wires":[]},{"id":"1c327fe9.08327","type":"function","z":"cca480c2.ef11a","name":"get setPhi","func":"msg.payload = global.get('setPhi');\nmsg.topic = 'setPhi';\nreturn msg;","outputs":1,"noerr":0,"x":533.9999694824219,"y":719,"wires":[["8c321a3e.d1df28"]]},{"id":"2bdf6c4a.cc5964","type":"change","z":"cca480c2.ef11a","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/setPhi","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":906,"y":719,"wires":[["986abd10.58826"]]},{"id":"986abd10.58826","type":"DataIn","z":"cca480c2.ef11a","collection":"1cbf6fdb.473b7","name":"","update":false,"path":"/setPhi","x":1087.4285888671875,"y":716.857177734375,"wires":[]},{"id":"8c321a3e.d1df28","type":"rbe","z":"cca480c2.ef11a","name":"","func":"rbe","gap":"","start":"","inout":"out","x":740.0872802734375,"y":719,"wires":[["2bdf6c4a.cc5964"]]},{"id":"457f8ba0.c80914","type":"function","z":"cca480c2.ef11a","name":"get setPlo","func":"msg.payload = global.get('setPlo');\nmsg.topic = 'setPlo';\nreturn msg;","outputs":1,"noerr":0,"x":522.9999694824219,"y":764,"wires":[["dd36291d.0bb028"]]},{"id":"4138a50c.c1a2ec","type":"change","z":"cca480c2.ef11a","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/setPlo","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":895,"y":764,"wires":[["aa1ffd93.36aa8"]]},{"id":"aa1ffd93.36aa8","type":"DataIn","z":"cca480c2.ef11a","collection":"1cbf6fdb.473b7","name":"","update":false,"path":"/setPlo","x":1076.4285888671875,"y":761.857177734375,"wires":[]},{"id":"dd36291d.0bb028","type":"rbe","z":"cca480c2.ef11a","name":"","func":"rbe","gap":"","start":"","inout":"out","x":729.0872802734375,"y":764,"wires":[["4138a50c.c1a2ec"]]},{"id":"88c4c1b7.5bed7","type":"function","z":"cca480c2.ef11a","name":"get setDirt","func":"msg.payload = global.get('setDirt');\nmsg.topic = 'setDirt';\nreturn msg;","outputs":1,"noerr":0,"x":520.9999694824219,"y":813,"wires":[["768b16a9.3cfa28"]]},{"id":"f5d57790.c90a48","type":"change","z":"cca480c2.ef11a","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/setDirt","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":883,"y":813,"wires":[["96a56a45.ed7788"]]},{"id":"96a56a45.ed7788","type":"DataIn","z":"cca480c2.ef11a","collection":"1cbf6fdb.473b7","name":"","update":false,"path":"/setDirt","x":1064.4285888671875,"y":810.857177734375,"wires":[]},{"id":"768b16a9.3cfa28","type":"rbe","z":"cca480c2.ef11a","name":"","func":"rbe","gap":"","start":"","inout":"out","x":717.0872802734375,"y":813,"wires":[["f5d57790.c90a48"]]},{"id":"459e85d3.5191fc","type":"change","z":"cca480c2.ef11a","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/setPhi","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":534,"y":209,"wires":[["2d5458af.d21f88"]]},{"id":"90ef2d89.8f3b3","type":"change","z":"cca480c2.ef11a","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/setPlo","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":536,"y":248,"wires":[["b3bf7f6c.a5927"]]},{"id":"2824d1c5.b598de","type":"change","z":"cca480c2.ef11a","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/setDirt","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":288,"wires":[["840a3204.04113"]]},{"id":"2d5458af.d21f88","type":"DataOut","z":"cca480c2.ef11a","collection":"1cbf6fdb.473b7","name":"","path":"/setPhi","error":false,"x":728,"y":220,"wires":[["4c3ecd1a.cd60d4"]]},{"id":"b3bf7f6c.a5927","type":"DataOut","z":"cca480c2.ef11a","collection":"1cbf6fdb.473b7","name":"","path":"/setPlo","error":false,"x":727,"y":256,"wires":[["c7ba3e0a.4ed57"]]},{"id":"840a3204.04113","type":"DataOut","z":"cca480c2.ef11a","collection":"1cbf6fdb.473b7","name":"","path":"/setDirt","error":false,"x":721,"y":294,"wires":[["145b9afb.3fd6c5"]]},{"id":"4c3ecd1a.cd60d4","type":"function","z":"cca480c2.ef11a","name":"global set setPhi","func":"var setPhi = global.set('setPhi', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":979,"y":210,"wires":[[]]},{"id":"c7ba3e0a.4ed57","type":"function","z":"cca480c2.ef11a","name":"global set setPlo","func":"var setPlo = global.set('setPlo', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":976,"y":251,"wires":[[]]},{"id":"145b9afb.3fd6c5","type":"function","z":"cca480c2.ef11a","name":"global set setDirt","func":"var setDirt = global.set('setDirt', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":978,"y":290,"wires":[[]]},{"id":"65b737ac.bf5da8","type":"inject","z":"cca480c2.ef11a","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":629.5,"y":476,"wires":[["23a3b642.14e1fa","2bdf6c4a.cc5964","4138a50c.c1a2ec","f5d57790.c90a48"]]},{"id":"15414488.9d16db","type":"exec","z":"2c485e.00c557a2","command":"sudo i2cget -y 1 0x69 0x18 w","addpay":true,"append":"","useSpawn":"","timer":"","name":"Analog 1","x":278,"y":262.5,"wires":[["8389c9af.57f788","61391860.d3c098"],[],[]]},{"id":"5621a756.197a48","type":"exec","z":"2c485e.00c557a2","command":"sudo i2cget -y 1 0x69 0x16 w","addpay":true,"append":"","useSpawn":"","timer":"","name":"Analog 2","x":281,"y":327,"wires":[["597f5408.840b0c","495b891e.731a78"],[],[]]},{"id":"26f239de.dc2b46","type":"inject","z":"2c485e.00c557a2","name":"Start ","topic":"","payload":"","payloadType":"num","repeat":"1","crontab":"","once":true,"x":105,"y":260,"wires":[["89ac7e2a.328a2","15414488.9d16db"]]},{"id":"8389c9af.57f788","type":"change","z":"2c485e.00c557a2","name":"newMsgPS1","rules":[{"t":"set","p":"topic","pt":"msg","to":"newMsgPS1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":437,"y":231,"wires":[["fe59ce7b.924d3"]]},{"id":"597f5408.840b0c","type":"change","z":"2c485e.00c557a2","name":"newMsgPS2","rules":[{"t":"set","p":"topic","pt":"msg","to":"newMsgPS2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":436,"y":290,"wires":[["5a21a609.7a6d68"]]},{"id":"fff5b11.a96d55","type":"comment","z":"2c485e.00c557a2","name":"Do not change the Analog Settings","info":"","x":155,"y":226,"wires":[]},{"id":"a243af80.94db1","type":"inject","z":"2c485e.00c557a2","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":828.3333129882812,"y":1098.333251953125,"wires":[[]]},{"id":"58b58d77.6db924","type":"inject","z":"2c485e.00c557a2","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":834.3333129882812,"y":1040.333251953125,"wires":[[]]},{"id":"add06162.6b134","type":"inject","z":"ad95d4a5.52ad28","name":"","topic":"","payload":"","payloadType":"num","repeat":"","crontab":"","once":true,"x":146,"y":123,"wires":[["4df7307c.c79ca"]]},{"id":"4df7307c.c79ca","type":"exec","z":"ad95d4a5.52ad28","command":"sudo /etc/init.d/picofssd start","addpay":false,"append":"","useSpawn":"","timer":"","name":"","x":443,"y":156.5,"wires":[[],[],[]]},{"id":"5b46ef5.4d6631","type":"inject","z":"ad95d4a5.52ad28","name":"","topic":"","payload":"","payloadType":"num","repeat":"10","crontab":"","once":false,"x":171,"y":252,"wires":[["e7467ad.36a7488"]]},{"id":"e7467ad.36a7488","type":"exec","z":"ad95d4a5.52ad28","command":"sudo python modules/pico_status.py","addpay":false,"append":"","useSpawn":"","timer":"","name":"","x":437,"y":229.5,"wires":[["6be3e9a2.088f78"],[],[]]},{"id":"c9eebe74.5bcb1","type":"vis in","z":"ad95d4a5.52ad28","language":"en","x":539,"y":279,"wires":[[]]},{"id":"6be3e9a2.088f78","type":"change","z":"ad95d4a5.52ad28","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"ups_status","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":378,"y":276,"wires":[["c9eebe74.5bcb1"]]},{"id":"f042eddf.288f7","type":"inject","z":"64a9fd5e.6ad034","name":"step 1 1","topic":"step1","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":157.5,"y":167.27375984191895,"wires":[["74d270b4.79ca9"]]},{"id":"a4121db4.48782","type":"inject","z":"64a9fd5e.6ad034","name":"step 1 0","topic":"step1","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":161.03968048095703,"y":125.19439315795898,"wires":[["74d270b4.79ca9"]]},{"id":"e1e54e55.26df4","type":"inject","z":"64a9fd5e.6ad034","name":"step 2 0","topic":"step2","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":168.91665649414062,"y":370.4880714416504,"wires":[["39a365db.c62aaa"]]},{"id":"82680d0c.8fb33","type":"inject","z":"64a9fd5e.6ad034","name":"step 2 1","topic":"step2","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":176.48807907104492,"y":410.34521198272705,"wires":[["39a365db.c62aaa"]]},{"id":"66dfa990.fd8ff8","type":"inject","z":"64a9fd5e.6ad034","name":"step 3 0","topic":"step3","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":164.98807525634766,"y":779.237943649292,"wires":[["3391888e.cee948"]]},{"id":"3809c32f.661d7c","type":"inject","z":"64a9fd5e.6ad034","name":"step 3 1","topic":"step3","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":172.55949783325195,"y":819.0950841903687,"wires":[["3391888e.cee948"]]},{"id":"9bf9a55b.4e0558","type":"inject","z":"64a9fd5e.6ad034","name":"step 4 0","topic":"step4","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":179.09521102905273,"y":926.023509979248,"wires":[["666ebba7.851914"]]},{"id":"c318cab.0f8ef38","type":"inject","z":"64a9fd5e.6ad034","name":"step 4 1","topic":"step4","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":186.66663360595703,"y":965.8806505203247,"wires":[["666ebba7.851914"]]},{"id":"a8639b89.350598","type":"inject","z":"64a9fd5e.6ad034","name":"step 5 0","topic":"step5","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":200.5237922668457,"y":1199.773473739624,"wires":[["8d9cab5d.241b78"]]},{"id":"ddbc3c8b.76a7a","type":"inject","z":"64a9fd5e.6ad034","name":"step 5 1","topic":"step5","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":208.09521484375,"y":1239.6306142807007,"wires":[["8d9cab5d.241b78"]]},{"id":"e94c287e.a86028","type":"inject","z":"64a9fd5e.6ad034","name":"step 6 0","topic":"step6","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":197.84521102905273,"y":1342.0950565338135,"wires":[["2f4ecad5.2759a6"]]},{"id":"9fd57c6f.30dd","type":"inject","z":"64a9fd5e.6ad034","name":"step 6 1","topic":"step6","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":205.41663360595703,"y":1381.9521970748901,"wires":[["2f4ecad5.2759a6"]]},{"id":"9ccd6435.0a7ec8","type":"switch","z":"64a9fd5e.6ad034","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"begin","vt":"str"}],"checkall":"true","outputs":1,"x":795.2778396606445,"y":104.5,"wires":[["26d8a4e5.6ce2dc"]]},{"id":"9649ed55.82d42","type":"function","z":"64a9fd5e.6ad034","name":"step 1","func":"if (global.get('phase')==1 && (global.get ('step1')==1)) {\nglobal.set ('step1',2);\nreturn msg;}\nelse return;","outputs":1,"noerr":0,"x":571.0397262573242,"y":207.70238494873047,"wires":[["244ce1cb.693aae"]]},{"id":"765ee2ff.4d540c","type":"inject","z":"64a9fd5e.6ad034","name":"step 1 2","topic":"step1","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":155.3253936767578,"y":206.03571605682373,"wires":[["74d270b4.79ca9"]]},{"id":"76e0dca9.556f74","type":"inject","z":"64a9fd5e.6ad034","name":"step 2 2","topic":"step2","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":171.99206924438477,"y":440.3214635848999,"wires":[["39a365db.c62aaa"]]},{"id":"9b35f6ab.0e82b8","type":"inject","z":"64a9fd5e.6ad034","name":"step 3 2","topic":"step3","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":164.84920120239258,"y":854.6070718765259,"wires":[["3391888e.cee948"]]},{"id":"c3d4c937.c07318","type":"inject","z":"64a9fd5e.6ad034","name":"step 4 2","topic":"step4","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":184.84918975830078,"y":1008.8926475048065,"wires":[["666ebba7.851914"]]},{"id":"b8acded7.65db9","type":"inject","z":"64a9fd5e.6ad034","name":"step 5 2","topic":"step5","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":203.42062377929688,"y":1280.3211870193481,"wires":[["8d9cab5d.241b78"]]},{"id":"ec7289e3.045a98","type":"inject","z":"64a9fd5e.6ad034","name":"step 6 2","topic":"step6","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":196.2777557373047,"y":1416.0356187820435,"wires":[["2f4ecad5.2759a6"]]},{"id":"b73c2707.56da88","type":"inject","z":"64a9fd5e.6ad034","name":"Auto Tune PULSE","topic":"","payload":"ddd","payloadType":"str","repeat":"1","crontab":"","once":true,"x":168.50397491455078,"y":269.9881477355957,"wires":[["c3ec4008.44e12","b3c9c7c2.e786c8","7c0879df.a85ec8","58906f6a.92ad3","3a9971ed.dae9de","e503dfc5.0744b","bc3d3dbd.7a0b1"]]},{"id":"74d270b4.79ca9","type":"function","z":"64a9fd5e.6ad034","name":"global set step1","func":"global.set('step1',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":381.84920501708984,"y":131.32143211364746,"wires":[[]]},{"id":"c3ec4008.44e12","type":"function","z":"64a9fd5e.6ad034","name":"global get step1","func":"msg.payload = global.get('step1');\nmsg.topic = 'step1';\nif(msg.payload===1){ var tune = global.set ('tune', 1);\n    global.set('gate',0);\n} else \nif(msg.payload===0){ var tune = global.set ('tune', 0);}\nreturn msg;","outputs":1,"noerr":0,"x":380.80162048339844,"y":217.22620296478271,"wires":[["9649ed55.82d42","c07cbcc1.8c5e7"]]},{"id":"98ff8176.6084e","type":"function","z":"64a9fd5e.6ad034","name":"global set step1","func":"if (msg.payload ===0) {global.set('step1', 0 );\n    global.set('step2',0);\n    global.set('step3',0);\n    global.set('step4',0);\n    global.set('step5',0);\n    global.set('step6',0);\n    global.set('step7',0);\n    global.set('blwr', 0);\n    global.set('gate',0);\n}\nif (msg.payload ===1) {global.set('step1', 1);}\nreturn;","outputs":1,"noerr":0,"x":1166.2777786254883,"y":171.75000762939453,"wires":[[]]},{"id":"26d8a4e5.6ce2dc","type":"change","z":"64a9fd5e.6ad034","name":"begin / cancel","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":913.4206695556641,"y":150.321439743042,"wires":[["98ff8176.6084e"]]},{"id":"39a365db.c62aaa","type":"function","z":"64a9fd5e.6ad034","name":"global set step2","func":"global.set('step2',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":400.56349182128906,"y":407.4643039703369,"wires":[[]]},{"id":"b3c9c7c2.e786c8","type":"function","z":"64a9fd5e.6ad034","name":"global get step2","func":"if(global.get('step1')==2) {\nmsg.payload = global.get('step2');\nmsg.topic = 'step2';\nreturn msg;}\nelse {global.set ('step2', 0); msg.topic = 'step2';\n    msg.payload = global.get('step2');\n}\nreturn msg;","outputs":1,"noerr":0,"x":401.99203872680664,"y":348.8928732872009,"wires":[["b2446086.db1da","a8a53776.eed368","c07cbcc1.8c5e7"]]},{"id":"b2446086.db1da","type":"function","z":"64a9fd5e.6ad034","name":"step 2","func":"if (global.get('flt')===0 && global.get ('step2')===1 &&\n global.get('blwr')===0 ) {\nglobal.set ('ballvalve',0);\nglobal.set ('step2',2);\nreturn msg;}\nelse\nif (global.get ('step2')===1 && global.get('test_mode')===1){\nglobal.set ('step2',2);\nreturn msg;}\nelse\nif (global.get ('step2')===1 && global.get('demo_mode')===1){\nglobal.set ('step2',2);\nreturn msg;}\nelse return;","outputs":1,"noerr":0,"x":569.134880065918,"y":318.89285373687744,"wires":[["8374f3df.69a8"]]},{"id":"6bfa68de.bd9828","type":"inject","z":"64a9fd5e.6ad034","name":"BLOWER ON","topic":"blwr","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":177.70635986328125,"y":504.60717010498047,"wires":[["5b1f6e45.45842"]]},{"id":"5b1f6e45.45842","type":"function","z":"64a9fd5e.6ad034","name":"global set blwr","func":"global.set('blwr',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":510.4683074951172,"y":499.8095598220825,"wires":[[]]},{"id":"8c551642.958088","type":"inject","z":"64a9fd5e.6ad034","name":"BLOWER OFF","topic":"blwr","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":183.53968811035156,"y":548.9404735565186,"wires":[["5b1f6e45.45842"]]},{"id":"244ce1cb.693aae","type":"delay","z":"64a9fd5e.6ad034","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":733.4206379481725,"y":198.89286286490324,"wires":[["a1035043.d7df7"]]},{"id":"a1035043.d7df7","type":"function","z":"64a9fd5e.6ad034","name":"global set step1","func":"global.set('step2', 1 );\nreturn;","outputs":1,"noerr":0,"x":927.7063522338867,"y":228.89285850524902,"wires":[[]]},{"id":"c8df756.9155388","type":"inject","z":"64a9fd5e.6ad034","name":"FLOAT:Off 1","topic":"flt","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":189.13492584228516,"y":616.0357828140259,"wires":[["e7847973.7ad168"]]},{"id":"35bd0b83.837ab4","type":"inject","z":"64a9fd5e.6ad034","name":"FLOAT:On 0","topic":"flt","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":204.96824645996094,"y":687.5119438171387,"wires":[["e7847973.7ad168"]]},{"id":"e7847973.7ad168","type":"function","z":"64a9fd5e.6ad034","name":"global set flt","func":"global.set('flt',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":497.37310791015625,"y":571.0000190734863,"wires":[[]]},{"id":"8374f3df.69a8","type":"delay","z":"64a9fd5e.6ad034","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":791.1349029541016,"y":317.8928813934326,"wires":[["36ce66f3.1d3a1a"]]},{"id":"36ce66f3.1d3a1a","type":"function","z":"64a9fd5e.6ad034","name":"global set step3","func":"global.set('step3', 1 );\nreturn;","outputs":1,"noerr":0,"x":1029.134910583496,"y":386.03573513031006,"wires":[[]]},{"id":"a8a53776.eed368","type":"function","z":"64a9fd5e.6ad034","name":"step 2","func":"if (global.get('step2')==1 && global.get ('flt')==1 && global.get('timedout_alarm')===0)\n{global.set ('ballvalve',1);\n    return;}\nif (global.get('step2')==1 && global.get ('flt')===0) \n{global.set ('ballvalve',0);\n    return;}\nelse if (global.get('timedout_alarm')==1) {\nglobal.set ('ballvalve',0);\n    return;}\nmsg.payload=global.get('ballvalve');\nreturn msg;","outputs":1,"noerr":0,"x":603.4206161499023,"y":425.55955696105957,"wires":[[]]},{"id":"3391888e.cee948","type":"function","z":"64a9fd5e.6ad034","name":"global set step 3","func":"global.set('step3',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":416.2777786254883,"y":830.321475982666,"wires":[[]]},{"id":"7c0879df.a85ec8","type":"function","z":"64a9fd5e.6ad034","name":"global get step3","func":"if(global.get('step2')==2) {\nmsg.payload = global.get('step3');\nmsg.topic = 'step3';\nreturn msg;}\nelse {global.set ('step3', 0); msg.topic = 'step3';\n    msg.payload = global.get('step3');\n}\nreturn msg;","outputs":1,"noerr":0,"x":399.23016357421875,"y":726.6071491241455,"wires":[["ec7bbcbc.6c5f3","28f8bc4.a04bc44","c07cbcc1.8c5e7"]]},{"id":"ec7bbcbc.6c5f3","type":"function","z":"64a9fd5e.6ad034","name":"step 3","func":"if (global.get('blwr')===2 && global.get ('step3')===1 ) {\nglobal.set ('step3',2);\nreturn msg;\n}\nreturn ;","outputs":1,"noerr":0,"x":589.134880065918,"y":730.3214308023453,"wires":[["3447a085.afb07"]]},{"id":"3447a085.afb07","type":"delay","z":"64a9fd5e.6ad034","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":794.8491668701172,"y":720.3214522600174,"wires":[["d3f811b6.b00eb"]]},{"id":"d3f811b6.b00eb","type":"function","z":"64a9fd5e.6ad034","name":"global set step4","func":"if(global.get('step3')===2){\nglobal.set('step4', 1 );\nreturn;}","outputs":1,"noerr":0,"x":1047.884994506836,"y":769.7857627868652,"wires":[["241c59fc.a35d86"]]},{"id":"28f8bc4.a04bc44","type":"function","z":"64a9fd5e.6ad034","name":"step 3","func":"if (global.get('step3')===1 ) {\nglobal.set ('blwr',1);\n}\nreturn;","outputs":1,"noerr":0,"x":627.230094909668,"y":823.8928480148315,"wires":[[]]},{"id":"3a9971ed.dae9de","type":"function","z":"64a9fd5e.6ad034","name":"global get step4","func":"if(global.get('step3')==2) {\nmsg.payload = global.get('step4');\nmsg.topic = 'step4';\nreturn msg;}\nelse {global.set ('step4', 0); msg.topic = 'step4';\n    msg.payload = global.get('step4');\n}\nreturn msg;","outputs":1,"noerr":0,"x":390.8016548156738,"y":889.6071524620056,"wires":[["592ae8c3.d37ad8","683a6af7.5e1d94","c07cbcc1.8c5e7"]]},{"id":"ed8ca85c.f1dba8","type":"delay","z":"64a9fd5e.6ad034","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":806.0396575927734,"y":916.0356979370117,"wires":[["63d1d525.234dac"]]},{"id":"63d1d525.234dac","type":"function","z":"64a9fd5e.6ad034","name":"global set step5","func":"global.set('step5', 1 );\nreturn;","outputs":1,"noerr":0,"x":1036.2778282165527,"y":951.7500342130661,"wires":[["241c59fc.a35d86"]]},{"id":"666ebba7.851914","type":"function","z":"64a9fd5e.6ad034","name":"global set step4","func":"global.set('step4',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":439.13491439819336,"y":975.0832853317261,"wires":[[]]},{"id":"7036ccd5.8d5034","type":"inject","z":"64a9fd5e.6ad034","name":"setPres 2","topic":"setPres","payload":"2","payloadType":"num","repeat":"","crontab":"","once":true,"x":179.37302017211914,"y":1084.3690557479858,"wires":[["5ef39c23.1b0e14"]]},{"id":"a0856b5b.42cfc8","type":"inject","z":"64a9fd5e.6ad034","name":"setPres 4","topic":"setPres","payload":"7","payloadType":"num","repeat":"","crontab":"","once":false,"x":179.25395584106445,"y":1136.0833435058594,"wires":[["5ef39c23.1b0e14"]]},{"id":"5ef39c23.1b0e14","type":"function","z":"64a9fd5e.6ad034","name":"global set setPres","func":"global.set('setPres',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":435.7063331604004,"y":1069.8096084594727,"wires":[[]]},{"id":"8d9cab5d.241b78","type":"function","z":"64a9fd5e.6ad034","name":"global set step5","func":"global.set('step5',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":423.4206352233887,"y":1256.035629272461,"wires":[[]]},{"id":"58906f6a.92ad3","type":"function","z":"64a9fd5e.6ad034","name":"global get step5","func":"if(global.get('step4')==2) {\nmsg.payload = global.get('step5');\nmsg.topic = 'step5';\nreturn msg;}\nelse {global.set ('step5', 0); msg.topic = 'step5';\n    msg.payload = global.get('step5');\n}\nreturn msg;","outputs":1,"noerr":0,"x":440.5635108947754,"y":1173.1787507534027,"wires":[["67170ae4.587b34","377d8608.36e30a","408064e8.4d5f8c","241c59fc.a35d86"]]},{"id":"67170ae4.587b34","type":"function","z":"64a9fd5e.6ad034","name":"step 5","func":"if (global.get('step5')===1 ) {\n    var newval1 = global.get ('PS0') - (- global.get ('setPhi'));\n    var newval2 = global.get ('PS0') - global.get ('setPlo');\n    var newval3 = global.get ('setFilt') + global.get ('setDirt');\n    global.set ('oldPhi', newval1);\n    global.set ('oldPlo', newval2); \n    global.set ('oldFilt', newval3);\n}\nreturn msg;","outputs":1,"noerr":0,"x":644.8492088317871,"y":1251.9406089782715,"wires":[["800f15a.0f02ce8","195436a6.178439","b3126041.7e8e2"]]},{"id":"b1fb222e.2b0c3","type":"delay","z":"64a9fd5e.6ad034","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":798.5635032653809,"y":1170.6071128845215,"wires":[["c2ed5919.6d7dd8"]]},{"id":"c2ed5919.6d7dd8","type":"function","z":"64a9fd5e.6ad034","name":"global set step6","func":"global.set('step6', 1 );\nreturn;","outputs":1,"noerr":0,"x":1107.8493423461914,"y":1172.892894744873,"wires":[["241c59fc.a35d86"]]},{"id":"696648b9.22fd98","type":"inject","z":"64a9fd5e.6ad034","name":"setFilt 0.2","topic":"setFilt","payload":".2","payloadType":"num","repeat":"","crontab":"","once":true,"x":669.1349296569824,"y":1053.1785793304443,"wires":[["21528bde.4bc794"]]},{"id":"7eda77d6.b1bc88","type":"inject","z":"64a9fd5e.6ad034","name":"setFilt 0.75","topic":"setFilt","payload":".75","payloadType":"num","repeat":"","crontab":"","once":false,"x":677.8253746032715,"y":1100.3690061569214,"wires":[["21528bde.4bc794"]]},{"id":"21528bde.4bc794","type":"function","z":"64a9fd5e.6ad034","name":"global set setFilt","func":"global.set('setFilt',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":940.4682426452637,"y":1086.9524154663086,"wires":[["241c59fc.a35d86"]]},{"id":"2f4ecad5.2759a6","type":"function","z":"64a9fd5e.6ad034","name":"global set step6","func":"global.set('step6',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":384.8492240905762,"y":1397.4642238616943,"wires":[[]]},{"id":"e503dfc5.0744b","type":"function","z":"64a9fd5e.6ad034","name":"global get step6","func":"if(global.get('step5')==2) {\nmsg.payload = global.get('step6');\nmsg.topic = 'step6';\nreturn msg;}\nelse {global.set ('step6', 0); msg.topic = 'step6';\n    msg.payload = global.get('step6');\n}\nreturn msg;","outputs":1,"noerr":0,"x":430.5634880065918,"y":1337.4642238616943,"wires":[["2f5e4cf1.214fb4","917b9cb1.325f4","241c59fc.a35d86"]]},{"id":"2f5e4cf1.214fb4","type":"function","z":"64a9fd5e.6ad034","name":"step 6","func":"if (global.get('blwr') === 0 && global.get('step6')=== 1) {\nglobal.set ('step6',2);\nglobal.set ('begin',0);\nreturn;\n} else if(global.get('step6')==2){\n    global.set('step1', 0);\n    global.set('step7', 2);\nreturn msg;}\n","outputs":1,"noerr":0,"x":670.563362121582,"y":1351.7499237060547,"wires":[["afdd5339.398ce"]]},{"id":"917b9cb1.325f4","type":"function","z":"64a9fd5e.6ad034","name":"step 6","func":"if (global.get('step6')===1 ) {\n    global.set ('alarm', 0);\n    global.set ('blwr', 3);\n    //global.set ('start_stop', 0);\n}\nreturn;","outputs":1,"noerr":0,"x":676.2777328491211,"y":1433.178518295288,"wires":[[]]},{"id":"71d5be14.c3237","type":"delay","z":"64a9fd5e.6ad034","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":990.5635032653809,"y":1411.7497901916504,"wires":[["241c59fc.a35d86"]]},{"id":"592ae8c3.d37ad8","type":"function","z":"64a9fd5e.6ad034","name":"step 4","func":"if (global.get('step4')==1 ) {\nglobal.set ('setPres', global.get ('PS0'));\nglobal.set ('filtPres', (global.get('PS1')));msg.payload = global.get ('setPres');\nreturn msg; }\nelse msg.payload = global.get ('setPres');\nreturn msg;","outputs":1,"noerr":0,"x":643.8968849182129,"y":956.7500438690186,"wires":[[]]},{"id":"683a6af7.5e1d94","type":"function","z":"64a9fd5e.6ad034","name":"step 4","func":"if (global.get('setPres') > 3 && global.get ('step4')==1 ) {\nglobal.set ('step4', 2 );\nreturn msg;\n} else ;\nreturn;","outputs":1,"noerr":0,"x":636.5159034729004,"y":873.4165954589844,"wires":[["ed8ca85c.f1dba8"]]},{"id":"afdd5339.398ce","type":"rbe","z":"64a9fd5e.6ad034","name":"","func":"rbe","gap":"","start":"","inout":"out","x":824.8491668701172,"y":1384.6071779727936,"wires":[["71d5be14.c3237"]]},{"id":"351c165f.a0211a","type":"inject","z":"64a9fd5e.6ad034","name":"blwr 0","topic":"blwr","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":964.8492126464844,"y":525.1785507202148,"wires":[["20c5b30a.f2ab6c"]]},{"id":"d999c966.ccb968","type":"inject","z":"64a9fd5e.6ad034","name":"blwr 1","topic":"blwr","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":968.1825561523438,"y":568.5119247436523,"wires":[["20c5b30a.f2ab6c"]]},{"id":"20c5b30a.f2ab6c","type":"function","z":"64a9fd5e.6ad034","name":"global set blwr","func":"global.set('blwr',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1192.8492584228516,"y":595.8452739715576,"wires":[["241c59fc.a35d86"]]},{"id":"1462d767.212bd9","type":"inject","z":"64a9fd5e.6ad034","name":"blwr 2","topic":"blwr","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":971.5158843994141,"y":626.8452987670898,"wires":[["20c5b30a.f2ab6c"]]},{"id":"a3b8579b.e9c7b8","type":"inject","z":"64a9fd5e.6ad034","name":"blwr 3","topic":"blwr","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"x":968.1824645996094,"y":678.5118942260742,"wires":[["20c5b30a.f2ab6c"]]},{"id":"800f15a.0f02ce8","type":"function","z":"64a9fd5e.6ad034","name":"oldPhi","func":"msg.payload = global.get('oldPhi');\nmsg.topic = 'oldPhi';\nreturn msg;","outputs":1,"noerr":0,"x":801.3968162536621,"y":1252.337215423584,"wires":[["241c59fc.a35d86"]]},{"id":"195436a6.178439","type":"function","z":"64a9fd5e.6ad034","name":"oldPlo","func":"msg.payload = global.get('oldPlo');\nmsg.topic = 'oldPlo';\nreturn msg;","outputs":1,"noerr":0,"x":805.6825218200684,"y":1299.480037689209,"wires":[["241c59fc.a35d86"]]},{"id":"b3126041.7e8e2","type":"function","z":"64a9fd5e.6ad034","name":"oldFilt","func":"msg.payload = global.get('oldFilt');\nmsg.topic = 'oldFilt';\nreturn msg;","outputs":1,"noerr":0,"x":807.1111106872559,"y":1335.194393157959,"wires":[["241c59fc.a35d86"]]},{"id":"bc3d3dbd.7a0b1","type":"function","z":"64a9fd5e.6ad034","name":"global set setFilt","func":"msg.payload = Math.abs(global.get('PS1') - global.get ('PS0'));\nglobal.set('setFilt',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":802.2539405822754,"y":1012.1943912506104,"wires":[[]]},{"id":"1f9501ed.da9e6e","type":"comment","z":"64a9fd5e.6ad034","name":"step 2 test mode modification","info":"We will ignore float input and move to next step","x":674.2896881103516,"y":270.6943950653076,"wires":[]},{"id":"c0c466d4.e655b8","type":"function","z":"64a9fd5e.6ad034","name":"step 3","func":"if (global.get('step3')===1 )\nreturn msg;","outputs":1,"noerr":0,"x":567.9682388305664,"y":1664.480052947998,"wires":[["ab0994d1.a48578","a28a4266.7911"]]},{"id":"de8bbc90.bea69","type":"inject","z":"64a9fd5e.6ad034","name":"1 Sec PULSE","topic":"","payload":"ddd","payloadType":"str","repeat":"1","crontab":"","once":true,"x":205.96825408935547,"y":1584.4799976348877,"wires":[["4abd6543.b32f4c"]]},{"id":"e6c2be8e.7b9ee","type":"function","z":"64a9fd5e.6ad034","name":"step 2","func":"if (global.get('step2')===1 )\nreturn msg;","outputs":1,"noerr":0,"x":572.9682388305664,"y":1577.480052947998,"wires":[["a798c3f7.9d91b","70d9c6ed.35b5d8"]]},{"id":"4dd27984.7d4bf8","type":"function","z":"64a9fd5e.6ad034","name":"step 1","func":"if (global.get('step1')===1 )\nreturn msg;","outputs":1,"noerr":0,"x":568.2539749145508,"y":1501.7657432556152,"wires":[["c306f83f.cec678"]]},{"id":"cf93bd15.fecc5","type":"function","z":"64a9fd5e.6ad034","name":"step 4","func":"if (global.get('step4')===1 )\nreturn msg;","outputs":1,"noerr":0,"x":567.9682388305664,"y":1733.480052947998,"wires":[["d1828a26.4a34a8","6ea8bedb.8f42d"]]},{"id":"6b3febab.4422a4","type":"function","z":"64a9fd5e.6ad034","name":"step 5","func":"if (global.get('step5')===1 )\nreturn msg;","outputs":1,"noerr":0,"x":576.9682388305664,"y":1807.480052947998,"wires":[["74656c14.47fc64","1bc59ea1.8d8b51"]]},{"id":"3af69cbb.4af6b4","type":"function","z":"64a9fd5e.6ad034","name":"set step 5 timed out alarm ","func":"if (global.get('step5')===1 ) {\n    global.set ('timedout', 1);\n    global.set ('blwr', 0);\n    global.set ('start_stop', 0);\n}\nreturn;","outputs":1,"noerr":0,"x":1047.9682388305664,"y":1793.480052947998,"wires":[[]]},{"id":"3d3bc526.9f661a","type":"function","z":"64a9fd5e.6ad034","name":"set step 4 timed out alarm ","func":"if (global.get('step4')===1 ) {\n    global.set ('timedout', 1);\n    global.set ('blwr', 0);\n    global.set ('start_stop', 0);\n}\nreturn;","outputs":1,"noerr":0,"x":1043.9682388305664,"y":1717.480052947998,"wires":[[]]},{"id":"35147499.02441c","type":"function","z":"64a9fd5e.6ad034","name":"set step 3 timed out alarm ","func":"if (global.get('step3')===1 ) {\n    global.set ('timedout', 1);\n    global.set ('blwr', 0);\n    global.set ('start_stop', 0);\n}\nreturn;","outputs":1,"noerr":0,"x":1050.9682388305664,"y":1646.480052947998,"wires":[[]]},{"id":"bb8fe192.0f0d","type":"function","z":"64a9fd5e.6ad034","name":"set step 2 timed out alarm ","func":"if (global.get('step2')===1 ) {\n    global.set ('timedout', 1);\n    global.set ('blwr', 0);\n    global.set ('start_stop', 0);\n}\nreturn;","outputs":1,"noerr":0,"x":1055.9682388305664,"y":1574.480052947998,"wires":[[]]},{"id":"68acb83d.2d47a8","type":"function","z":"64a9fd5e.6ad034","name":"set step 1 timed out alarm ","func":"if (global.get('step1')===1 ) {\n    global.set ('timedout', 1);\n    global.set ('blwr', 0);\n    global.set ('start_stop', 0);\n}\nreturn;","outputs":1,"noerr":0,"x":1056.9682388305664,"y":1504.480052947998,"wires":[[]]},{"id":"a798c3f7.9d91b","type":"trigger","z":"64a9fd5e.6ad034","op1":"","op2":"1","op1type":"nul","op2type":"str","duration":"30","extend":false,"units":"min","reset":"99","name":"","x":833.4682388305664,"y":1577.480052947998,"wires":[["bb8fe192.0f0d"]]},{"id":"ab0994d1.a48578","type":"change","z":"64a9fd5e.6ad034","name":"reset 99","rules":[{"t":"set","p":"payload","pt":"msg","to":"99","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":682.9682388305664,"y":1616.480052947998,"wires":[["a798c3f7.9d91b"]]},{"id":"70d9c6ed.35b5d8","type":"change","z":"64a9fd5e.6ad034","name":"reset 99","rules":[{"t":"set","p":"payload","pt":"msg","to":"99","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":694.9682388305664,"y":1537.480052947998,"wires":[["c306f83f.cec678"]]},{"id":"d1828a26.4a34a8","type":"change","z":"64a9fd5e.6ad034","name":"reset 99","rules":[{"t":"set","p":"payload","pt":"msg","to":"99","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":684.9682388305664,"y":1693.480052947998,"wires":[["a28a4266.7911"]]},{"id":"74656c14.47fc64","type":"change","z":"64a9fd5e.6ad034","name":"reset 99","rules":[{"t":"set","p":"payload","pt":"msg","to":"99","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":695.9682388305664,"y":1764.480052947998,"wires":[["6ea8bedb.8f42d"]]},{"id":"c306f83f.cec678","type":"trigger","z":"64a9fd5e.6ad034","op1":"","op2":"1","op1type":"nul","op2type":"str","duration":"20","extend":false,"units":"s","reset":"99","name":"","x":837.4682388305664,"y":1505.480052947998,"wires":[["68acb83d.2d47a8"]]},{"id":"a28a4266.7911","type":"trigger","z":"64a9fd5e.6ad034","op1":"","op2":"1","op1type":"nul","op2type":"str","duration":"20","extend":false,"units":"s","reset":"99","name":"","x":829.9682388305664,"y":1650.480052947998,"wires":[["35147499.02441c"]]},{"id":"6ea8bedb.8f42d","type":"trigger","z":"64a9fd5e.6ad034","op1":"","op2":"1","op1type":"nul","op2type":"str","duration":"20","extend":false,"units":"s","reset":"99","name":"","x":829.9682388305664,"y":1719.480052947998,"wires":[["3d3bc526.9f661a"]]},{"id":"1bc59ea1.8d8b51","type":"trigger","z":"64a9fd5e.6ad034","op1":"","op2":"1","op1type":"nul","op2type":"str","duration":"20","extend":false,"units":"s","reset":"99","name":"","x":827.9682388305664,"y":1790.480052947998,"wires":[["3af69cbb.4af6b4"]]},{"id":"4abd6543.b32f4c","type":"function","z":"64a9fd5e.6ad034","name":"global get test or  demo mode","func":"if (global.get ('test_mode') ===1 || \nglobal.get ('demo_mode')===1) {\nmsg.payload = 1;\nreturn msg;\n} else\nmsg.payload = 0;\nreturn msg;\n","outputs":1,"noerr":0,"x":294.3968276977539,"y":1668.7658195495605,"wires":[["3e28aa4.e682b56"]]},{"id":"3e28aa4.e682b56","type":"switch","z":"64a9fd5e.6ad034","name":"switch","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":415.49210357666016,"y":1595.311351776123,"wires":[[],["6b3febab.4422a4","cf93bd15.fecc5","c0c466d4.e655b8","e6c2be8e.7b9ee","4dd27984.7d4bf8"]]},{"id":"408064e8.4d5f8c","type":"function","z":"64a9fd5e.6ad034","name":"if test or  demo mode","func":"if (global.get('step5')===1 && (global.get ('test_mode') ===1 || \nglobal.get ('demo_mode')===1)) {\nreturn msg;} \n\n","outputs":1,"noerr":0,"x":689.3968276977539,"y":1213.7658195495605,"wires":[["9b3f78c5.d78ec8"]]},{"id":"377d8608.36e30a","type":"function","z":"64a9fd5e.6ad034","name":"step 5","func":"if (2.0< global.get('oldPlo') < global.get ('actPres') && \nglobal.get('step5')===1 && global.get ('actPres') <global.get('oldPhi') < 9.0)  {\nglobal.set ('step5',2);\nreturn msg;\n}\nreturn ;","outputs":1,"noerr":0,"x":646.5634422302246,"y":1172.1786460876465,"wires":[["b1fb222e.2b0c3"]]},{"id":"9b3f78c5.d78ec8","type":"delay","z":"64a9fd5e.6ad034","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":886.8968276977539,"y":1213.7658195495605,"wires":[["c2ed5919.6d7dd8"]]},{"id":"c07cbcc1.8c5e7","type":"vis in","z":"64a9fd5e.6ad034","language":"en","x":588.5,"y":95.5,"wires":[["9ccd6435.0a7ec8"]]},{"id":"241c59fc.a35d86","type":"vis in","z":"64a9fd5e.6ad034","language":"en","x":1471.1666259765625,"y":1121.1667041778564,"wires":[[]]},{"id":"b82462dc.c48bc","type":"comment","z":"53d40aa7.5b81e4","name":"Reset button ","info":"","x":378.74999237060547,"y":146.67853546142578,"wires":[]},{"id":"2c1e7f26.fb36e","type":"inject","z":"53d40aa7.5b81e4","name":"","topic":"reset","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":136.5714340209961,"y":343.7856721878052,"wires":[["d4925384.53d7b"]]},{"id":"1e631694.eafaa9","type":"inject","z":"53d40aa7.5b81e4","name":"","topic":"reset","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"x":131.42858123779297,"y":306.1071138381958,"wires":[["198d7415.9b871c"]]},{"id":"34aa8d80.4b85f2","type":"trigger","z":"53d40aa7.5b81e4","op1":"","op2":"","op1type":"nul","op2type":"pay","duration":"3","extend":false,"units":"s","reset":"","name":"delay reset","x":425.5357360839844,"y":327.2142610549927,"wires":[["ba5ea63c.a7d848"]]},{"id":"d4925384.53d7b","type":"switch","z":"53d40aa7.5b81e4","name":"reset","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reset","vt":"str"}],"checkall":"true","outputs":1,"x":401.8214111328125,"y":256.0118684768677,"wires":[["34aa8d80.4b85f2","198d7415.9b871c"]]},{"id":"ba5ea63c.a7d848","type":"change","z":"53d40aa7.5b81e4","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"99","fromt":"num","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":160.2142333984375,"y":243.7261781692505,"wires":[["2b101270.ef58be"]]},{"id":"2b101270.ef58be","type":"function","z":"53d40aa7.5b81e4","name":"flip flop","func":"var newmsg = msg.payload;\nif (newmsg === 0 ) {\n   msg.payload = 1 ;\n}   \nif (newmsg== 1 ) {\n    msg.payload = 0 ;\n}\nreturn msg;","outputs":1,"noerr":0,"x":167.71434020996094,"y":199.01188373565674,"wires":[["198d7415.9b871c"]]},{"id":"3223c67c.80755a","type":"inject","z":"53d40aa7.5b81e4","name":"","topic":"factreset","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":127.91665649414062,"y":601.6785612106323,"wires":[["c30a162e.798df8"]]},{"id":"4e03a971.7d14c8","type":"inject","z":"53d40aa7.5b81e4","name":"","topic":"factreset","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"x":134.25006103515625,"y":557.1429109573364,"wires":[["f838d0f8.7beb8"]]},{"id":"e2f63552.8049c8","type":"trigger","z":"53d40aa7.5b81e4","op1":"1","op2":"0","op1type":"nul","op2type":"pay","duration":"3","extend":false,"units":"s","reset":"","name":"delay reset","x":480.547607421875,"y":580.4404573440552,"wires":[["c89f802f.6847b"]]},{"id":"c30a162e.798df8","type":"switch","z":"53d40aa7.5b81e4","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"factreset","vt":"str"}],"checkall":"true","outputs":1,"x":497.11907958984375,"y":508.3332796096802,"wires":[["e2f63552.8049c8","f838d0f8.7beb8"]]},{"id":"c89f802f.6847b","type":"change","z":"53d40aa7.5b81e4","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":277.22613525390625,"y":513.9523649215698,"wires":[["fd9975ea.f5f6e8"]]},{"id":"fd9975ea.f5f6e8","type":"function","z":"53d40aa7.5b81e4","name":"flip flop","func":"var newmsg = msg.payload;\nif (newmsg === 0 ) {\n   msg.payload = 1 ;\n}   \nif (newmsg== 1 ) {\n    msg.payload = 0 ;\n}\nreturn msg;","outputs":1,"noerr":0,"x":269.8690490722656,"y":455.6666536331177,"wires":[["f838d0f8.7beb8"]]},{"id":"4037f3f1.55a8cc","type":"comment","z":"53d40aa7.5b81e4","name":"Gauge Display","info":"","x":170,"y":650.6071195602417,"wires":[]},{"id":"21e59c42.b94734","type":"comment","z":"53d40aa7.5b81e4","name":"Factory Reset Button Reset","info":"","x":407,"y":396.1071195602417,"wires":[]},{"id":"805da738.dd6c28","type":"inject","z":"53d40aa7.5b81e4","name":"gauge inject","topic":"gauge","payload":"1","payloadType":"num","repeat":"1","crontab":"","once":true,"x":122.5,"y":702.6071195602417,"wires":[["b8e0a950.52e4f8","98786acd.eabd88","33572bbc.edb0a4"]]},{"id":"b8e0a950.52e4f8","type":"function","z":"53d40aa7.5b81e4","name":"Gauge","func":"msg.topic = 'gauge';\nreturn msg;","outputs":1,"noerr":0,"x":322.75000381469727,"y":703.6071395874023,"wires":[["2a43f386.8db60c"]]},{"id":"98786acd.eabd88","type":"function","z":"53d40aa7.5b81e4","name":"Scrub Press","func":"msg.topic = 'scrub_pressure';\nmsg.payload = global.get('actPres')-(-0.01);\nreturn msg;","outputs":1,"noerr":0,"x":344,"y":746.1071195602417,"wires":[["2a43f386.8db60c"]]},{"id":"33572bbc.edb0a4","type":"function","z":"53d40aa7.5b81e4","name":"Filter Press","func":"msg.topic = 'filter_pressure';\nmsg.payload = global.get('filter_pressure')-(-0.001);\nreturn msg;","outputs":1,"noerr":0,"x":350.25,"y":799.8571195602417,"wires":[["2a43f386.8db60c"]]},{"id":"cc84046d.6a81b8","type":"inject","z":"53d40aa7.5b81e4","name":"RESET on startup","topic":"reset","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":748.3928451538086,"y":133.71426391601562,"wires":[["c219b0b9.560c4"]]},{"id":"c219b0b9.560c4","type":"trigger","z":"53d40aa7.5b81e4","op1":"","op2":"","op1type":"pay","op2type":"pay","duration":"3","extend":false,"units":"s","reset":"","name":"initialization","x":980.4762191772461,"y":149.76190185546875,"wires":[["a69de975.d52518"]]},{"id":"8b9bc4d8.6e3698","type":"change","z":"53d40aa7.5b81e4","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":743.6666488647461,"y":186.1904296875,"wires":[["c219b0b9.560c4"]]},{"id":"63f3f6b5.221758","type":"switch","z":"53d40aa7.5b81e4","name":"reset","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reset","vt":"str"}],"checkall":"true","outputs":1,"x":580.2856674194336,"y":186.23806762695312,"wires":[["8b9bc4d8.6e3698"]]},{"id":"a69de975.d52518","type":"function","z":"53d40aa7.5b81e4","name":"SET CALL VARIABLES","func":"var alarm = global.set ('alarm', 0);\nvar blwr = global.set ('blwr', 0);\nvar permPlo = global.set ('permPlo', 0);\nvar permPhi = global.set ('permPhi', 0);\nvar permDirt = global.set ('permDirt', 0);\nvar begin = global.set ('begin', 0);\nvar step1 = global.set ('step1', 0);\nvar step2 = global.set ('step2', 0);\nvar step3 = global.set ('step3', 0);\nvar step4 = global.set ('step4', 0);\nvar step5 = global.set ('step5', 0);\nvar step6 = global.set ('step6', 0);\nvar step7 = global.set ('step7', 0);\nvar timedout = global.set ('timedout', 0);\nvar timedout_alarm = global.set ('timedout_alarm', 0);\nvar gate = global.set ('gate', 0);\nvar table = global.set ('table', 0);\nvar filterlife = global.set ('filterlife', 0);\nvar ballvalve = global.set ('ballvalve', 0);\nvar test_mode = global.set ('test_mode', 0);\nvar dynFill = global.set ('dynFill', 0);\nvar tune = global.set ('tune', 0);\nvar demo_mode = global.set ('demo_mode', 0);\nvar ballchk = global.set ('ballchk', 0);\nvar man_control = global.set ('man_control', 0);\nvar man_fill = global.set ('manfill', 0);\nvar phase = global.set ('phase', 1);\nvar reset = global.set ('reset', 0);\n\nreturn msg;\n","outputs":"1","noerr":0,"x":967.2857894897461,"y":220.28549194335938,"wires":[[]]},{"id":"54f82dec.69b5c4","type":"switch","z":"53d40aa7.5b81e4","name":"reset","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reset","vt":"str"}],"checkall":"true","outputs":1,"x":582.7618637084961,"y":224.2855224609375,"wires":[["a69de975.d52518"]]},{"id":"50c876bf.286618","type":"inject","z":"53d40aa7.5b81e4","name":"Inject reset","topic":"reset","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":733.25,"y":375.8571195602417,"wires":[["b67610ca.10e2f"]]},{"id":"b67610ca.10e2f","type":"trigger","z":"53d40aa7.5b81e4","op1":"","op2":"","op1type":"pay","op2type":"pay","duration":"3","extend":false,"units":"s","reset":"","name":"initialization","x":1021.4761962890625,"y":428.7619047164917,"wires":[["fb76a012.39df9","febc1699.76aab8","bbf9558.d35c0a8"]]},{"id":"9a122159.6dd3b","type":"change","z":"53d40aa7.5b81e4","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":812.6666259765625,"y":430.19043254852295,"wires":[["b67610ca.10e2f"]]},{"id":"4219ad3a.f03a74","type":"switch","z":"53d40aa7.5b81e4","name":"factreset","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"factreset","vt":"str"}],"checkall":"true","outputs":1,"x":631.28564453125,"y":427.2380704879761,"wires":[["9a122159.6dd3b"]]},{"id":"fb76a012.39df9","type":"function","z":"53d40aa7.5b81e4","name":"SET CALL VARIABLES 2","func":"var oldFilt = global.set ('oldFilt', 2.5);\nvar oldPhi = global.set ('oldPhi', 7.5);\nvar oldPlo = global.set ('oldPlo', 3.5);\nvar permDirt = global.set ('permDirt', 0);\nvar permPhi = global.set ('permPhi', 0);\nvar permPlo = global.set ('permPlo', 0);\nvar phase = global.set ('phase', 1);\nvar phase_check = global.set ('phase_check', 1);\nvar Phicount = global.set ('Phicount', 0);\nvar Plocount = global.set ('Plocount', 0);\nvar setDirt = global.set ('setDirt', 0.75);\nvar setFilt = global.set ('setFilt', 1.25);\nvar setPhi = global.set ('setPhi', 1.5);\nvar setPlo = global.set ('setPlo', 1.5);\nvar setPres = global.set ('setPres', 5.5);\n\nreturn msg;\n\n","outputs":"1","noerr":0,"x":982.285758972168,"y":582.2854919433594,"wires":[[]]},{"id":"72a6d7c9.c7c0e8","type":"switch","z":"53d40aa7.5b81e4","name":"factreset","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"factreset","vt":"str"}],"checkall":"true","outputs":1,"x":680.7618408203125,"y":481.28552532196045,"wires":[["fb76a012.39df9","febc1699.76aab8","bbf9558.d35c0a8"]]},{"id":"94efb1c0.1af51","type":"comment","z":"53d40aa7.5b81e4","name":"question qualifier unit set up","info":"","x":696.5833358764648,"y":804.142915725708,"wires":[]},{"id":"5fd16579.fcc99c","type":"inject","z":"53d40aa7.5b81e4","name":"Grand State of Things","topic":"","payload":"4","payloadType":"str","repeat":"1","crontab":"","once":true,"x":159.82141876220703,"y":856.4289045333862,"wires":[["dbc7504f.fbd4e","2568606d.bdd8b","58b459e8.839268","59a38616.926598"]]},{"id":"ccbc2bfc.3fcdb8","type":"switch","z":"53d40aa7.5b81e4","name":"gate","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"gate","vt":"str"}],"checkall":"true","outputs":1,"x":828.2498868306479,"y":1049.1427839597063,"wires":[["b323c478.d62f98","7d11c4a8.5b575c"]]},{"id":"b323c478.d62f98","type":"change","z":"53d40aa7.5b81e4","name":"gate","rules":[{"t":"change","p":"payload","pt":"msg","from":"1","fromt":"num","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1003.9325307210288,"y":1046.6188982327776,"wires":[["32fc87f7.653218"]]},{"id":"1461d266.3562ee","type":"change","z":"53d40aa7.5b81e4","name":"filterlife","rules":[{"t":"change","p":"payload","pt":"msg","from":"1","fromt":"num","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1093.5037968953452,"y":1145.7616422971087,"wires":[["32fc87f7.653218"]]},{"id":"d81c576f.296418","type":"switch","z":"53d40aa7.5b81e4","name":"filterlife","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"filterlife","vt":"str"}],"checkall":"true","outputs":1,"x":855.5991261800132,"y":1148.28560813268,"wires":[["1461d266.3562ee","6044af4.52f305"]]},{"id":"e57a6ccd.671ef","type":"switch","z":"53d40aa7.5b81e4","name":"ballchk","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"ballchk","vt":"str"}],"checkall":"true","outputs":1,"x":880.8372192382812,"y":1218.0474200248718,"wires":[["375e7a47.c6f4a6","9d573a30.8a0df8"]]},{"id":"375e7a47.c6f4a6","type":"change","z":"53d40aa7.5b81e4","name":"ballchk","rules":[{"t":"change","p":"payload","pt":"msg","from":"1","fromt":"num","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1134.349235534668,"y":1206.4998779296875,"wires":[["32fc87f7.653218"]]},{"id":"c09a775e.e721b8","type":"inject","z":"53d40aa7.5b81e4","name":"gate 0","topic":"gate","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":154.9166615804038,"y":1121.4762180646258,"wires":[["3f53fd96.98f862"]]},{"id":"381ad7a7.428fc8","type":"inject","z":"53d40aa7.5b81e4","name":"gate 1","topic":"gate","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":158.24999237060547,"y":1156.4762206077576,"wires":[["3f53fd96.98f862"]]},{"id":"3f53fd96.98f862","type":"function","z":"53d40aa7.5b81e4","name":"gate test","func":"global.set('gate', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":388.0118942260742,"y":1138.1429443359375,"wires":[[]]},{"id":"dbc7504f.fbd4e","type":"change","z":"53d40aa7.5b81e4","name":"gate filter","rules":[{"t":"set","p":"topic","pt":"msg","to":"gate","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":438.25008392333984,"y":885.6666870117188,"wires":[["99a79a0e.9cb328"]]},{"id":"99a79a0e.9cb328","type":"function","z":"53d40aa7.5b81e4","name":"gate","func":"msg.payload = global.get('gate');\nreturn msg;\n","outputs":1,"noerr":0,"x":602.2499923706055,"y":887.3329467773438,"wires":[["ccbc2bfc.3fcdb8"]]},{"id":"d0acbdf9.e69c7","type":"inject","z":"53d40aa7.5b81e4","name":"table 0","topic":"table","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":158.24999237060547,"y":1193.8095703125,"wires":[["241255ff.25068a"]]},{"id":"f450e388.528c9","type":"inject","z":"53d40aa7.5b81e4","name":"table 1","topic":"table","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":164.24999237060547,"y":1232.47607421875,"wires":[["241255ff.25068a"]]},{"id":"241255ff.25068a","type":"function","z":"53d40aa7.5b81e4","name":"table test","func":"global.set('table', msg.payload);\nreturn msg;\n","outputs":1,"noerr":0,"x":387.15479278564453,"y":1194.142822265625,"wires":[[]]},{"id":"3b9db5db.39328a","type":"inject","z":"53d40aa7.5b81e4","name":"filterlife 0","topic":"filterlife","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":156.9166488647461,"y":1266.142822265625,"wires":[["28e20d90.2ce882"]]},{"id":"52291387.8c761c","type":"inject","z":"53d40aa7.5b81e4","name":"filterlife 1","topic":"filterlife","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":162.9166488647461,"y":1306.47607421875,"wires":[["28e20d90.2ce882"]]},{"id":"28e20d90.2ce882","type":"function","z":"53d40aa7.5b81e4","name":"filterlife test","func":"global.set('filterlife', msg.payload);\nreturn msg;\n","outputs":1,"noerr":0,"x":386.39282989501953,"y":1257.9521484375,"wires":[[]]},{"id":"c220adac.6745f","type":"inject","z":"53d40aa7.5b81e4","name":"ballchk 0","topic":"ballchk","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":364.58333587646484,"y":1314.4761962890625,"wires":[["592be0e.811df2"]]},{"id":"c3abe5dc.8aab58","type":"inject","z":"53d40aa7.5b81e4","name":"ballchk 1","topic":"ballchk","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":369.24999237060547,"y":1361.142822265625,"wires":[["592be0e.811df2"]]},{"id":"592be0e.811df2","type":"function","z":"53d40aa7.5b81e4","name":"ballvalve test","func":"global.set('ballchk', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":579.1547470092773,"y":1324.7618408203125,"wires":[[]]},{"id":"58b459e8.839268","type":"change","z":"53d40aa7.5b81e4","name":"filterlife filter","rules":[{"t":"set","p":"topic","pt":"msg","to":"filterlife","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":423.30953216552734,"y":973.666748046875,"wires":[["8602b7d7.bbed38"]]},{"id":"59a38616.926598","type":"change","z":"53d40aa7.5b81e4","name":"ballvalve filter","rules":[{"t":"set","p":"topic","pt":"msg","to":"ballchk","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":372.6904830932617,"y":1013.618896484375,"wires":[["3d4dd283.3232de"]]},{"id":"36dd36fc.86005a","type":"switch","z":"53d40aa7.5b81e4","name":"table","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"table","vt":"str"}],"checkall":"true","outputs":1,"x":838.2499860127768,"y":1094.1428659756975,"wires":[["84bdaf51.4bbe9","156e9ac6.7f86d5"]]},{"id":"84bdaf51.4bbe9","type":"change","z":"53d40aa7.5b81e4","name":"table","rules":[{"t":"change","p":"payload","pt":"msg","from":"1","fromt":"num","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1022.8213704427085,"y":1086.6189554532366,"wires":[["32fc87f7.653218"]]},{"id":"2568606d.bdd8b","type":"change","z":"53d40aa7.5b81e4","name":"table filter","rules":[{"t":"set","p":"topic","pt":"msg","to":"table","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":433.3928451538086,"y":931.619140625,"wires":[["fec2fabe.b32b88"]]},{"id":"fec2fabe.b32b88","type":"function","z":"53d40aa7.5b81e4","name":"table","func":"msg.payload = global.get('table');\nreturn msg;\n","outputs":1,"noerr":0,"x":590.9166793823242,"y":958.4761962890625,"wires":[["36dd36fc.86005a"]]},{"id":"7d11c4a8.5b575c","type":"function","z":"53d40aa7.5b81e4","name":"gate set","func":"global.set('gate', msg.payload);\nif (global.get('gate') === 0 ) {global.set ('table', 0 );\nglobal.set ('filterlife', 0 );\nglobal.set ('ballchk', 0)}\nreturn ;\n","outputs":1,"noerr":0,"x":1184.202262878418,"y":931.154541015625,"wires":[[]]},{"id":"156e9ac6.7f86d5","type":"function","z":"53d40aa7.5b81e4","name":"table test","func":"global.set('table', msg.payload);\nif (global.get('table') === 0 ) {\nglobal.set ('filterlife', 0 );\nglobal.set ('ballchk', 0)}\nreturn ;\n","outputs":1,"noerr":0,"x":1192.3212814331055,"y":988.142822265625,"wires":[[]]},{"id":"8602b7d7.bbed38","type":"function","z":"53d40aa7.5b81e4","name":"table and filterlife","func":"msg.payload = global.get('filterlife');\nreturn msg;\n","outputs":1,"noerr":0,"x":598.9166793823242,"y":1044.142822265625,"wires":[["d81c576f.296418"]]},{"id":"6044af4.52f305","type":"function","z":"53d40aa7.5b81e4","name":"filterlife test","func":"global.set('filterlife', msg.payload);\nif (global.get('filterlife') === 0 ) {\nglobal.set ('ballchk', 0)}\nreturn ;\n","outputs":1,"noerr":0,"x":1236.761833190918,"y":1038.1904296875,"wires":[[]]},{"id":"3d4dd283.3232de","type":"function","z":"53d40aa7.5b81e4","name":"table and filterlife and ballvalve","func":"msg.payload = global.get('ballchk');\nreturn msg;\n","outputs":1,"noerr":0,"x":549.2976608276367,"y":1090.0711669921875,"wires":[["e57a6ccd.671ef"]]},{"id":"9d573a30.8a0df8","type":"function","z":"53d40aa7.5b81e4","name":"ballchk test","func":"global.set('ballchk', msg.payload);\nreturn msg;\n","outputs":1,"noerr":0,"x":1266.869010925293,"y":1096.3572998046875,"wires":[[]]},{"id":"198d7415.9b871c","type":"vis in","z":"53d40aa7.5b81e4","language":"en","x":367.25,"y":201.71426105499268,"wires":[["54f82dec.69b5c4","63f3f6b5.221758","d4925384.53d7b"]]},{"id":"f838d0f8.7beb8","type":"vis in","z":"53d40aa7.5b81e4","language":"en","x":454.25,"y":463.7142610549927,"wires":[["72a6d7c9.c7c0e8","4219ad3a.f03a74","c30a162e.798df8"]]},{"id":"2a43f386.8db60c","type":"vis in","z":"53d40aa7.5b81e4","language":"en","x":584.25,"y":697.7142610549927,"wires":[[]]},{"id":"32fc87f7.653218","type":"vis in","z":"53d40aa7.5b81e4","language":"en","x":904.8214340209961,"y":912.4285736083984,"wires":[["ccbc2bfc.3fcdb8","36dd36fc.86005a","d81c576f.296418","e57a6ccd.671ef"]]},{"id":"1cbe1e10.9c1d42","type":"comment","z":"53d40aa7.5b81e4","name":"Variable List","info":"var start_stop = global.get ('start_stop')||0;\nvar man_control = global.get ('man_control')||0;\nvar test_mode = global.get ('test_mode')||0;\nvar demo_mode = global.get ('demo_mode')||0;\nvar alarm = global.get ('alarm') || 0;\nvar blwr = global.get ('blwr') || 0;\nvar speed = global.get ('speed')|| 0;\nvar flt = global.get ('flt') || 0;\nvar count = global.get ('count') || 0;\n//var permPres = global.get ('permPres') || 2.5;\n//var actPres = global.get ('actPres') || 0;\n//var setPres = global.get ('setPres') || 5.5;\n//var permPlo = global.get ('permPlo') || 0;\n//var permPhi = global.get ('permPhi') || 0;\n//var permDirt = global.get ('permDirt') || 0;\n//var oldPlo = global.get ('oldPlo') || 3.5;\n//var oldPhi = global.get ('oldPhi') || 7.5;\n//var oldFilt = global.get ('oldFilt') || 2.5;\n//var setFilt = global.get ('setFilt') || 1.25;\n//var actFilt = global.get ('actFilt') || 0;\n//var permFilt = global.get ('permFilt') || 0.2;\nvar begin = global.get ('begin') || 0;\nvar step1 = global.get ('step1' ) || 0;\nvar step2 = global.get ('step2' ) || 0;\nvar step3 = global.get ('step3' ) || 0;\nvar step4 = global.get ('step4' ) || 0;\nvar step5 = global.get ('step5' ) || 0;\nvar step6 = global.get ('step6' ) || 0;\nvar step7 = global.get ('step7' ) || 0;\nvar gate = global.get ('gate' ) || 0;\nvar table = global.get ('table' ) || 0;\nvar filterlife = global.get ('filterlife' ) || 0;\nvar ballvalve = global.get ('ballvalve' ) || 0;\nvar gate2 = global.get ('gate2' ) || 0;\nvar table2 = global.get ('table2' ) || 0;\nvar filterlife2 = global.get ('filterlife2' ) || 0;\nvar ballvalve = global.get ('ballchk' ) || 0;\nvar reset = global.get ('reset' ) || 0;\nvar phase = global.get ('phase' ) || 1;\nvar dynFill = global.get ('dynFill' ) || 0;\nvar scott = global.get ('scott') || 0;\nvar tune = global.get ('tune') || 0;\nvar setPhi = global.get ('setPhi') || 1.5;\nvar setPlo = global.get ('setPlo') || 1.5;\nvar setDirt = global.get ('setDirt') || 0.75;\nvar phase_check = global.get ('phase_check') || 1;\n\nvar test = global.set ('test', 1);\nvar alarm = global.set ('alarm', 0);\nvar sys = global.set ('sys', 0);\nvar flt = global.set ('flt', 0);\nvar wtr = global.set ('wtr',  0);\nvar blwr = global.set ('blwr', 0);\nvar count = global.set ('count', 0);\n//var permPres = global.set ('permPres', 5.5);\n//var setPres = global.set ('setPres', 5.5);\nvar actPres = global.set ('actPres', 0);\nvar permPlo = global.set ('permPlo', 0);\nvar permPhi = global.set ('permPhi', 0);\n//var permFilt = global.set ('permFilt', 0.2);\n//var oldPlo = global.set ('oldPlo', 3.5);\n//var oldPhi = global.set ('oldPhi', 7.5);\n//var oldFilt = global.set ('oldFilt', 2.5);\n//var setFilt = global.set ('setFilt', 0.25);\nvar actFilt = global.set ('actFilt', 0);\nvar permDirt = global.set ('permDirt', 0);\nvar begin = global.set ('begin', 0);\nvar begin = global.set ('begin2', 0);\nvar step1 = global.set ('step1', 0);\nvar step2 = global.set ('step2', 0);\nvar step3 = global.set ('step3', 0);\nvar step4 = global.set ('step4', 0);\nvar step5 = global.set ('step5', 0);\nvar step6 = global.set ('step6', 0);\nvar step7 = global.set ('step7', 0);\nvar timedout = global.set ('timedout', 0);\nvar timedout_alarm = global.set ('timedout_alarm', 0);\nvar gate = global.set ('gate', 0);\nvar table = global.set ('table', 0);\nvar filterlife = global.set ('filterlife', 0);\nvar ballvalve = global.set ('ballvalve', 0);\nvar gate = global.set ('gate2', 0);\nvar table = global.set ('table2', 0);\nvar filterlife2 = global.set ('filterlife2', 0);\nvar ballvalve = global.set ('ballvalve', 0);\nvar reset = global.set ('reset', 0);\nvar test_mode = global.set ('test_mode', 0);\nvar phase = global.set ('phase', 1);\nvar dynFill = global.set ('dynFill', 0);\nvar scott = global.set ('scott', 3);\nvar tune = global.set ('tune', 0);\nvar newval1 = global.set ('newval1', 0);\nvar newval2 = global.set ('newval2', 0);\nvar newval3 = global.set ('newval3', 0);\nvar setPhi = global.set ('setPhi', 1.5);\nvar setPlo = global.set ('setPlo', 1.5);\nvar setDirt = global.set ('setDirt', 0.75);\nvar demo_mode = global.set ('demo_mode', 0);\nvar Phicount = global.set ('Phicount', 0);\nvar Plocount = global.set ('Plocount', 0);\nvar Dirtcount = global.set ('Dirtcount', 0);\nvar Timedoutcount = global.set ('Timedoutcount', 0);","x":342.82140350341797,"y":76.85714149475098,"wires":[]},{"id":"eda01804.a744d8","type":"comment","z":"53d40aa7.5b81e4","name":"FLOW VARIABLES","info":"'test' = TEST MODE STATUS; 0 - on; 1 - off\n'wtr' = MAN FILL STATUS;1 - on; 0 - off;\n'sys' = ALARM STATUS;1 - lo; 2 - hi; 3 - dirty fltr\n'blwr' = BLOWER STATUS; 0 - off; 1 - on;\n'setPres' = SCRUB SET POINT WATER CONTROL;\n'actPres' = ACTUAL SCRUB PRESSURE;\n'dirtFilt' = FILTER DIRTY SET POINT;\n'actFilt' = ACTUAL FILTER PRESSURE;\n'oldPlo' = LOW WATER SHUT PRESSURE;\n'oldPhi' = HIGH WATER SHUT PRESSURE;","x":544.7500381469727,"y":75.80949783325195,"wires":[]},{"id":"404d10da.0395","type":"comment","z":"53d40aa7.5b81e4","name":"VIS TOPICS","info":"'speed' - BLOWER STATE;\n'test_mode' - TEST MODE STATUS;\n'man_control' - MAN WATER FILL ON/OFF TO/FROM HMI;\n'valve_state' - WATER VALVE STATUS;\n'system_state' - ALARM STATE;\n'scrub_pressure' - HYDROTRON SCRUBBER PRESSURE;\n'filter_pressure' - AFTER FILTER PRESSURE;\n'man_fill' - STATUS OF SWITCH ON HMI\n'start_stop' - SWITCH STATUS HMI 1 - ON 0 - OFF\n","x":724.4762191772461,"y":75,"wires":[]},{"id":"febc1699.76aab8","type":"function","z":"53d40aa7.5b81e4","name":"SET CALL VARIABLES 1","func":"var actFilt = global.set ('actFilt', 0);\nvar actPres = global.set ('actPres', 0);\nvar alarm = global.set ('alarm', 0);\nvar ballchk = global.set ('ballchk', 0);\nvar ballvalve = global.set ('ballvalve', 0);\nvar begin = global.set ('begin', 0);\nvar blwr = global.set ('blwr', 0);\nvar demo_mode = global.set ('demo_mode',0);\nvar Dirtcount = global.set ('Dirtcount', 0);\nvar dynFill = global.set ('dynFill', 0);\nvar filterlife = global.set ('filterlife', 0);\nvar flt = global.set ('flt', 0);\nvar gate = global.set ('gate', 0);\nvar man_control = global.set ('man_control', 0);\n\nreturn msg;\n\n","outputs":"1","noerr":0,"x":983.7499923706055,"y":529,"wires":[[]]},{"id":"bbf9558.d35c0a8","type":"function","z":"53d40aa7.5b81e4","name":"SET CALL VARIABLES 3","func":"var speed = global.set ('speed', 0);\nvar start_stop = global.set ('start_stop',0);\nvar step1 = global.set ('step1' , 0);\nvar step2 = global.set ('step2' , 0);\nvar step3 = global.set ('step3' , 0);\nvar step4 = global.set ('step4' , 0);\nvar step5 = global.set ('step5' , 0);\nvar step6 = global.set ('step6' , 0);\nvar step7 = global.set ('step7' , 0);\nvar table = global.set ('table' , 0);\nvar test_mode = global.set ('test_mode', 0);\nvar timedout = global.set ('timedout', 0);\nvar timedout_alarm = global.set ('timedout_alarm', 0);\nvar Timedoutcount = global.set ('Timedoutcount', 0);\nvar tune = global.set ('tune', 0);\nvar manfill = global.set('manfill', 0);\nvar reset = global.set ('reset', 0);\n\nreturn msg;\n\n","outputs":"1","noerr":0,"x":982.7499923706055,"y":628,"wires":[[]]},{"id":"83cceace.491538","type":"vis in","z":"53d40aa7.5b81e4","language":"en","x":162.74999237060547,"y":1590,"wires":[["5caa3613.30b2d8","d5f9abfc.b2e398","2ad859d0.ce3336","a8521197.5caee","37a4eddd.6a01c2"]]},{"id":"5caa3613.30b2d8","type":"switch","z":"53d40aa7.5b81e4","name":"set topic permPhi","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"permPhi","vt":"str"}],"checkall":"true","outputs":1,"x":394.2616500854492,"y":1524.261962890625,"wires":[["8d587816.b328a8"]]},{"id":"824fb725.23f5d8","type":"function","z":"53d40aa7.5b81e4","name":"global set permPhi","func":"global.set('alarm',1);\nreturn;","outputs":1,"noerr":0,"x":829.976432800293,"y":1522.6663818359375,"wires":[[]]},{"id":"596c237a.4cf8bc","type":"comment","z":"53d40aa7.5b81e4","name":"Manually set Alarm states from VIS for demo","info":"","x":687.2499923706055,"y":1437,"wires":[]},{"id":"d5f9abfc.b2e398","type":"switch","z":"53d40aa7.5b81e4","name":"set topic permPlo","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"permPlo","vt":"str"}],"checkall":"true","outputs":1,"x":397.74999237060547,"y":1574,"wires":[["1c8dfadd.4b4bc5"]]},{"id":"1c1ad034.5678d","type":"function","z":"53d40aa7.5b81e4","name":"global set permPlo","func":"global.set('alarm',2);\nreturn;","outputs":1,"noerr":0,"x":833.4647750854492,"y":1572.4044189453125,"wires":[[]]},{"id":"2ad859d0.ce3336","type":"switch","z":"53d40aa7.5b81e4","name":"set topic permDirt","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"permDirt","vt":"str"}],"checkall":"true","outputs":1,"x":396.74999237060547,"y":1623,"wires":[["1dc92fc.e9a6ad"]]},{"id":"1d62ce62.b062c2","type":"function","z":"53d40aa7.5b81e4","name":"global set permDirt","func":"global.set('alarm',3);\nreturn;","outputs":1,"noerr":0,"x":832.4647750854492,"y":1621.4044189453125,"wires":[[]]},{"id":"a8521197.5caee","type":"switch","z":"53d40aa7.5b81e4","name":"set topic timedout_alarm","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"timedout_alarm","vt":"str"}],"checkall":"true","outputs":1,"x":413.74999237060547,"y":1672,"wires":[["60f90119.f7b9b"]]},{"id":"f22b9d4e.20a68","type":"function","z":"53d40aa7.5b81e4","name":"global set timedout_alarm","func":"global.set('alarm',4);\nreturn;","outputs":1,"noerr":0,"x":849.4647750854492,"y":1670.4044189453125,"wires":[[]]},{"id":"37a4eddd.6a01c2","type":"switch","z":"53d40aa7.5b81e4","name":"set topic phase","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"phase","vt":"str"}],"checkall":"true","outputs":1,"x":378.74999237060547,"y":1718,"wires":[["3661b7df.088ef8"]]},{"id":"ec2f594a.9e34d8","type":"function","z":"53d40aa7.5b81e4","name":"global set phase","func":"global.set('phase',0);\nreturn;","outputs":1,"noerr":0,"x":821.4647750854492,"y":1718.4044189453125,"wires":[[]]},{"id":"8d587816.b328a8","type":"switch","z":"53d40aa7.5b81e4","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","outputs":2,"x":600.2499923706055,"y":1516,"wires":[[],["824fb725.23f5d8"]]},{"id":"1c8dfadd.4b4bc5","type":"switch","z":"53d40aa7.5b81e4","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","outputs":2,"x":599.7499923706055,"y":1577,"wires":[[],["1c1ad034.5678d"]]},{"id":"1dc92fc.e9a6ad","type":"switch","z":"53d40aa7.5b81e4","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","outputs":2,"x":603.7499923706055,"y":1627,"wires":[[],["1d62ce62.b062c2"]]},{"id":"60f90119.f7b9b","type":"switch","z":"53d40aa7.5b81e4","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","outputs":2,"x":617.7499923706055,"y":1674,"wires":[[],["f22b9d4e.20a68"]]},{"id":"3661b7df.088ef8","type":"switch","z":"53d40aa7.5b81e4","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","outputs":2,"x":619.7499923706055,"y":1720,"wires":[["ec2f594a.9e34d8"],[]]},{"id":"aa29a167.4c5fb","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"topic ","pt":"msg","to":"PS0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":492.2857971191406,"y":192.21428871154785,"wires":[["f15fc8b.ecf9938","9783dc7a.57161"]]},{"id":"7dd3135.a7a93ec","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"topic ","pt":"msg","to":"PS1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":512.8214340209961,"y":283.0357322692871,"wires":[["bc683fc3.7d958","7420a97f.27ec48"]]},{"id":"e04cdf00.a4c63","type":"inject","z":"20f50063.3774f","name":"Auto Tune PULSE","topic":"","payload":"","payloadType":"num","repeat":"1","crontab":"","once":true,"x":142.5,"y":562.9643249511719,"wires":[["ae7ef210.e47d7","37b36fd7.bc2d2","1fba712a.85d75f","c101c8de.3f29e8","1a7d9610.fc335a","75ad67c1.85a3f8","a4fc581f.b29c08","10a3fec6.540961","80bd8ee6.22838","381fab48.fe24f4","a200cf1f.54917","96cf116d.4d903","3ba1d810.179fa8"]]},{"id":"9783dc7a.57161","type":"function","z":"20f50063.3774f","name":"qualifier for write to data base set press","func":"if (global.get ('step4')===1) {\nglobal.set ('PS0', msg.payload );\nreturn msg;\n}\nreturn;","outputs":1,"noerr":0,"x":847.7977294921875,"y":192.6190643310547,"wires":[["536d1bab.fee6d4","32f6bf56.820ec"]]},{"id":"7420a97f.27ec48","type":"function","z":"20f50063.3774f","name":"qualifier for write to data base set press","func":"if (global.get ('step4')===1) {\nglobal.set ('PS1', msg.payload );\nreturn msg;\n}\nreturn;","outputs":1,"noerr":0,"x":868.9286422729492,"y":302.7976245880127,"wires":[["d8e2835e.f953a","914aec9c.1c96f"]]},{"id":"22ac254b.0ae97a","type":"comment","z":"20f50063.3774f","name":"Help Get Data","info":"Push to get the /myRootTest/currentTime a from the collection Test.\nThat time has been set by the set data.","x":705.8333435058594,"y":432.166663646698,"wires":[]},{"id":"c0269e1d.5d99d","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":825.4166870117188,"y":480.76190090179443,"wires":[["2b71986a.4ea288"]]},{"id":"115ab10e.87b42f","type":"comment","z":"20f50063.3774f","name":"Help Get Data","info":"Push to get the /myRootTest/currentTime a from the collection Test.\nThat time has been set by the set data.","x":583.4523544311523,"y":477.40473651885986,"wires":[]},{"id":"bc6c96d3.133488","type":"function","z":"20f50063.3774f","name":"global set PS0","func":"var PS0 = global.set ('PS0', msg.payload);\nreturn;","outputs":1,"noerr":0,"x":1284.6427307128906,"y":507.4999656677246,"wires":[[]]},{"id":"514a08b4.71fd58","type":"function","z":"20f50063.3774f","name":"global set PS1","func":"var PS1 = global.set ('PS1', msg.payload);\nreturn;","outputs":1,"noerr":0,"x":1283.2143096923828,"y":656.5476503372192,"wires":[[]]},{"id":"2a0cb94a.a2e9b6","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"","payloadType":"num","repeat":"","crontab":"","once":true,"x":539.6429290771484,"y":519.1190891265869,"wires":[["c0269e1d.5d99d"]]},{"id":"73e10cc2.22fde4","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":847.4524536132812,"y":590.5476207733154,"wires":[["cf1159d3.a40368"]]},{"id":"f15fc8b.ecf9938","type":"function","z":"20f50063.3774f","name":"actPres","func":"global.set ('actPres', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":717.2618732452393,"y":265.8333377838135,"wires":[[]]},{"id":"bc683fc3.7d958","type":"function","z":"20f50063.3774f","name":"actFilt","func":"global.set ('actFilt', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":768.9285049438477,"y":378.11901092529297,"wires":[[]]},{"id":"10a3fec6.540961","type":"function","z":"20f50063.3774f","name":"global setPress","func":"global.set ('setPres', global.get('PS0'));\nreturn;","outputs":1,"noerr":0,"x":255.59534454345703,"y":201.30952978134155,"wires":[[]]},{"id":"d68cbcf7.c0e44","type":"DataIn","z":"20f50063.3774f","collection":"113808e1.92cd37","name":"","update":true,"path":"/SP0","x":1307.9285888671875,"y":91.07143020629883,"wires":[]},{"id":"ce342815.1a7948","type":"DataIn","z":"20f50063.3774f","collection":"d84aa291.07366","name":"","update":false,"path":"/SP1","x":1380.0714473724365,"y":409.0714302062988,"wires":[]},{"id":"cf1159d3.a40368","type":"DataOut","z":"20f50063.3774f","collection":"d84aa291.07366","name":"","path":"SP1","error":false,"x":1041.6428604125977,"y":521.2142868041992,"wires":[["514a08b4.71fd58"]]},{"id":"b29d695a.8966c8","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":578.0714378356934,"y":553.6428756713867,"wires":[["73e10cc2.22fde4"]]},{"id":"2b71986a.4ea288","type":"DataOut","z":"20f50063.3774f","collection":"113808e1.92cd37","name":"","path":"/SP0","error":false,"x":1039.6428604125977,"y":467.2142868041992,"wires":[["bc6c96d3.133488"]]},{"id":"536d1bab.fee6d4","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1106.4999504089355,"y":89.5,"wires":[["d68cbcf7.c0e44"]]},{"id":"d8e2835e.f953a","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1133.6429595947266,"y":399.8809642791748,"wires":[["ce342815.1a7948"]]},{"id":"32f6bf56.820ec","type":"delay","z":"20f50063.3774f","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1363.9285746983119,"y":186.5000010899135,"wires":[["c0269e1d.5d99d"]]},{"id":"914aec9c.1c96f","type":"delay","z":"20f50063.3774f","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1396.7856750488281,"y":310.78569316864014,"wires":[["73e10cc2.22fde4"]]},{"id":"37b36fd7.bc2d2","type":"function","z":"20f50063.3774f","name":"qualifier for write to data base set press","func":"if (global.get ('step3')===1) {\nglobal.set ('PS1', 0 );\nreturn msg;\n}\nreturn;","outputs":1,"noerr":0,"x":410.35721588134766,"y":934.7143144607544,"wires":[["7679b9d6.283f48"]]},{"id":"ae7ef210.e47d7","type":"function","z":"20f50063.3774f","name":"qualifier for write to data base set press","func":"if (global.get ('step3')===1) {\nglobal.set ('PS0', 0 );\nmsg.payload = global.get('PS0');\nreturn msg;\n}\nreturn;","outputs":1,"noerr":0,"x":411.72628021240234,"y":896.3214416503906,"wires":[["a753ef7e.a9b12","fe844b98.c38be8"]]},{"id":"d271850.8901878","type":"debug","z":"20f50063.3774f","name":"","active":true,"console":"false","complete":"payload","x":965.3570709228516,"y":888.6428089141846,"wires":[]},{"id":"7679b9d6.283f48","type":"rbe","z":"20f50063.3774f","name":"","func":"rbe","gap":"","start":"","inout":"out","x":825.3571662902832,"y":1009.3571720123291,"wires":[["73e10cc2.22fde4"]]},{"id":"a753ef7e.a9b12","type":"rbe","z":"20f50063.3774f","name":"","func":"rbe","gap":"","start":"","inout":"out","x":672.5000032697403,"y":866.5000010899134,"wires":[["c0269e1d.5d99d"]]},{"id":"fe844b98.c38be8","type":"rbe","z":"20f50063.3774f","name":"","func":"rbe","gap":"","start":"","inout":"out","x":802.5000076293945,"y":959.3571462631226,"wires":[["d271850.8901878"]]},{"id":"6c5731c9.af0ee","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP03","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":792.9760818481445,"y":1197.214171409607,"wires":[["ef8e5f48.35189","cc8aade6.5d78c"]]},{"id":"2cd6877f.53f0e8","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP02","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.8808975219727,"y":1157.1190242767334,"wires":[["9e16f1d5.278b5","4b60336f.5ce2fc"]]},{"id":"a7bbb2b4.5cb9f","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":564.642822265625,"y":1168.8809566497803,"wires":[["2cd6877f.53f0e8"]]},{"id":"18dd4d39.612813","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"2","payloadType":"str","repeat":"","crontab":"","once":false,"x":558.3093643188477,"y":1218.6427278518677,"wires":[["6c5731c9.af0ee"]]},{"id":"91ee103f.0beff","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP04","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":794.6427536010742,"y":1247.2141637802124,"wires":[["ed158732.1c3348","e17aad46.dc856"]]},{"id":"481feeac.3478c","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"3","payloadType":"str","repeat":"","crontab":"","once":false,"x":559.9760360717773,"y":1268.6427202224731,"wires":[["91ee103f.0beff"]]},{"id":"9e16f1d5.278b5","type":"DataIn","z":"20f50063.3774f","collection":"24ee5abf.b93816","name":"","update":false,"path":"/SP02","x":1067.9762802124023,"y":1150.5476245880127,"wires":[]},{"id":"ef8e5f48.35189","type":"DataIn","z":"20f50063.3774f","collection":"3ad35766.b13238","name":"","update":false,"path":"/SP03","x":1069.6427841186523,"y":1192.2142524719238,"wires":[]},{"id":"ed158732.1c3348","type":"DataIn","z":"20f50063.3774f","collection":"b11366d7.148a48","name":"","update":false,"path":"/SP04","x":1071.3095321655273,"y":1245.54762840271,"wires":[]},{"id":"79ffe2d0.180c5c","type":"DataOut","z":"20f50063.3774f","collection":"24ee5abf.b93816","name":"","path":"/SP02","error":false,"x":1007.9761238098145,"y":1368.8809652328491,"wires":[["b04e0535.41c1e8"]]},{"id":"a4bbdc33.641b8","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP03","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":759.6427993774414,"y":1418.8809127807617,"wires":[["c5eb0d1e.8f292"]]},{"id":"150d08a9.5635b7","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP02","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":768.5476150512695,"y":1378.7857656478882,"wires":[["79ffe2d0.180c5c"]]},{"id":"cab59f8e.2a9ef","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"x":531.3095397949219,"y":1390.547698020935,"wires":[["150d08a9.5635b7"]]},{"id":"1cb79f14.1426f1","type":"change","z":"20f50063.3774f","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/SP04","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":761.3094711303711,"y":1468.8809051513672,"wires":[["a50c0000.c2e8"]]},{"id":"c5eb0d1e.8f292","type":"DataOut","z":"20f50063.3774f","collection":"3ad35766.b13238","name":"","path":"/SP03","error":false,"x":1019.3095283508301,"y":1438.2142038345337,"wires":[["927d7dd5.1a0b5"]]},{"id":"a50c0000.c2e8","type":"DataOut","z":"20f50063.3774f","collection":"b11366d7.148a48","name":"","path":"/SP04","error":false,"x":1014.3095474243164,"y":1481.5476608276367,"wires":[["32ab6f9c.d52c4"]]},{"id":"513c4af4.697fe4","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"x":531.3094863891602,"y":1427.2142868041992,"wires":[["a4bbdc33.641b8"]]},{"id":"eeec4a7a.d7f9a8","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"x":529.6428604125977,"y":1473.8809127807617,"wires":[["1cb79f14.1426f1"]]},{"id":"1fba712a.85d75f","type":"function","z":"20f50063.3774f","name":"qualifier for write to data base set press","func":"if (global.get ('step6')===1) {\nmsg.payload = global.get ('oldPhi');\nreturn msg;\n}\nreturn;","outputs":1,"noerr":0,"x":223.92850494384766,"y":1030.785680770874,"wires":[["2cd6877f.53f0e8"]]},{"id":"c101c8de.3f29e8","type":"function","z":"20f50063.3774f","name":"qualifier for write to data base set press","func":"if (global.get ('step6')===1) {\nmsg.payload = global.get ('oldPlo');\nreturn msg;\n}\nreturn;","outputs":1,"noerr":0,"x":225.35713958740234,"y":1072.2141819000244,"wires":[["6c5731c9.af0ee"]]},{"id":"1a7d9610.fc335a","type":"function","z":"20f50063.3774f","name":"qualifier for write to data base set press","func":"if (global.get ('step6')===1) {\nmsg.payload = global.get ('oldFilt');\nreturn msg;\n}\nreturn;","outputs":1,"noerr":0,"x":232.49999618530273,"y":1115.071481704712,"wires":[["91ee103f.0beff"]]},{"id":"b04e0535.41c1e8","type":"function","z":"20f50063.3774f","name":"global set PS2","func":"var PS2 = global.set ('PS2', msg.payload);\nvar oldPhi = global.set ('oldPhi', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1466.309425354004,"y":1365.5476722717285,"wires":[[]]},{"id":"927d7dd5.1a0b5","type":"function","z":"20f50063.3774f","name":"global set PS3","func":"var PS3 = global.set ('PS3', msg.payload);\nvar oldPlo = global.set ('oldPlo', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1467.9761123657227,"y":1408.8809127807617,"wires":[[]]},{"id":"32ab6f9c.d52c4","type":"function","z":"20f50063.3774f","name":"global set PS4","func":"var PS4 = global.set ('PS4', msg.payload);\nvar oldDirt = global.set ('oldFilt', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1454.6428833007812,"y":1447.2142219543457,"wires":[[]]},{"id":"4b60336f.5ce2fc","type":"delay","z":"20f50063.3774f","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":206.3095359802246,"y":1312.2143383026123,"wires":[["150d08a9.5635b7"]]},{"id":"cc8aade6.5d78c","type":"delay","z":"20f50063.3774f","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":227.9761734008789,"y":1358.8809127807617,"wires":[["a4bbdc33.641b8"]]},{"id":"e17aad46.dc856","type":"delay","z":"20f50063.3774f","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":239.64286041259766,"y":1397.2142868041992,"wires":[["1cb79f14.1426f1"]]},{"id":"75ad67c1.85a3f8","type":"function","z":"20f50063.3774f","name":"actPres","func":"msg.payload = global.get ('actPres');\nreturn msg;","outputs":1,"noerr":0,"x":211.3690528869629,"y":156.63096046447754,"wires":[["aa29a167.4c5fb"]]},{"id":"a4fc581f.b29c08","type":"function","z":"20f50063.3774f","name":"actFilt","func":"msg.payload = global.get ('actFilt');\nreturn msg;","outputs":1,"noerr":0,"x":224.642822265625,"y":236.59520530700684,"wires":[["7dd3135.a7a93ec"]]},{"id":"80bd8ee6.22838","type":"function","z":"20f50063.3774f","name":"global get PS2","func":"msg.payload = global.get('PS2');\nmsg.topic = 'PS2';\nreturn msg;","outputs":1,"noerr":0,"x":1187.6428909301758,"y":794.1190719604492,"wires":[["3e8f509a.b10a3"]]},{"id":"381fab48.fe24f4","type":"function","z":"20f50063.3774f","name":"global get PS3","func":"msg.payload = global.get('PS3');\nmsg.topic = 'PS3';\nreturn msg;","outputs":1,"noerr":0,"x":1198.6428909301758,"y":834.1190719604492,"wires":[["3e8f509a.b10a3"]]},{"id":"a200cf1f.54917","type":"function","z":"20f50063.3774f","name":"global get PS4","func":"msg.payload = global.get('PS4');\nmsg.topic = 'PS4';\nreturn msg;","outputs":1,"noerr":0,"x":1202.6428909301758,"y":881.1190719604492,"wires":[["3e8f509a.b10a3"]]},{"id":"96cf116d.4d903","type":"function","z":"20f50063.3774f","name":"global get PS0","func":"msg.payload = global.get('PS0');\nmsg.topic = 'PS0';\nreturn msg;","outputs":1,"noerr":0,"x":1180.6428909301758,"y":706.1190719604492,"wires":[["3e8f509a.b10a3"]]},{"id":"3ba1d810.179fa8","type":"function","z":"20f50063.3774f","name":"global get PS1","func":"msg.payload = global.get('PS1');\nmsg.topic = 'PS1';\nreturn msg;","outputs":1,"noerr":0,"x":1185.2620315551758,"y":747.1666793823242,"wires":[["3e8f509a.b10a3"]]},{"id":"38224de1.562342","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":975.2857971191404,"y":52.5,"wires":[["d68cbcf7.c0e44","ce342815.1a7948"]]},{"id":"be5d2b77.eab868","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":906.9524040222168,"y":429.16663098335266,"wires":[["2b71986a.4ea288"]]},{"id":"3f592781.f5bb88","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":891.9524230957031,"y":542.5,"wires":[["cf1159d3.a40368"]]},{"id":"6a4d642d.86518c","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":773.6191253662109,"y":1102.50004196167,"wires":[["9e16f1d5.278b5","ef8e5f48.35189","ed158732.1c3348"]]},{"id":"5902062a.7668a8","type":"inject","z":"20f50063.3774f","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":790.2857360839844,"y":1320.833251953125,"wires":[["79ffe2d0.180c5c","c5eb0d1e.8f292","a50c0000.c2e8"]]},{"id":"3e8f509a.b10a3","type":"vis in","z":"20f50063.3774f","language":"en","x":1420,"y":786.5,"wires":[[]]},{"id":"6db27f0f.2fbb2","type":"inject","z":"f0743a39.64d748","name":"ALRM 0","topic":"system_state","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":205,"y":67.5,"wires":[["935280ef.6b12"]]},{"id":"aac556b3.060c28","type":"inject","z":"f0743a39.64d748","name":"ALRM 1","topic":"system_state","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":205.3333511352539,"y":105.83337068557739,"wires":[["935280ef.6b12"]]},{"id":"555eabed.f931b4","type":"inject","z":"f0743a39.64d748","name":"ALRM 2","topic":"system_state","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":208.66667938232422,"y":141.16675233840942,"wires":[["935280ef.6b12"]]},{"id":"6617f979.263f38","type":"inject","z":"f0743a39.64d748","name":"blwr 0","topic":"blwr","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":206.66667938232422,"y":274.8333172798157,"wires":[["27dc9fd1.4f7bc"]]},{"id":"ac2f42f4.81e51","type":"inject","z":"f0743a39.64d748","name":"blwr 1","topic":"blwr","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":210.00000762939453,"y":319.1666913032532,"wires":[["27dc9fd1.4f7bc"]]},{"id":"27dc9fd1.4f7bc","type":"function","z":"f0743a39.64d748","name":"global set blwr","func":"global.set('blwr',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":405.99999237060547,"y":303.5000653266907,"wires":[[]]},{"id":"9c63b65.8ab7a48","type":"inject","z":"f0743a39.64d748","name":"blwr 2","topic":"blwr","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":213.3333511352539,"y":361.5000653266907,"wires":[["27dc9fd1.4f7bc"]]},{"id":"881eeb43.93c248","type":"inject","z":"f0743a39.64d748","name":"blwr 3","topic":"blwr","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"x":211.99991607666016,"y":402.16666078567505,"wires":[["27dc9fd1.4f7bc"]]},{"id":"e7cbfcdd.cc7a3","type":"inject","z":"f0743a39.64d748","name":"ALRM 3","topic":"system_state","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"x":209.99999237060547,"y":175.83333253860474,"wires":[["935280ef.6b12"]]},{"id":"6118df84.7a77d","type":"inject","z":"f0743a39.64d748","name":"Auto Tune PULSE","topic":"","payload":"ddd","payloadType":"str","repeat":"1","crontab":"","once":true,"x":174.33333587646484,"y":585.4999885559082,"wires":[["d5e6139f.ce288","33e5f78.e45f908","e5db04b1.978898","34d51806.879d28","52b0510c.2be76","cf9cdd2a.a8e06","3a405990.ea8326","cf483f39.3669a","c1aa1fb6.8578d","3b9f906c.bd813","16564c4.5c1adb4","f16e7c32.ed0b4","bf8bf559.7419a8"]]},{"id":"b1d12f6e.f1661","type":"comment","z":"f0743a39.64d748","name":"var","info":"var start_stop = global.get ('start_stop')||0;\nvar man_control = global.get ('man_control')||0;\nvar test_mode = global.get ('test_mode')||0;\nvar alarm = global.get ('alarm') || 0;\nvar blwr = global.get ('blwr') || 0;\nvar speed = global.get ('speed')|| 0;\nvar flt = global.get ('flt') || 1;\nvar count = global.get ('count') || 0;\nvar permPres = global.get ('permPres') || 2.5;\nvar actPres = global.get ('actPres') || 5.5;\nvar permPlo = global.get ('permPlo') || 3.5;\nvar permPhi = global.get ('permPhi') || 7.5;\nvar dirtFilt = global.get ('dirtFilt') || 2.5;\nvar permFilt = global.get ('permFilt') || 0.2;\nvar begin = global.get ('begin') || 0;\nvar step1 = global.get ('step1' ) || 0;\nvar step2 = global.get ('step2' ) || 0;\nvar step3 = global.get ('step3' ) || 0;\nvar step4 = global.get ('step4' ) || 0;\nvar step5 = global.get ('step5' ) || 0;\nvar step6 = global.get ('step6' ) || 0;\nvar step7 = global.get ('step7' ) || 0;\nvar gate = global.get ('gate' ) || 0;\nvar table = global.get ('table' ) || 0;\nvar filterlife = global.get ('filterlife' ) || 0;\nvar ballvalve = global.get ('ballvalve' ) || 0;\nvar gate2 = global.get ('gate2' ) || 0;\nvar table2 = global.get ('table2' ) || 0;\nvar filterlife2 = global.get ('filterlife2' ) || 0;\nvar ballvalve = global.get ('ballvalve' ) || 0;\nvar reset = global.get ('reset' ) || 0;\nvar test_mode = global.get ('test_mode' ) || 0;\nvar phase = global.get ('phase' ) || 1;\nvar scott = global.get ('scott') || 0;","x":162.6667251586914,"y":515.5000057220459,"wires":[]},{"id":"e5db04b1.978898","type":"function","z":"f0743a39.64d748","name":"global get man_control","func":"msg.payload = global.get('man_control');\nmsg.topic = 'man_control';\nreturn msg;","outputs":1,"noerr":0,"x":617.7143096923828,"y":668.4047671556473,"wires":[["f5eab88c.3d73c8"]]},{"id":"34d51806.879d28","type":"function","z":"f0743a39.64d748","name":"global get test_mode","func":"msg.payload = global.get('test_mode');\nmsg.topic = 'test_mode';\nreturn msg;","outputs":1,"noerr":0,"x":631.3333358764648,"y":702.166660785675,"wires":[["f5eab88c.3d73c8"]]},{"id":"c6c76e.59eca89","type":"function","z":"f0743a39.64d748","name":"global get alarm","func":"msg.payload = global.get('alarm');\nmsg.topic = 'alarm';\nreturn msg;","outputs":1,"noerr":0,"x":966.3333854675293,"y":507.1666750907898,"wires":[["f5eab88c.3d73c8"]]},{"id":"52b0510c.2be76","type":"function","z":"f0743a39.64d748","name":"global get blwr","func":"msg.payload = global.get('blwr');\nmsg.topic = 'blwr';\nreturn msg;","outputs":1,"noerr":0,"x":451.52376556396484,"y":848.6428570747375,"wires":[["c49cc6e3.44fd08","1a21ebc0.edb344","f5eab88c.3d73c8"]]},{"id":"c49cc6e3.44fd08","type":"function","z":"f0743a39.64d748","name":"global get speed","func":"if (global.get('blwr')===0) {global.set('speed', 'BLWR IDLE');}\nif (global.get('blwr')===1) {global.set('speed', 'BLWR WIND UP');}\nif (global.get('blwr')===2) {global.set('speed', 'FULL SPEED');}\nif (global.get('blwr')===3) {global.set('speed', 'BLWR SLOWING');}\nif (global.get('blwr')===4) {global.set('speed', 'BLWR LOCKED OFF');}\nmsg.payload = global.get('speed');\nmsg.topic = 'speed';\nreturn msg;","outputs":1,"noerr":0,"x":692.6667251586914,"y":811.6427699327469,"wires":[["f5eab88c.3d73c8"]]},{"id":"cf483f39.3669a","type":"function","z":"f0743a39.64d748","name":"global get flt","func":"msg.payload = global.get('flt');\nmsg.topic = 'flt';\nreturn msg;","outputs":1,"noerr":0,"x":460.33333587646484,"y":809.5000348091125,"wires":[["f5eab88c.3d73c8"]]},{"id":"d5e6139f.ce288","type":"function","z":"f0743a39.64d748","name":"global get begin","func":"msg.payload = global.get('begin');\nmsg.topic = 'begin';\nreturn msg;","outputs":1,"noerr":0,"x":638.8095321655273,"y":596.0715069770813,"wires":[["f5eab88c.3d73c8"]]},{"id":"19ea29b3.2f6736","type":"function","z":"f0743a39.64d748","name":"global get phase","func":"msg.payload = global.get('phase');\nmsg.topic = 'phase';\nreturn msg;","outputs":1,"noerr":0,"x":951.666576385498,"y":442.8333010673523,"wires":[["f5eab88c.3d73c8"]]},{"id":"3a405990.ea8326","type":"function","z":"f0743a39.64d748","name":"global get ballvalve","func":"msg.payload = global.get('ballvalve');\nmsg.topic = 'ballvalve';\nreturn msg;","outputs":1,"noerr":0,"x":469.99996185302734,"y":890.0713238716125,"wires":[["10fe7a19.7bbf66","f5eab88c.3d73c8"]]},{"id":"8fd32e1b.eb91c","type":"inject","z":"f0743a39.64d748","name":"FLOAT:Off 1","topic":"flt","payload":"1","payloadType":"num","repeat":"","crontab":"","once":true,"x":213.78589248657227,"y":1607.4999432563782,"wires":[["9a0eafe.1cd315"]]},{"id":"199ccc26.146184","type":"inject","z":"f0743a39.64d748","name":"FLOAT:On 0","topic":"flt","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":205.33350372314453,"y":1668.9761300086975,"wires":[["9a0eafe.1cd315"]]},{"id":"9a0eafe.1cd315","type":"function","z":"f0743a39.64d748","name":"global set flt","func":"global.set('flt',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":424.4049377441406,"y":1650.7976050376892,"wires":[[]]},{"id":"28377172.68f3be","type":"function","z":"f0743a39.64d748","name":"global set man_control","func":"global.set('man_control',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":861.0597763061523,"y":1169.499668598175,"wires":[[]]},{"id":"6fec7c6.b896484","type":"switch","z":"f0743a39.64d748","name":"set topic man_control","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"man_control","vt":"str"}],"checkall":"true","outputs":1,"x":408.34500885009766,"y":1181.0952496528625,"wires":[["bb85854d.ec0968"]]},{"id":"c1aa1fb6.8578d","type":"function","z":"f0743a39.64d748","name":"compare man_control, blwr, flt, alarm","func":"if (global.get('man_control')===1 && global.get ('flt')===1 && \nglobal.get ('blwr')===0 && global.get ('alarm')===0 && global.get ('tune')===0) {\nvar ballvalve = global.set ('ballvalve',1);\nmsg.payload = global.get ('ballvalve');\nmsg.topic = 'ballvalve';\nreturn msg;\n}\nelse \nif (global.get('dynFill')==1 && global.get ('blwr')===2 && global.get ('alarm')===0 && \nglobal.get ('tune')===0) {\nvar ballvalve = global.set ('ballvalve',1);\nmsg.payload = global.get ('ballvalve');\nmsg.topic = 'ballvalve';\nreturn msg;\n} else\nif (global.get('tune')===1) {\nmsg.payload = global.get ('ballvalve');\nmsg.topic = 'ballvalve';\nreturn msg;\n}\nglobal.set('ballvalve', 0 );\nmsg.payload = global.get ('ballvalve');\nmsg.topic = 'ballvalve';","outputs":1,"noerr":0,"x":657.1309432983398,"y":739.0832867622375,"wires":[["f5eab88c.3d73c8"]]},{"id":"7787577d.f52338","type":"inject","z":"f0743a39.64d748","name":"","topic":"man_control","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":240.33333587646484,"y":1035.8332867622375,"wires":[["bb85854d.ec0968"]]},{"id":"4f504d37.7a7964","type":"inject","z":"f0743a39.64d748","name":"","topic":"man_control","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"x":211.14286041259766,"y":1084.2141461372375,"wires":[["bb85854d.ec0968"]]},{"id":"bb85854d.ec0968","type":"change","z":"f0743a39.64d748","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":646.2261581420898,"y":1174.08340883255,"wires":[["28377172.68f3be"]]},{"id":"41fb2f76.75d46","type":"inject","z":"f0743a39.64d748","name":"START - ON","topic":"start_stop","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":245.3333282470703,"y":1327.166660785675,"wires":[["4aa87b98.0def34"]]},{"id":"b9ba769d.bb52c8","type":"inject","z":"f0743a39.64d748","name":"START OFF (STOP)","topic":"start_stop","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":232.09514617919922,"y":1363.4050641059875,"wires":[["4aa87b98.0def34"]]},{"id":"4aa87b98.0def34","type":"function","z":"f0743a39.64d748","name":"global set START_STOP","func":"global.set('start_stop',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":610.8928146362305,"y":1326.1428570747375,"wires":[["58f07a78.8a2364"]]},{"id":"c159d09e.030cf","type":"switch","z":"f0743a39.64d748","name":"set topic start_stop","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"start_stop","vt":"str"}],"checkall":"true","outputs":1,"x":400.71432876586914,"y":1226.785695195198,"wires":[["745dc975.cce278"]]},{"id":"8a7fc7eb.50d048","type":"trigger","z":"f0743a39.64d748","op1":"","op2":"1","op1type":"nul","op2type":"num","duration":"15","extend":false,"units":"s","reset":"99","name":"WIND UP TMR","x":1528.1907653808594,"y":976.928572177887,"wires":[["9f09ac3e.a797f"]]},{"id":"a91bf041.f769b","type":"trigger","z":"f0743a39.64d748","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"2","extend":true,"units":"s","reset":"99","name":"blwer on","x":878.1428451538086,"y":1008.5711407661438,"wires":[["fd0c7c2d.03975","5590ebe1.08d684"]]},{"id":"3ff20f3d.37e2b","type":"function","z":"f0743a39.64d748","name":"reset true","func":"global.set ('reset',99);\nreturn;","outputs":1,"noerr":0,"x":1252.392635345459,"y":1290.4521646499634,"wires":[[]]},{"id":"fd0c7c2d.03975","type":"rbe","z":"f0743a39.64d748","name":"","func":"rbe","gap":"","start":"","inout":"out","x":1085.9999618530273,"y":986.4999737739563,"wires":[["f53822e1.5c665"]]},{"id":"9f09ac3e.a797f","type":"function","z":"f0743a39.64d748","name":"global set blwr","func":"global.set('blwr',2);\nreturn ;","outputs":1,"noerr":0,"x":1637.666591644287,"y":906.5000958442688,"wires":[[]]},{"id":"f53822e1.5c665","type":"switch","z":"f0743a39.64d748","name":"1 up 0 dwn","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":1271.3333358764648,"y":976.4999737739563,"wires":[["8a7fc7eb.50d048"],["828a659a.b58938"]]},{"id":"f7ec90e9.6704e","type":"trigger","z":"f0743a39.64d748","op1":"","op2":"1","op1type":"nul","op2type":"num","duration":"30","extend":false,"units":"s","reset":"99","name":"WIND DWN TMR","x":1532.7738914489746,"y":1071.47598695755,"wires":[["b7efe5e9.6865c8"]]},{"id":"206341e6.8444be","type":"change","z":"f0743a39.64d748","name":"reset 99","rules":[{"t":"set","p":"payload","pt":"msg","to":"99","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":914.4284286499023,"y":1207.547520160675,"wires":[["f7ec90e9.6704e","3ff20f3d.37e2b","8a7fc7eb.50d048"]]},{"id":"d65f9ea9.e41e2","type":"switch","z":"f0743a39.64d748","name":"reset","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"reset","vt":"str"}],"checkall":"true","outputs":1,"x":627.2856063842773,"y":1211.9285016059875,"wires":[["206341e6.8444be"]]},{"id":"828a659a.b58938","type":"function","z":"f0743a39.64d748","name":"global set blwr","func":"global.set('blwr',3);\nreturn;","outputs":1,"noerr":0,"x":1527.3332176208496,"y":1026.4997906684875,"wires":[[]]},{"id":"b7efe5e9.6865c8","type":"function","z":"f0743a39.64d748","name":"global set blwr","func":"global.set('blwr',0);\nreturn;","outputs":1,"noerr":0,"x":1631.1903953552246,"y":1144.4999127388,"wires":[[]]},{"id":"1a21ebc0.edb344","type":"switch","z":"f0743a39.64d748","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"3","vt":"num"},{"t":"eq","v":"4","vt":"num"}],"checkall":"true","outputs":5,"x":594.0000343322754,"y":1017.1667433977127,"wires":[[],["a91bf041.f769b"],["a91bf041.f769b"],["f7ec90e9.6704e","6434cd99.e0f2f4"],["f5eab88c.3d73c8"]]},{"id":"58f07a78.8a2364","type":"function","z":"f0743a39.64d748","name":"global check blwr","func":"var newmsg = msg.payload; var newmsg2 = global.get('blwr');\nif (newmsg2 ===0 && newmsg === 1) {global.set('blwr', 1)}\nif (newmsg2 ===0 && newmsg === 0) {global.set('blwr', 0)}\nif (newmsg2 ==1 && newmsg === 0) {global.set('blwr', 3)}\nif (newmsg2 ==2 && newmsg === 0) {global.set('blwr', 3)}\nif (newmsg2 ==3 && newmsg === 1) {global.set('blwr', 1)}\nif (newmsg2 ==3 && newmsg === 0) {global.set('blwr', 0)}\nif (global.get('reset')== 99 )  {global.set('blwr', 0)}\nmsg.payload = global.get('blwr');\nmsg.topic = 'blwr';\nreturn;","outputs":1,"noerr":0,"x":875.6667098999023,"y":1330.274082660675,"wires":[[]]},{"id":"cf9cdd2a.a8e06","type":"function","z":"f0743a39.64d748","name":"global get man_fill","func":"if (global.get('man_control')===0) {global.set('man_fill', 'MAN FILL OFF');}\nif (global.get('man_control')==1) {global.set('man_fill', 'MAN FILL ON');}\nif (global.get('alarm') > 0) {global.set('man_fill', 'LOCKED OUT');}\nmsg.payload = global.get('man_fill');\nmsg.topic = 'man_fill';\nreturn msg;","outputs":1,"noerr":0,"x":551.0000228881836,"y":774.8332867622375,"wires":[["f5eab88c.3d73c8"]]},{"id":"743d5f4d.a650b","type":"function","z":"f0743a39.64d748","name":"global set valve_state","func":"if (global.get('ballvalve')===0) {global.set('valve_state', 'WATER OFF')}\nelse if (global.get('ballvalve')===1) {global.set('valve_state', 'WATER ADDING')}\nelse if (global.get('alarm')>0) {global.set('valve_state', 'LOCKED OUT')}\nmsg.payload = global.get('valve_state');\nmsg.topic = 'valve_state';\nreturn msg;","outputs":1,"noerr":0,"x":1119.3929061889648,"y":911.4642071723938,"wires":[["f5eab88c.3d73c8"]]},{"id":"7c981b8f.302b54","type":"trigger","z":"f0743a39.64d748","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"3","extend":true,"units":"s","reset":"99","name":"valve off delay","x":889.0592880249023,"y":878.0119366645813,"wires":[["743d5f4d.a650b"]]},{"id":"10fe7a19.7bbf66","type":"switch","z":"f0743a39.64d748","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":702.6308212280273,"y":913.9285626411438,"wires":[["7c981b8f.302b54"],["743d5f4d.a650b"]]},{"id":"513a54cc.2c049c","type":"function","z":"f0743a39.64d748","name":"global set system_state","func":"if (global.get('blwr')===0) {global.set('system_state', 'ALARM IDLE');}\nif (global.get('blwr')===1) {global.set('system_state', 'SETTING ALARM');}\nif (global.get('blwr')===2) {global.set('system_state', 'OPERATION SAFE');}\nif (global.get('blwr')===3) {global.set('system_state', 'ALARM IN-ACTIVE');}\nif (global.get('blwr')===4) {global.set('system_state', 'TRIGGERED');}\nmsg.payload = global.get('system_state');\nmsg.topic = 'system_state';\nreturn msg;","outputs":1,"noerr":0,"x":949.333324432373,"y":408.1666750907898,"wires":[["f5eab88c.3d73c8"]]},{"id":"33e5f78.e45f908","type":"function","z":"f0743a39.64d748","name":"global get start_stop","func":"msg.payload = global.get('start_stop');\nmsg.topic = 'start_stop';\nreturn msg;","outputs":1,"noerr":0,"x":624.2380599975586,"y":632.3096051216125,"wires":[["f5eab88c.3d73c8"]]},{"id":"df9589a1.f76fd8","type":"inject","z":"f0743a39.64d748","name":"","topic":"actPres","payload":"7.5","payloadType":"num","repeat":"","crontab":"","once":false,"x":195.28570556640625,"y":2272.404531478882,"wires":[["6c5ec54f.7276ec"]]},{"id":"d76b0e9a.d947c","type":"inject","z":"f0743a39.64d748","name":"","topic":"actPres","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":213.9999771118164,"y":2091.8338718414307,"wires":[["6c5ec54f.7276ec"]]},{"id":"8e45463b.df8348","type":"inject","z":"f0743a39.64d748","name":"","topic":"actPres","payload":"5.9","payloadType":"num","repeat":"","crontab":"","once":false,"x":195.61904907226562,"y":2147.5003757476807,"wires":[["6c5ec54f.7276ec"]]},{"id":"50031768.af1078","type":"inject","z":"f0743a39.64d748","name":"","topic":"actPres","payload":"10","payloadType":"num","repeat":"","crontab":"","once":false,"x":213.23809051513672,"y":2317.0239429473877,"wires":[["6c5ec54f.7276ec"]]},{"id":"5cabb25a.35cd8c","type":"inject","z":"f0743a39.64d748","name":"","topic":"actFilt","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":224.0714340209961,"y":2397.8572788238525,"wires":[["4408e726.020fc8"]]},{"id":"abe09c46.c61bf","type":"inject","z":"f0743a39.64d748","name":"","topic":"actFilt","payload":"0.25","payloadType":"num","repeat":"","crontab":"","once":false,"x":230.7380828857422,"y":2437.524278640747,"wires":[["4408e726.020fc8"]]},{"id":"bf7fa0e8.e3521","type":"inject","z":"f0743a39.64d748","name":"","topic":"actFilt","payload":"0.85","payloadType":"num","repeat":"","crontab":"","once":false,"x":238.7380828857422,"y":2476.524118423462,"wires":[["4408e726.020fc8"]]},{"id":"6c5ec54f.7276ec","type":"function","z":"f0743a39.64d748","name":"global set actPres","func":"global.set('actPres',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":421.3808822631836,"y":2309.547520160675,"wires":[[]]},{"id":"4408e726.020fc8","type":"function","z":"f0743a39.64d748","name":"global set actFilt","func":"global.set('actFilt',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":459.3333206176758,"y":2454.0713109970093,"wires":[[]]},{"id":"4f08df13.6fcc2","type":"function","z":"f0743a39.64d748","name":"determine demand for dyn water","func":"var setPress = global.get('setPres');\nvar actPress = global.get('actPres');\nvar diff = (setPress-actPress);\nif (diff >= 0.25 ) {dynFill = global.set ('dynFill', 1 );\nmsg.payload = diff; msg.topic = 'actPres';\n    return msg;\n}\nif (diff < 0.25 ) {dynFill = global.set ('dynFill', 0 );\nmsg.payload = diff;\n//msg.topic = 'actPres';\n    return msg;\n}\n","outputs":1,"noerr":0,"x":844.0389022827148,"y":1651.1665387153625,"wires":[["ce07620b.5fc5f"]]},{"id":"5b32252a.ecf54c","type":"inject","z":"f0743a39.64d748","name":"","topic":"actPres","payload":"7.0","payloadType":"num","repeat":"","crontab":"","once":false,"x":188.85713958740234,"y":2211.6903505325317,"wires":[["6c5ec54f.7276ec"]]},{"id":"97eb48e.76b8cb8","type":"function","z":"f0743a39.64d748","name":"get dynFill","func":"msg.payload = global.get('dynFill');\nmsg.topic = 'dynFill';\nreturn msg;","outputs":1,"noerr":0,"x":914.4167098999023,"y":1688.4165387153625,"wires":[["ce07620b.5fc5f"]]},{"id":"f3389742.b942c8","type":"comment","z":"f0743a39.64d748","name":"alrm 0 1 2 3 ","info":"0 - idle\n1 - hi press water oldPhi\n2 - lo press water oldPlo\n3 - dirtFilt dirtFilt","x":391.0000228881836,"y":105.50000429153442,"wires":[]},{"id":"ac20617b.58ad3","type":"comment","z":"f0743a39.64d748","name":"blwr 0 1 2 3 ","info":"0 - idle\n1 - wind up\n2 - full speed\n3 - wind down","x":400.6666488647461,"y":258.16666078567505,"wires":[]},{"id":"ad4fe8d9.b29718","type":"inject","z":"f0743a39.64d748","name":"reboot!","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":545.9999923706055,"y":62.166672229766846,"wires":[["9dd69123.791f5"]]},{"id":"9dd69123.791f5","type":"exec","z":"f0743a39.64d748","command":"reboot #","addpay":false,"append":"","useSpawn":"","name":"reboot Pi","x":711.5000228881836,"y":62.708336353302,"wires":[[],[],[]]},{"id":"75c12ef5.571f6","type":"function","z":"f0743a39.64d748","name":"global get alarm state","func":"if (global.get('alarm')===0) {\n    global.set('permPhi', 0);\n    global.set('permPlo', 0);\n    global.set('permDirt', 0);\n    global.set('timedout_alarm', 0);\n    return;\n}\nif (global.get('alarm')===1) {global.set('permPhi', 1);\n    global.set('permPlo', 0);\n    global.set('permDirt', 0); \n    global.set('timedout_alarm', 0);\n    return;\n}\nif (global.get('alarm')===2) {global.set('permPlo', 1);\n    global.set('permDirt', 0);\n    global.set('permPhi', 0);\n    global.set('timedout_alarm', 0);\n    return;\n}\nif (global.get('alarm')===3) {global.set('permDirt', 1);\n    global.set('permPhi', 0);\n    global.set('permPlo', 0); \n    global.set('timedout_alarm', 0);\n    return;\n}\nif (global.get('alarm')===4) {global.set('timedout_alarm', 1);\n    global.set('permPhi', 0);\n    global.set('permPlo', 0); \n    global.set('permDirt', 0);\n    return;\n}\nreturn ;","outputs":1,"noerr":0,"x":909.6666488647461,"y":225.16653871536255,"wires":[[]]},{"id":"d3476809.b1ec68","type":"function","z":"f0743a39.64d748","name":"global get oldPhi","func":"msg.payload = global.get('oldPhi');\nmsg.topic = 'oldPhi';\nreturn msg;","outputs":1,"noerr":0,"x":896.6666488647461,"y":1733.833164691925,"wires":[["ce07620b.5fc5f"]]},{"id":"dee9c100.8d2ad","type":"function","z":"f0743a39.64d748","name":"global get oldPlo","func":"msg.payload = global.get('oldPlo');\nmsg.topic = 'oldPlo';\nreturn msg;","outputs":1,"noerr":0,"x":894.6666488647461,"y":1773.166660785675,"wires":[["ce07620b.5fc5f"]]},{"id":"bce71ca7.96488","type":"function","z":"f0743a39.64d748","name":"global get dirtFilt","func":"msg.payload = global.get('dirtFilt');\nmsg.topic = 'dirtFilt';\nreturn msg;","outputs":1,"noerr":0,"x":893.6666488647461,"y":1811.833164691925,"wires":[["ce07620b.5fc5f"]]},{"id":"ddec3e07.4efec","type":"inject","z":"f0743a39.64d748","name":"blwr 4","topic":"blwr","payload":"4","payloadType":"num","repeat":"","crontab":"","once":false,"x":214.33334350585938,"y":438.4999737739563,"wires":[["27dc9fd1.4f7bc"]]},{"id":"c0c90d40.73c16","type":"function","z":"f0743a39.64d748","name":"alarm lock out","func":"if (global.get ('alarm') > 0) {\nglobal.set ('blwr',4);\nglobal.set ('ballvalve', 0);\nglobal.set ('man_control', 0);\nglobal.set ('start_stop', 0);\nglobal.set ('valve_state', 'LOCKED OUT');\nglobal.set ('man_fill', 'LOCKED OUT');\nglobal.set ('dynFill', 0);\nreturn;\n}\nelse return;","outputs":1,"noerr":0,"x":881.9999656677246,"y":299.8333172798157,"wires":[[]]},{"id":"568b8512.e9b9fc","type":"function","z":"f0743a39.64d748","name":"global get actPres","func":"//var newmsg = global.get('PS0');\n//global.set('actFilt',newmsg);\nmsg.payload = global.get('actPres');\nmsg.topic = 'actPres';\nreturn msg;","outputs":1,"noerr":0,"x":891.2380599975586,"y":1876.83340883255,"wires":[["ce07620b.5fc5f"]]},{"id":"d9824f8c.3a4fb","type":"function","z":"f0743a39.64d748","name":"global get actFilt","func":"//var newmsg = global.get('PS0') - global.get ('PS1');\n//var actFilt = global.set('actFilt',msg.payload);\nmsg.payload = global.get('actFilt');\nmsg.topic = 'actFilt';\nreturn msg;","outputs":1,"noerr":0,"x":894.4523544311523,"y":1913.952305316925,"wires":[["ce07620b.5fc5f"]]},{"id":"5590ebe1.08d684","type":"switch","z":"f0743a39.64d748","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":1069.1905136108398,"y":1032.6904644966125,"wires":[["2ef52e75.364662"],[]]},{"id":"2ef52e75.364662","type":"change","z":"f0743a39.64d748","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"99","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1237.9047470092773,"y":1032.4048199653625,"wires":[["f7ec90e9.6704e"]]},{"id":"6434cd99.e0f2f4","type":"function","z":"f0743a39.64d748","name":"global set blwr","func":"global.set('blwr',3);\nglobal.set('start_stop',0);\nreturn msg;","outputs":1,"noerr":0,"x":857.5833358764648,"y":1046.1190533638,"wires":[["f5eab88c.3d73c8"]]},{"id":"745dc975.cce278","type":"change","z":"f0743a39.64d748","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":587.6190719604492,"y":1249.547520160675,"wires":[["58f07a78.8a2364","4aa87b98.0def34","23d39ba3.f60ef4"]]},{"id":"23d39ba3.f60ef4","type":"function","z":"f0743a39.64d748","name":"start stop reset windup","func":"if (msg.payload === 0) {msg.payload = 99;\nreturn msg;\n}\nelse\nreturn;","outputs":1,"noerr":0,"x":864.0476303100586,"y":1249.1190533638,"wires":[["8a7fc7eb.50d048"]]},{"id":"4fd73c3c.5c4204","type":"function","z":"f0743a39.64d748","name":"global set begin","func":"global.set('begin',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":875.3809432983398,"y":1499.642735004425,"wires":[["8495b04e.2c5ad"]]},{"id":"8495b04e.2c5ad","type":"function","z":"f0743a39.64d748","name":"place holder begin","func":"msg.topic = \"begin\";\nreturn msg;","outputs":1,"noerr":0,"x":979.1547470092773,"y":1564.774082660675,"wires":[[]]},{"id":"8cf60353.21531","type":"change","z":"f0743a39.64d748","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":643.7264022827148,"y":1497.5234723091125,"wires":[["8495b04e.2c5ad","4fd73c3c.5c4204"]]},{"id":"a700993a.138508","type":"switch","z":"f0743a39.64d748","name":"set topic begin","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"begin","vt":"str"}],"checkall":"true","outputs":1,"x":399.4881820678711,"y":1495.3330426216125,"wires":[["8cf60353.21531"]]},{"id":"8e673920.81f5d8","type":"inject","z":"f0743a39.64d748","name":"","topic":"begin","payload":"true","payloadType":"str","repeat":"","crontab":"","once":false,"x":203.3808822631836,"y":1508.3094830513,"wires":[["a700993a.138508"]]},{"id":"70bc30d2.42059","type":"inject","z":"f0743a39.64d748","name":"","topic":"begin","payload":"false","payloadType":"str","repeat":"","crontab":"","once":false,"x":206.8808822631836,"y":1547.5594830513,"wires":[["a700993a.138508"]]},{"id":"fafd7012.d9f87","type":"function","z":"f0743a39.64d748","name":"autotune reset windup","func":"if (msg.payload === 0) {msg.payload = 99;\nreturn msg;\n}\nelse\nreturn;","outputs":1,"noerr":0,"x":862.3808822631836,"y":1289.3094830513,"wires":[["8a7fc7eb.50d048"]]},{"id":"db9f4760.6e72f8","type":"switch","z":"f0743a39.64d748","name":"set topic begin","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"begin","vt":"str"}],"checkall":"true","outputs":1,"x":365.04759979248047,"y":1288.3094830513,"wires":[["fafd7012.d9f87"]]},{"id":"ec928068.8fd93","type":"function","z":"f0743a39.64d748","name":"set global alarm","func":"if (global.get('tune')===0 && global.get('blwr')===2 && \n    global.get('actPres')>= global.get('oldPhi')) {\n    global.set('alarm',1);\n    return;}\nelse\nif (global.get('tune')===0 && global.get('blwr')===2 && \n    global.get('actPres')<= global.get('oldPlo')) {\n    global.set('alarm',2);\n    return;}\nelse\nif (global.get('tune')===0 && global.get('blwr')===2 && \n    global.get('filter_pressure')>= global.get('oldFilt')) {\n    global.set('alarm',3);\n    return;}\nelse\nif (global.get('tune')===1 && global.get('timedout')===1) {\n    global.set('alarm',4);\n    return;}\nmsg.payload = global.get('alarm');\nmsg.topic = 'alarm';\nreturn msg;","outputs":1,"noerr":0,"x":958.833324432373,"y":474.1190676689148,"wires":[["f5eab88c.3d73c8"]]},{"id":"935280ef.6b12","type":"function","z":"f0743a39.64d748","name":"global set alarm","func":"global.set('alarm',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":396.33333587646484,"y":141.11905336380005,"wires":[[]]},{"id":"61b6a279.4f01cc","type":"function","z":"f0743a39.64d748","name":"global get permPhi","func":"msg.payload = global.get('permPhi');\nmsg.topic = 'permPhi';\nreturn msg;","outputs":1,"noerr":0,"x":898.3333358764648,"y":2001.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"f151da58.26dae8","type":"function","z":"f0743a39.64d748","name":"global get permPlo","func":"msg.payload = global.get('permPlo');\nmsg.topic = 'permPlo';\nreturn msg;","outputs":1,"noerr":0,"x":895.3333358764648,"y":2040.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"d4c5e293.f426e","type":"function","z":"f0743a39.64d748","name":"global get permDirt","func":"msg.payload = global.get('permDirt');\nmsg.topic = 'permDirt';\nreturn msg;","outputs":1,"noerr":0,"x":896.3333358764648,"y":2078.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"81b01cbe.7633c","type":"function","z":"f0743a39.64d748","name":"global get setFilt","func":"msg.payload = global.get('setFilt');\nmsg.topic = 'setFilt';\nreturn msg;","outputs":1,"noerr":0,"x":905.3333358764648,"y":1953.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"d0984bb7.2d5ce8","type":"function","z":"f0743a39.64d748","name":"global get timedout_alarm","func":"msg.payload = global.get('timedout_alarm');\nmsg.topic = 'timedout_alarm';\nreturn msg;","outputs":1,"noerr":0,"x":875.7619247436523,"y":2118.40469789505,"wires":[["ce07620b.5fc5f"]]},{"id":"a51d5e94.4e4fd","type":"inject","z":"f0743a39.64d748","name":"ALRM 4","topic":"system_state","payload":"4","payloadType":"num","repeat":"","crontab":"","once":false,"x":209.33333587646484,"y":211.11905336380005,"wires":[["935280ef.6b12"]]},{"id":"65571b5a.d7ce24","type":"switch","z":"f0743a39.64d748","name":"set topic test_mode","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"test_mode","vt":"str"}],"checkall":"true","outputs":1,"x":359.40474700927734,"y":1412.5832867622375,"wires":[["eab73843.642bb8"]]},{"id":"eab73843.642bb8","type":"change","z":"f0743a39.64d748","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":630.2618026733398,"y":1409.9286236763,"wires":[["5ce9a56b.49e72c"]]},{"id":"5ce9a56b.49e72c","type":"function","z":"f0743a39.64d748","name":"global set test_mode","func":"global.set('test_mode',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":860.8332443237305,"y":1412.011875629425,"wires":[[]]},{"id":"30036f7e.631bd","type":"switch","z":"f0743a39.64d748","name":"switch","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":587.8571739196777,"y":303.6645350456238,"wires":[["8b2e6149.800a5"],["ec928068.8fd93","c0c90d40.73c16","75c12ef5.571f6","daba3f41.c8f49","19ea29b3.2f6736","c6c76e.59eca89","513a54cc.2c049c","24a6e35.36d391c","7a3757ba.f84878"]]},{"id":"8b2e6149.800a5","type":"trigger","z":"f0743a39.64d748","op1":"","op2":"0","op1type":"nul","op2type":"str","duration":"10","extend":false,"units":"min","reset":"99","name":"","x":745.8333358764648,"y":190.11905336380005,"wires":[["a2521574.c9b798"]]},{"id":"a2521574.c9b798","type":"function","z":"f0743a39.64d748","name":"global reset test_mode","func":"global.set('test_mode',0);\nreturn;","outputs":1,"noerr":0,"x":970.4761199951172,"y":142.26190328598022,"wires":[[]]},{"id":"38d01d4a.d1c342","type":"function","z":"f0743a39.64d748","name":"global get setPhi","func":"msg.payload = global.get('setPhi');\nmsg.topic = 'setPhi';\nreturn msg;","outputs":1,"noerr":0,"x":861.3333358764648,"y":2164.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"f935f051.133fb","type":"function","z":"f0743a39.64d748","name":"global get setPlo","func":"msg.payload = global.get('setPlo');\nmsg.topic = 'setPlo';\nreturn msg;","outputs":1,"noerr":0,"x":852.3333358764648,"y":2202.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"d44ee7a6.1cf0f8","type":"function","z":"f0743a39.64d748","name":"global get setDirt","func":"msg.payload = global.get('setDirt');\nmsg.topic = 'setDirt';\nreturn msg;","outputs":1,"noerr":0,"x":846.3333358764648,"y":2243.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"2a5d1293.362a6e","type":"inject","z":"f0743a39.64d748","name":"","topic":"phase_check","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":337.33333587646484,"y":944.1190533638,"wires":[["998d89b8.03dcb8"]]},{"id":"cac120c8.b1ec5","type":"inject","z":"f0743a39.64d748","name":"","topic":"phase_check","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"x":328.14286041259766,"y":991.4999127388,"wires":[["998d89b8.03dcb8"]]},{"id":"bcf7ca40.8630c8","type":"switch","z":"f0743a39.64d748","name":"set topic phase_check","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"phase_check","vt":"str"}],"checkall":"true","outputs":1,"x":411.34500885009766,"y":1122.381016254425,"wires":[["998d89b8.03dcb8"]]},{"id":"998d89b8.03dcb8","type":"change","z":"f0743a39.64d748","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":645.2261619567871,"y":1132.3691754341125,"wires":[["d2749831.172888"]]},{"id":"d2749831.172888","type":"function","z":"f0743a39.64d748","name":"global set phase_check","func":"global.set('phase_check',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":867.0597801208496,"y":1129.7854351997375,"wires":[[]]},{"id":"daba3f41.c8f49","type":"change","z":"f0743a39.64d748","name":"reset on 0","rules":[{"t":"set","p":"payload","pt":"msg","to":"99","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":622.4761657714844,"y":134.40476751327515,"wires":[["8b2e6149.800a5"]]},{"id":"3b9f906c.bd813","type":"function","z":"f0743a39.64d748","name":"global set system_state","func":"if (global.get('test_mode')===1) {global.set('system_state', 'TEST MODE');}\nif (global.get('demo_mode')===1) {global.set('system_state', 'DEMO MODE');}\nmsg.payload = global.get('system_state');\nmsg.topic = 'system_state';\nreturn msg;","outputs":1,"noerr":0,"x":606.3333358764648,"y":560.1190533638,"wires":[["f5eab88c.3d73c8"]]},{"id":"16564c4.5c1adb4","type":"function","z":"f0743a39.64d748","name":"global get test or  demo mode","func":"if (global.get ('test_mode') ===1 || \nglobal.get ('demo_mode')===1) {\nmsg.payload = 1;\nreturn msg;\n} else\nmsg.payload = 0;\nreturn msg;\n","outputs":1,"noerr":0,"x":541.3333358764648,"y":411.11905336380005,"wires":[["30036f7e.631bd"]]},{"id":"114a256d.5cb86b","type":"switch","z":"f0743a39.64d748","name":"set topic demo_mode","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"demo_mode","vt":"str"}],"checkall":"true","outputs":1,"x":420.6666488647461,"y":1444.1191536188126,"wires":[["6093c322.183b8c"]]},{"id":"6093c322.183b8c","type":"change","z":"f0743a39.64d748","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"true","fromt":"bool","to":"1","tot":"num"},{"t":"change","p":"payload","pt":"msg","from":"false","fromt":"bool","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":630.1903610229492,"y":1450.4643902778625,"wires":[["e0deab4c.d935b8"]]},{"id":"e0deab4c.d935b8","type":"function","z":"f0743a39.64d748","name":"global set demo_mode","func":"global.set('demo_mode',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":860.7617721557617,"y":1447.5476422309875,"wires":[[]]},{"id":"f16e7c32.ed0b4","type":"function","z":"f0743a39.64d748","name":"global get demo_mode","func":"msg.payload = global.get('demo_mode');\nmsg.topic = 'demo_mode';\nreturn msg;","outputs":1,"noerr":0,"x":592.3333396911621,"y":522.1190533638,"wires":[["f5eab88c.3d73c8"]]},{"id":"3731e7a3.c60d68","type":"function","z":"f0743a39.64d748","name":"global get Phicount","func":"msg.payload = global.get('Phicount');\nmsg.topic = 'Phicount';\nreturn msg;","outputs":1,"noerr":0,"x":844.3333358764648,"y":2283.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"d87e4e9e.aa46","type":"function","z":"f0743a39.64d748","name":"global get Plocount","func":"msg.payload = global.get('Plocount');\nmsg.topic = 'Plocount';\nreturn msg;","outputs":1,"noerr":0,"x":847.3333358764648,"y":2326.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"95fcedd.19b6a1","type":"function","z":"f0743a39.64d748","name":"global get Dirtcount","func":"msg.payload = global.get('Dirtcount');\nmsg.topic = 'Dirtcount';\nreturn msg;","outputs":1,"noerr":0,"x":846.3333358764648,"y":2373.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"b75d6316.6f113","type":"function","z":"f0743a39.64d748","name":"global get Timedoutcount","func":"msg.payload = global.get('Timedoutcount');\nmsg.topic = 'Timedoutcount';\nreturn msg;","outputs":1,"noerr":0,"x":870.3333358764648,"y":2413.1190533638,"wires":[["ce07620b.5fc5f"]]},{"id":"f5eab88c.3d73c8","type":"vis in","z":"f0743a39.64d748","language":"en","x":1224.833339691162,"y":615.1190533638,"wires":[[]]},{"id":"c4cce115.a1b74","type":"vis in","z":"f0743a39.64d748","language":"en","x":88.83333969116211,"y":1193.1190533638,"wires":[["bcf7ca40.8630c8","6fec7c6.b896484","d65f9ea9.e41e2","c159d09e.030cf","db9f4760.6e72f8","65571b5a.d7ce24","114a256d.5cb86b","a700993a.138508"]]},{"id":"ce07620b.5fc5f","type":"vis in","z":"f0743a39.64d748","language":"en","x":1417.833339691162,"y":2020.1190533638,"wires":[[]]},{"id":"bf8bf559.7419a8","type":"function","z":"f0743a39.64d748","name":"get phase_check","func":"msg.payload = global.get('phase_check');\nmsg.topic = 'phase_check';\nreturn msg;","outputs":1,"noerr":0,"x":612.3333396911621,"y":488.11905336380005,"wires":[["f5eab88c.3d73c8"]]},{"id":"a85d1398.6c81f","type":"inject","z":"f0743a39.64d748","name":"Auto Tune PULSE","topic":"","payload":"ddd","payloadType":"str","repeat":"1","crontab":"","once":true,"x":318.3333396911621,"y":1910.1190533638,"wires":[["4f08df13.6fcc2","97eb48e.76b8cb8","d3476809.b1ec68","dee9c100.8d2ad","bce71ca7.96488","568b8512.e9b9fc","d9824f8c.3a4fb","81b01cbe.7633c","61b6a279.4f01cc","f151da58.26dae8","d4c5e293.f426e","d0984bb7.2d5ce8","38d01d4a.d1c342","f935f051.133fb","d44ee7a6.1cf0f8","3731e7a3.c60d68","d87e4e9e.aa46","95fcedd.19b6a1","b75d6316.6f113"]]},{"id":"24a6e35.36d391c","type":"function","z":"f0743a39.64d748","name":"phase lock out","func":"if (global.get ('phase')=== 0) {\nglobal.set ('blwr',4);\nglobal.set ('ballvalve', 0);\nglobal.set ('man_control', 0);\nglobal.set ('start_stop', 0);\nglobal.set ('valve_state', 'LOCKED OUT');\nglobal.set ('man_fill', 'LOCKED OUT');\nglobal.set ('dynFill', 0);\nreturn;\n}\nelse return;","outputs":1,"noerr":0,"x":895.5000114440918,"y":264.49998807907104,"wires":[[]]},{"id":"7a3757ba.f84878","type":"function","z":"f0743a39.64d748","name":"get phase alarm","func":"if (global.get ('phase') === 1)\n{\nmsg.payload = 1;\nreturn msg;\n} \nelse\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":906.5000114440918,"y":354.49998807907104,"wires":[["7bd65dfb.265cb4"]]},{"id":"7bd65dfb.265cb4","type":"switch","z":"f0743a39.64d748","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":1055.5000114440918,"y":350.49998807907104,"wires":[["b6135bb3.48fb68"],["14420bdd.13a244"]]},{"id":"14420bdd.13a244","type":"change","z":"f0743a39.64d748","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1241.5000114440918,"y":391.49998807907104,"wires":[["b6135bb3.48fb68"]]},{"id":"b6135bb3.48fb68","type":"trigger","z":"f0743a39.64d748","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":1250.0000114440918,"y":342.49998807907104,"wires":[["18f190e7.d248cf"]]},{"id":"18f190e7.d248cf","type":"function","z":"f0743a39.64d748","name":"SET CALL VARIABLES","func":"var alarm = global.set ('alarm', 0);\nvar blwr = global.set ('blwr', 0);\nvar permPlo = global.set ('permPlo', 0);\nvar permPhi = global.set ('permPhi', 0);\nvar permDirt = global.set ('permDirt', 0);\nvar begin = global.set ('begin', 0);\nvar step1 = global.set ('step1', 0);\nvar step2 = global.set ('step2', 0);\nvar step3 = global.set ('step3', 0);\nvar step4 = global.set ('step4', 0);\nvar step5 = global.set ('step5', 0);\nvar step6 = global.set ('step6', 0);\nvar step7 = global.set ('step7', 0);\nvar timedout = global.set ('timedout', 0);\nvar timedout_alarm = global.set ('timedout_alarm', 0);\nvar gate = global.set ('gate', 0);\nvar table = global.set ('table', 0);\nvar filterlife = global.set ('filterlife', 0);\nvar ballvalve = global.set ('ballvalve', 0);\nvar reset = global.set ('reset', 0);\nvar test_mode = global.set ('test_mode', 0);\nvar dynFill = global.set ('dynFill', 0);\nvar tune = global.set ('tune', 0);\nvar demo_mode = global.set ('demo_mode', 0);\nreturn msg;\n","outputs":"1","noerr":0,"x":1463.5000114440918,"y":338.49998807907104,"wires":[[]]},{"id":"a559507e.5f8b2","type":"function","z":"6071e158.8de25","name":"global get blwr","func":"if (global.get ('blwr') <= 2 && \nglobal.get ('blwr') >0) {\nmsg.payload = 1;\nreturn msg;\n} else\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":260.00000762939453,"y":703.9166402816772,"wires":[["788050aa.fa1fd"]]},{"id":"18d20b21.291dc5","type":"function","z":"6071e158.8de25","name":"global get ballvalve","func":"if (global.get ('ballvalve') == 1 ) {\nmsg.payload = 1;\nreturn msg;\n} else\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":251.7142562866211,"y":1029.4404306411743,"wires":[["6814144a.b88b6c"]]},{"id":"f5c8a04a.fd10d","type":"inject","z":"6071e158.8de25","name":"1 SEC PULSE","topic":"","payload":"ddd","payloadType":"str","repeat":"1","crontab":"","once":true,"x":115.44445419311523,"y":805.583306312561,"wires":[["10c69599.b2063a"]]},{"id":"788050aa.fa1fd","type":"switch","z":"6071e158.8de25","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":419.00000762939453,"y":702.9166402816772,"wires":[["2120bcc9.bd0f54","a6e29a8e.24f868","ea501cb9.a1a8"],["142826f6.d61d89","f052d008.fe8b4"]]},{"id":"64086643.e51838","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1201.0000076293945,"y":722.9166402816772,"wires":[["50681623.deac58"]]},{"id":"d7d7a427.b83298","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BVperm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1151.8573379516602,"y":1114.0714845657349,"wires":[["b07f0895.7f97d8"]]},{"id":"c0e58294.baf14","type":"function","z":"6071e158.8de25","name":"global set brtemp","func":"global.set('brtemp',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":999.0000076293945,"y":656.9166402816772,"wires":[[]]},{"id":"8d1a46bc.42d658","type":"function","z":"6071e158.8de25","name":"Reset runtime variables","func":"var brtemp = global.set ('brtemp', 0);\nvar brperm = global.set ('brperm', 0);\nvar blwrcount = global.set ('blwrcount', 0);\nvar bvtemp = global.set ('bvtemp', 0);\nvar bvperm = global.set ('bvperm', 0);\nvar bvcount = global.set ('bvcount', 0);\nvar Phicount = global.set ('Phicount', 0);\nvar Plocount = global.set ('Plocount', 0);\nvar Dirtcount = global.set ('Dirtcount', 0);\nvar Timedoutcount = global.set ('Timedoutcount', 0);\nreturn msg; \n","outputs":"1","noerr":0,"x":417.2263526916504,"y":1416.8210582733154,"wires":[["7b64c3e.e32a93c","aae7b76d.807168","15119eea.2b9581","fa5ea95e.2ee598","8aa8a403.780fb8","6a8eeef9.91574","a03aab83.028fd8","bd9d5ce5.70dd8"]]},{"id":"34e7fd4e.b2e7a2","type":"switch","z":"6071e158.8de25","name":"reset runtimes on factreset","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"factreseet","vt":"str"}],"checkall":"true","outputs":1,"x":222.19058990478516,"y":1505.392656326294,"wires":[["8d1a46bc.42d658"]]},{"id":"775090a6.aa8e3","type":"function","z":"6071e158.8de25","name":"global set blwrcount","func":"var temp = global.get('blwrcount') - (-1);\nvar blwrcount = global.set('blwrcount', temp);\nmsg.payload = global.get('blwrcount');\nreturn msg;","outputs":1,"noerr":0,"x":964.0000076293945,"y":701.9166402816772,"wires":[["64086643.e51838"]]},{"id":"a5412ec4.0ac6a","type":"function","z":"6071e158.8de25","name":"global set brtemp","func":"var brtemp = global.set('brtemp',0);\nreturn msg;","outputs":1,"noerr":0,"x":866.0000076293945,"y":850.9166402816772,"wires":[["f6dad4c2.a1bfe8"]]},{"id":"517bb63e.60b618","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BRperm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":525.2858963012695,"y":143.77386665344238,"wires":[["7e4b6e31.d4f58"]]},{"id":"a2089fcd.d887b","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BVperm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":521.857307434082,"y":203.63096809387207,"wires":[["145291ae.940c5e"]]},{"id":"36b782ad.5f8efe","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"bvpermhrs","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1018.3216323852539,"y":193.13101387023926,"wires":[["32187be4.324e14"]]},{"id":"2e7fc129.e3d28e","type":"function","z":"6071e158.8de25","name":"global set brperm","func":"var temp = global.get('brperm') -( -global.get('brtemp')); \nvar brperm = global.set('brperm',temp);\nmsg.payload = global.get('brperm');\nreturn msg;","outputs":1,"noerr":0,"x":873.0000076293945,"y":793.9166402816772,"wires":[["f77939fa.153678"]]},{"id":"f77939fa.153678","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BRperm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1159.0000076293945,"y":796.9166402816772,"wires":[["e4252794.c1cc88"]]},{"id":"d792d1d8.4b63c","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":528.571662902832,"y":271.20242500305176,"wires":[["9606e767.09dfb8"]]},{"id":"11ee2c1d.c64cc4","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"blwrcount","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":890.3573684692383,"y":274.8095874786377,"wires":[["32187be4.324e14"]]},{"id":"a53238ec.53fd78","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BVC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":527.5715599060059,"y":311.2023506164551,"wires":[["64250d7.cf11df4"]]},{"id":"79e5e7ac.67a188","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"bvcount","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":887.0359153747559,"y":312.5595283508301,"wires":[["32187be4.324e14"]]},{"id":"b54cdba.c163528","type":"function","z":"6071e158.8de25","name":"global set bvcount","func":"var temp = global.get('bvcount') - (-1);\nvar bvcount = global.set('bvcount', temp);\nmsg.payload = global.get('bvcount');\nreturn msg;","outputs":1,"noerr":0,"x":985.9642715454102,"y":1030.4404401779175,"wires":[["b0d309df.269528"]]},{"id":"b0d309df.269528","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BVC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1217.7142791748047,"y":1048.4404401779175,"wires":[["e37bc0dd.c8055"]]},{"id":"998c7014.b1e9d","type":"inject","z":"6071e158.8de25","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":222.1905860900879,"y":1381.3926525115967,"wires":[["8d1a46bc.42d658"]]},{"id":"7b64c3e.e32a93c","type":"function","z":"6071e158.8de25","name":"global get blwrcount","func":"msg.payload = global.get('blwrcount');\nmsg.topic = 'blwrcount';\nreturn msg;","outputs":1,"noerr":0,"x":712.1905860900879,"y":1376.3926525115967,"wires":[["bdd3fa51.5085e8"]]},{"id":"aae7b76d.807168","type":"function","z":"6071e158.8de25","name":"global get brperm","func":"msg.payload = global.get('brperm');\nmsg.topic = 'brperm';\nreturn msg;","outputs":1,"noerr":0,"x":701.6191711425781,"y":1419.5355443954468,"wires":[["46778af1.49cfd4"]]},{"id":"15119eea.2b9581","type":"function","z":"6071e158.8de25","name":"global get bvcount","func":"msg.payload = global.get('bvcount');\nmsg.topic = 'bvcount';\nreturn msg;","outputs":1,"noerr":0,"x":694.1906127929688,"y":1460.8212394714355,"wires":[["8a5bb801.856878"]]},{"id":"fa5ea95e.2ee598","type":"function","z":"6071e158.8de25","name":"global get bvperm","func":"msg.payload = global.get('bvperm');\nmsg.topic = 'bvperm';\nreturn msg;","outputs":1,"noerr":0,"x":697.1906356811523,"y":1498.53542137146,"wires":[["5ca41db3.29a714"]]},{"id":"bdd3fa51.5085e8","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":994.190601348877,"y":1370.392656326294,"wires":[["d457adad.421d3"]]},{"id":"46778af1.49cfd4","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BRperm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":976.190601348877,"y":1413.392656326294,"wires":[["9ddadf49.13e76"]]},{"id":"8a5bb801.856878","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BVC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":970.1906051635742,"y":1457.5355262756348,"wires":[["6ba03b3e.a2f734"]]},{"id":"5ca41db3.29a714","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BVperm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":964.9051055908203,"y":1499.202377319336,"wires":[["c7d2cc2b.b72de"]]},{"id":"218de366.db464c","type":"inject","z":"6071e158.8de25","name":"BLOWER 1","topic":"blwr","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":108.00000762939453,"y":576.9166402816772,"wires":[["34a868e.0f23098"]]},{"id":"34a868e.0f23098","type":"function","z":"6071e158.8de25","name":"global set blwr","func":"global.set('blwr',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":443.76195526123047,"y":592.1190299987793,"wires":[[]]},{"id":"982c1ad.42b3be8","type":"inject","z":"6071e158.8de25","name":"BLOWER 0","topic":"blwr","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":108.83333587646484,"y":541.2499380111694,"wires":[["34a868e.0f23098"]]},{"id":"56880fa6.73752","type":"inject","z":"6071e158.8de25","name":"BLOWER 2","topic":"blwr","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":107.00000762939453,"y":613.9166402816772,"wires":[["34a868e.0f23098"]]},{"id":"970382d4.7eddc","type":"inject","z":"6071e158.8de25","name":"BLOWER 3","topic":"blwr","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"x":107.00000762939453,"y":649.9166402816772,"wires":[["34a868e.0f23098"]]},{"id":"2120bcc9.bd0f54","type":"trigger","z":"6071e158.8de25","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":725.5000076293945,"y":687.9166402816772,"wires":[["775090a6.aa8e3"]]},{"id":"142826f6.d61d89","type":"trigger","z":"6071e158.8de25","op1":"0","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":620.0000076293945,"y":764.9166402816772,"wires":[["2e7fc129.e3d28e","a5412ec4.0ac6a"]]},{"id":"a6e29a8e.24f868","type":"counter","z":"6071e158.8de25","inc":1,"name":"","x":622.5000076293945,"y":646.9166402816772,"wires":[["c0e58294.baf14"]]},{"id":"f6dad4c2.a1bfe8","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":807.5000076293945,"y":586.9166402816772,"wires":[["a6e29a8e.24f868"]]},{"id":"ea501cb9.a1a8","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":536.0000076293945,"y":817.9166402816772,"wires":[["142826f6.d61d89"]]},{"id":"f052d008.fe8b4","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":699.0000076293945,"y":725.9166402816772,"wires":[["2120bcc9.bd0f54"]]},{"id":"48b2117e.2e2fa","type":"counter","z":"6071e158.8de25","inc":1,"name":"","x":638.7142639160156,"y":972.6904401779175,"wires":[["700e21f7.b6c3"]]},{"id":"3ceec20d.c15c7e","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":823.7142639160156,"y":912.6904401779175,"wires":[["48b2117e.2e2fa"]]},{"id":"e7d0ea1a.d01228","type":"trigger","z":"6071e158.8de25","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":741.7142639160156,"y":1013.6904401779175,"wires":[["b54cdba.c163528"]]},{"id":"1529ec5c.990764","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":715.2142639160156,"y":1051.6904401779175,"wires":[["e7d0ea1a.d01228"]]},{"id":"b43df62e.3917f8","type":"trigger","z":"6071e158.8de25","op1":"0","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":636.2142639160156,"y":1090.6904401779175,"wires":[["358c31de.90e2ee","d9b84be4.c2efd8"]]},{"id":"f2e8e1b2.c29ec","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":552.2142639160156,"y":1143.6904401779175,"wires":[["b43df62e.3917f8"]]},{"id":"6814144a.b88b6c","type":"switch","z":"6071e158.8de25","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":435.2142639160156,"y":1028.6904401779175,"wires":[["e7d0ea1a.d01228","48b2117e.2e2fa","f2e8e1b2.c29ec"],["b43df62e.3917f8","1529ec5c.990764"]]},{"id":"700e21f7.b6c3","type":"function","z":"6071e158.8de25","name":"global set bvtemp","func":"global.set('bvtemp',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1015.2142639160156,"y":982.6904401779175,"wires":[[]]},{"id":"358c31de.90e2ee","type":"function","z":"6071e158.8de25","name":"global set bvperm","func":"var temp = global.get('bvperm') -( -global.get('bvtemp')); \nvar bvperm = global.set('bvperm',temp);\nmsg.payload = global.get('bvperm');\nreturn msg;","outputs":1,"noerr":0,"x":889.2142639160156,"y":1119.6904401779175,"wires":[["d7d7a427.b83298"]]},{"id":"d9b84be4.c2efd8","type":"function","z":"6071e158.8de25","name":"global set bvtemp","func":"var bvtemp = global.set('bvtemp',0);\nreturn msg;","outputs":1,"noerr":0,"x":882.2142639160156,"y":1176.6904401779175,"wires":[["3ceec20d.c15c7e"]]},{"id":"a9462057.85f0d","type":"inject","z":"6071e158.8de25","name":"Ball valve 1","topic":"ballvalve","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":127.35714721679688,"y":1189.0475015640259,"wires":[["ba154f5a.d3613"]]},{"id":"ba154f5a.d3613","type":"function","z":"6071e158.8de25","name":"global set ballvalve","func":"global.set('ballvalve',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":338.4761962890625,"y":1168.892834663391,"wires":[[]]},{"id":"db79b15c.7713b","type":"inject","z":"6071e158.8de25","name":"Ball valve 0","topic":"ballvalve","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":116.0475845336914,"y":1119.2737550735474,"wires":[["ba154f5a.d3613"]]},{"id":"d457adad.421d3","type":"DataIn","z":"6071e158.8de25","collection":"7283d585.e71dec","name":"","update":false,"path":"/BC","x":1180.6905517578125,"y":1367.5356149673462,"wires":[]},{"id":"9ddadf49.13e76","type":"DataIn","z":"6071e158.8de25","collection":"ead59310.5540f","name":"","update":false,"path":"/BRperm","x":1181.690502166748,"y":1409.821310043335,"wires":[]},{"id":"6ba03b3e.a2f734","type":"DataIn","z":"6071e158.8de25","collection":"15bbd325.70754d","name":"","update":false,"path":"/BVC","x":1165.9761962890625,"y":1460.964183807373,"wires":[]},{"id":"c7d2cc2b.b72de","type":"DataIn","z":"6071e158.8de25","collection":"6ad73776.cbc2a8","name":"","update":false,"path":"/BVperm","x":1166.9762153625488,"y":1505.2499504089355,"wires":[]},{"id":"50681623.deac58","type":"DataIn","z":"6071e158.8de25","collection":"7283d585.e71dec","name":"","update":false,"path":"/BC","x":1378.428596496582,"y":725.7738103866577,"wires":[]},{"id":"e4252794.c1cc88","type":"DataIn","z":"6071e158.8de25","collection":"ead59310.5540f","name":"","update":false,"path":"/BRperm","x":1343.7142868041992,"y":795.2023596763611,"wires":[]},{"id":"e37bc0dd.c8055","type":"DataIn","z":"6071e158.8de25","collection":"15bbd325.70754d","name":"","update":false,"path":"/BVC","x":1397.2858657836914,"y":1047.2975883483887,"wires":[]},{"id":"b07f0895.7f97d8","type":"DataIn","z":"6071e158.8de25","collection":"6ad73776.cbc2a8","name":"","update":false,"path":"/BVperm","x":1349.7143154144287,"y":1117.2976789474487,"wires":[]},{"id":"9606e767.09dfb8","type":"DataOut","z":"6071e158.8de25","collection":"7283d585.e71dec","name":"","path":"/BC","error":false,"x":711.7145462036133,"y":268.91673469543457,"wires":[["11ee2c1d.c64cc4"]]},{"id":"7e4b6e31.d4f58","type":"DataOut","z":"6071e158.8de25","collection":"ead59310.5540f","name":"","path":"/BRperm","error":false,"x":713.8572769165039,"y":141.34529304504395,"wires":[["b9bf575.e3bb4a8","5df69567.13fd6c"]]},{"id":"145291ae.940c5e","type":"DataOut","z":"6071e158.8de25","collection":"6ad73776.cbc2a8","name":"","path":"/BVperm","error":false,"x":713.8572769165039,"y":203.05960273742676,"wires":[["be68a2b9.24281","74e7472b.e22408"]]},{"id":"64250d7.cf11df4","type":"DataOut","z":"6071e158.8de25","collection":"15bbd325.70754d","name":"","path":"/BVC","error":false,"x":709.8573265075684,"y":310.2024269104004,"wires":[["79e5e7ac.67a188"]]},{"id":"b4e9fd0.e8d61","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BRperm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":551.1428489685059,"y":1922.8690626621246,"wires":[["a51d05c9.798e58"]]},{"id":"f55b25e8.a5b018","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BVperm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":552.7142448425293,"y":2012.726160287857,"wires":[["15f5f6ad.21bf69"]]},{"id":"3dad875e.8647c8","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":551.4285926818848,"y":1878.29762673378,"wires":[["decf3811.27f0a8"]]},{"id":"187a8c58.abd5c4","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/BVC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":551.4284934997559,"y":1965.2975590229034,"wires":[["6f265009.b328d"]]},{"id":"decf3811.27f0a8","type":"DataOut","z":"6071e158.8de25","collection":"7283d585.e71dec","name":"","path":"/BC","error":false,"x":733.5715065002441,"y":1877.0119202136993,"wires":[["f13dbb10.b3e638"]]},{"id":"a51d05c9.798e58","type":"DataOut","z":"6071e158.8de25","collection":"ead59310.5540f","name":"","path":"/BRperm","error":false,"x":740.7142753601074,"y":1918.4404861927032,"wires":[["2760c1a6.07251e"]]},{"id":"15f5f6ad.21bf69","type":"DataOut","z":"6071e158.8de25","collection":"6ad73776.cbc2a8","name":"","path":"/BVperm","error":false,"x":740.7141876220703,"y":2004.154801607132,"wires":[["6f455c69.9f65f4"]]},{"id":"6f265009.b328d","type":"DataOut","z":"6071e158.8de25","collection":"15bbd325.70754d","name":"","path":"/BVC","error":false,"x":730.7142715454102,"y":1961.2976297736168,"wires":[["e4e0f4c8.4eb2f8"]]},{"id":"d732a0fe.298e8","type":"inject","z":"6071e158.8de25","name":"","topic":"","payload":"startup","payloadType":"str","repeat":"","crontab":"","once":true,"x":205.64284896850586,"y":1867.8690626621246,"wires":[["3dad875e.8647c8","b4e9fd0.e8d61","187a8c58.abd5c4","f55b25e8.a5b018","a3c01c94.73c61","fce64ded.c21d2","8d71227e.abac4","58106126.4c33b"]]},{"id":"f13dbb10.b3e638","type":"function","z":"6071e158.8de25","name":"global set blwrcount","func":"var blwrcount = global.set('blwrcount', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":943.1428489685059,"y":1874.8690626621246,"wires":[[]]},{"id":"2760c1a6.07251e","type":"function","z":"6071e158.8de25","name":"global set brperm","func":"var brperm = global.set('brperm',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":930.1428489685059,"y":1910.8690626621246,"wires":[[]]},{"id":"6f455c69.9f65f4","type":"function","z":"6071e158.8de25","name":"global set bvperm","func":"var bvperm = global.set('bvperm',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":934.1428489685059,"y":2004.8690626621246,"wires":[[]]},{"id":"e4e0f4c8.4eb2f8","type":"function","z":"6071e158.8de25","name":"global set bvcount","func":"var bvcount = global.set('bvcount', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":934.1428489685059,"y":1958.8690626621246,"wires":[[]]},{"id":"af91ed8e.a2071","type":"inject","z":"6071e158.8de25","name":"1 SEC PULSE","topic":"","payload":"ddd","payloadType":"str","repeat":"1","crontab":"","once":true,"x":176.33341217041016,"y":241.58345985412598,"wires":[["d792d1d8.4b63c","517bb63e.60b618","a53238ec.53fd78","a2089fcd.d887b","6bf1476.0d143b8","8f5f701a.c43f7","80229651.5400e8","71f90ec0.fb579"]]},{"id":"1fc136b8.4e5199","type":"comment","z":"6071e158.8de25","name":"Send runtimes and counts to vis","info":"","x":773.1666641235352,"y":51.25000190734863,"wires":[]},{"id":"429b2d68.a5f774","type":"comment","z":"6071e158.8de25","name":"Blower runtime and start counts","info":"","x":759.8333435058594,"y":536.5833282470703,"wires":[]},{"id":"c4df05c7.d753d8","type":"comment","z":"6071e158.8de25","name":"Ball Valve runtime and start counts","info":"","x":558.3333435058594,"y":898.5833282470703,"wires":[]},{"id":"ebf75e8.d3f18a","type":"comment","z":"6071e158.8de25","name":"Factory reset runtimes and counts to 0","info":"","x":600.8333435058594,"y":1227.5833282470703,"wires":[]},{"id":"527f55ea.f4d85c","type":"comment","z":"6071e158.8de25","name":"Read runtimes and counts from DB on startup","info":"","x":573.9761848449707,"y":1816.8690474033356,"wires":[]},{"id":"951606f.975d1f8","type":"comment","z":"6071e158.8de25","name":"Alarm counts","info":"","x":537.1904678344727,"y":2269.5834007263184,"wires":[]},{"id":"e36d935.1a0097","type":"inject","z":"6071e158.8de25","name":"1 SEC PULSE","topic":"","payload":"ddd","payloadType":"str","repeat":"1","crontab":"","once":true,"x":172.33333587646484,"y":2478.0119552612305,"wires":[["c0406e53.2649d","8d37b22a.c8fa6","383f61c8.54668e","945d5ffa.fc3ec"]]},{"id":"c0406e53.2649d","type":"function","z":"6071e158.8de25","name":"get Phi alarm","func":"if (global.get ('alarm') === 1)\n{\nmsg.payload = 1;\nreturn msg;\n} \nelse\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":417.74600982666016,"y":2331.916774749756,"wires":[["db56b5ad.2001f8"]]},{"id":"db56b5ad.2001f8","type":"switch","z":"6071e158.8de25","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":576.7460098266602,"y":2327.916774749756,"wires":[["88ad0ed2.766bb"],["80937a5d.5e6058"]]},{"id":"88ad0ed2.766bb","type":"trigger","z":"6071e158.8de25","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":771.2460098266602,"y":2319.916774749756,"wires":[["992f9ec2.4196b"]]},{"id":"80937a5d.5e6058","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":762.7460098266602,"y":2368.916774749756,"wires":[["88ad0ed2.766bb"]]},{"id":"992f9ec2.4196b","type":"function","z":"6071e158.8de25","name":"global set Phicount","func":"var temp = global.get('Phicount') - (-1);\nvar Phicount = global.set('Phicount', temp);\nmsg.payload = global.get('Phicount');\nreturn msg;","outputs":1,"noerr":0,"x":986.7460098266602,"y":2327.916774749756,"wires":[["55c3e17f.5ff45"]]},{"id":"55c3e17f.5ff45","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/PHC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1211.7460098266602,"y":2360.916774749756,"wires":[["d19fe063.2034f"]]},{"id":"d19fe063.2034f","type":"DataIn","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","update":false,"path":"/PHC","x":1381.1745986938477,"y":2360.773952484131,"wires":[]},{"id":"8d37b22a.c8fa6","type":"function","z":"6071e158.8de25","name":"get Plo alarm","func":"if (global.get ('alarm') === 2)\n{\nmsg.payload = 1;\nreturn msg;\n} \nelse\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":409.6191291809082,"y":2440.2977533340454,"wires":[["547cd59.99e342c"]]},{"id":"547cd59.99e342c","type":"switch","z":"6071e158.8de25","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":588.6191215515137,"y":2436.297716140747,"wires":[["6654722d.0719bc"],["6c0a25ea.db8acc"]]},{"id":"6654722d.0719bc","type":"trigger","z":"6071e158.8de25","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":783.1191215515137,"y":2428.297716140747,"wires":[["81172eec.f6fd8"]]},{"id":"6c0a25ea.db8acc","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":774.6191215515137,"y":2477.297716140747,"wires":[["6654722d.0719bc"]]},{"id":"81172eec.f6fd8","type":"function","z":"6071e158.8de25","name":"global set Plocount","func":"var temp = global.get('Plocount') - (-1);\nvar Plocount = global.set('Plocount', temp);\nmsg.payload = global.get('Plocount');\nreturn msg;","outputs":1,"noerr":0,"x":998.6191215515137,"y":2436.297716140747,"wires":[["bac854bf.81cda8"]]},{"id":"bac854bf.81cda8","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/PLC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1223.6191215515137,"y":2469.297716140747,"wires":[["156b2f77.274bd1"]]},{"id":"156b2f77.274bd1","type":"DataIn","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","update":false,"path":"/PLC","x":1393.0477104187012,"y":2469.154893875122,"wires":[]},{"id":"383f61c8.54668e","type":"function","z":"6071e158.8de25","name":"get permDirt alarm","func":"if (global.get ('alarm') === 3)\n{\nmsg.payload = 1;\nreturn msg;\n} \nelse\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":411.04762268066406,"y":2547.440502166748,"wires":[["ab4de89a.ff5308"]]},{"id":"ab4de89a.ff5308","type":"switch","z":"6071e158.8de25","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":581.4762344360352,"y":2544.8691082000732,"wires":[["9402c5c8.5c79d8"],["8391743e.99f098"]]},{"id":"9402c5c8.5c79d8","type":"trigger","z":"6071e158.8de25","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":780.261962890625,"y":2539.7262859344482,"wires":[["bf937c1.afe388"]]},{"id":"8391743e.99f098","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":771.761962890625,"y":2588.7262859344482,"wires":[["9402c5c8.5c79d8"]]},{"id":"bf937c1.afe388","type":"function","z":"6071e158.8de25","name":"global set Dirtcount","func":"var temp = global.get('Dirtcount') - (-1);\nvar Dirtcount = global.set('Dirtcount', temp);\nmsg.payload = global.get('Dirtcount');\nreturn msg;","outputs":1,"noerr":0,"x":995.761962890625,"y":2547.7262859344482,"wires":[["de1dec74.0dd9"]]},{"id":"de1dec74.0dd9","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/DC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1220.761962890625,"y":2580.7262859344482,"wires":[["7a00292e.398e08"]]},{"id":"7a00292e.398e08","type":"DataIn","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","update":false,"path":"/DC","x":1390.1905517578125,"y":2580.5834636688232,"wires":[]},{"id":"945d5ffa.fc3ec","type":"function","z":"6071e158.8de25","name":"get timedout alarm","func":"if (global.get ('alarm') === 4)\n{\nmsg.payload = 1;\nreturn msg;\n} \nelse\nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":402.4762191772461,"y":2647.4406747817993,"wires":[["27dce224.8320ee"]]},{"id":"27dce224.8320ee","type":"switch","z":"6071e158.8de25","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":578.6190795898438,"y":2649.1549615859985,"wires":[["4315105a.c37cb"],["8df3d05a.defad"]]},{"id":"4315105a.c37cb","type":"trigger","z":"6071e158.8de25","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"reset","name":"","x":773.1190795898438,"y":2641.1549615859985,"wires":[["44ba71fa.b7d46"]]},{"id":"8df3d05a.defad","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":764.6190795898438,"y":2690.1549615859985,"wires":[["4315105a.c37cb"]]},{"id":"44ba71fa.b7d46","type":"function","z":"6071e158.8de25","name":"global set Timedoutcount","func":"var temp = global.get('Timedoutcount') - (-1);\nvar Timedoutcount = global.set('Timedoutcount', temp);\nmsg.payload = global.get('Timedoutcount');\nreturn msg;","outputs":1,"noerr":0,"x":998.6191101074219,"y":2644.8691759109497,"wires":[["3cb71ed1.ac29c2"]]},{"id":"3cb71ed1.ac29c2","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/TOC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1227.904884338379,"y":2689.2978162765503,"wires":[["326dc190.804e9e"]]},{"id":"326dc190.804e9e","type":"DataIn","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","update":false,"path":"/TOC","x":1393.047565460205,"y":2687.7265272140503,"wires":[]},{"id":"fce64ded.c21d2","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/PLC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":552.4761848449707,"y":2113.154814004898,"wires":[["d57e9cd8.01691"]]},{"id":"58106126.4c33b","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/TOC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":554.0475807189941,"y":2203.0119116306305,"wires":[["e509e5a.5b19f18"]]},{"id":"a3c01c94.73c61","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/PHC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":552.7619285583496,"y":2068.5833780765533,"wires":[["ef6bfdef.8d7cb"]]},{"id":"8d71227e.abac4","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/DC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":552.7618293762207,"y":2155.583310365677,"wires":[["ebc02a6a.445bd8"]]},{"id":"ef6bfdef.8d7cb","type":"DataOut","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","path":"/PHC","error":false,"x":734.904842376709,"y":2067.297671556473,"wires":[["f28651b6.29a75"]]},{"id":"d57e9cd8.01691","type":"DataOut","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","path":"/PLC","error":false,"x":732.0476112365723,"y":2108.7262375354767,"wires":[["2eb5716d.62167e"]]},{"id":"e509e5a.5b19f18","type":"DataOut","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","path":"/TOC","error":false,"x":732.0475234985352,"y":2194.4405529499054,"wires":[["5b517d.4bd09e84"]]},{"id":"ebc02a6a.445bd8","type":"DataOut","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","path":"/DC","error":false,"x":732.047607421875,"y":2151.5833811163902,"wires":[["8c5fca8d.483608"]]},{"id":"f28651b6.29a75","type":"function","z":"6071e158.8de25","name":"global set Phicount","func":"var Phicount = global.set('Phicount', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":934.4761848449707,"y":2065.154814004898,"wires":[[]]},{"id":"2eb5716d.62167e","type":"function","z":"6071e158.8de25","name":"global set Plocount","func":"var Plocount = global.set('Plocount',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":931.4761848449707,"y":2101.154814004898,"wires":[[]]},{"id":"5b517d.4bd09e84","type":"function","z":"6071e158.8de25","name":"global set Timedoutcount","func":"var Timedoutcount = global.set('Timedoutcount',msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":934.0476112365723,"y":2195.1547663211823,"wires":[[]]},{"id":"8c5fca8d.483608","type":"function","z":"6071e158.8de25","name":"global set Dirtcount","func":"var Dirtcount = global.set('Dirtcount', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":935.4761848449707,"y":2149.154814004898,"wires":[[]]},{"id":"d2cc994e.af7cf8","type":"inject","z":"6071e158.8de25","name":"Alarm 1","topic":"alarm","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":129.6190643310547,"y":2691.726291656494,"wires":[["3d4e64d9.cba27c"]]},{"id":"3d4e64d9.cba27c","type":"function","z":"6071e158.8de25","name":"global set alarm","func":"global.set('alarm',msg.payload);\nreturn;","outputs":1,"noerr":0,"x":395.38098907470703,"y":2709.7858180999756,"wires":[[]]},{"id":"6c8d1d7.72916e4","type":"inject","z":"6071e158.8de25","name":"Alarm 0","topic":"alarm","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"x":130.452392578125,"y":2656.0595893859863,"wires":[["3d4e64d9.cba27c"]]},{"id":"75f05a9f.9db4a4","type":"inject","z":"6071e158.8de25","name":"Alarm 2","topic":"alarm","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":128.6190643310547,"y":2728.726291656494,"wires":[["3d4e64d9.cba27c"]]},{"id":"4b771447.c23dfc","type":"inject","z":"6071e158.8de25","name":"Alarm 3","topic":"alarm","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"x":128.6190643310547,"y":2764.726291656494,"wires":[["3d4e64d9.cba27c"]]},{"id":"8fc0cf52.c3a04","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/PHC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":958.1905555725098,"y":1543.1547164916992,"wires":[["ba6066cb.26a188"]]},{"id":"ba6066cb.26a188","type":"DataIn","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","update":false,"path":"/PHC","x":1140.4763374328613,"y":1547.2975568771362,"wires":[]},{"id":"e788277c.ca39e8","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/PLC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":962.9208526611328,"y":1591.5356454849243,"wires":[["ba674d5c.908db"]]},{"id":"ba674d5c.908db","type":"DataIn","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","update":false,"path":"/PLC","x":1135.2065963745117,"y":1595.6785373687744,"wires":[]},{"id":"7b5c97a8.27bc58","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/DC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":968.635009765625,"y":1642.9642848968506,"wires":[["a6e2ec2c.38b5e"]]},{"id":"a6e2ec2c.38b5e","type":"DataIn","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","update":false,"path":"/DC","x":1138.0635986328125,"y":1642.8214626312256,"wires":[]},{"id":"f276e0d.c896b2","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/TOC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":967.2065734863281,"y":1685.8214073181152,"wires":[["9760405b.68461"]]},{"id":"9760405b.68461","type":"DataIn","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","update":false,"path":"/TOC","x":1132.3492546081543,"y":1684.2501182556152,"wires":[]},{"id":"8aa8a403.780fb8","type":"function","z":"6071e158.8de25","name":"global get Phicount","func":"msg.payload = global.get('Phicount');\nmsg.topic = 'Phicount';\nreturn msg;","outputs":1,"noerr":0,"x":682.4762268066406,"y":1548.8690948486328,"wires":[["8fc0cf52.c3a04"]]},{"id":"6a8eeef9.91574","type":"function","z":"6071e158.8de25","name":"global get Plocount","func":"msg.payload = global.get('Plocount');\nmsg.topic = 'Plocount';\nreturn msg;","outputs":1,"noerr":0,"x":681.9048118591309,"y":1592.011986732483,"wires":[["e788277c.ca39e8"]]},{"id":"a03aab83.028fd8","type":"function","z":"6071e158.8de25","name":"global get Dirtcount","func":"msg.payload = global.get('Dirtcount');\nmsg.topic = 'Dirtcount';\nreturn msg;","outputs":1,"noerr":0,"x":674.4762535095215,"y":1633.2976818084717,"wires":[["7b5c97a8.27bc58"]]},{"id":"bd9d5ce5.70dd8","type":"function","z":"6071e158.8de25","name":"global get Timedoutcount","func":"msg.payload = global.get('Timedoutcount');\nmsg.topic = 'Timedoutcount';\nreturn msg;","outputs":1,"noerr":0,"x":697.4762763977051,"y":1671.011863708496,"wires":[["f276e0d.c896b2"]]},{"id":"8f5f701a.c43f7","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/PLC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":525.0000152587891,"y":396.9166421890259,"wires":[["53431191.d1bbd"]]},{"id":"71f90ec0.fb579","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/TOC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":526.5714111328125,"y":486.7737398147583,"wires":[["2eb7c37c.73a89c"]]},{"id":"6bf1476.0d143b8","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/PHC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":525.285758972168,"y":352.34520626068115,"wires":[["e913a11c.1e51c"]]},{"id":"80229651.5400e8","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"datapath","pt":"msg","to":"/DC","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":525.2856597900391,"y":439.3451385498047,"wires":[["71401f29.551e2"]]},{"id":"e913a11c.1e51c","type":"DataOut","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","path":"/PHC","error":false,"x":707.4286727905273,"y":351.0594997406006,"wires":[["57e8d1ae.7ab0b"]]},{"id":"53431191.d1bbd","type":"DataOut","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","path":"/PLC","error":false,"x":704.5714416503906,"y":392.4880657196045,"wires":[["bdd6650c.1cfa28"]]},{"id":"2eb7c37c.73a89c","type":"DataOut","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","path":"/TOC","error":false,"x":704.5713768005371,"y":486.2023811340332,"wires":[["457a5c14.49d984"]]},{"id":"71401f29.551e2","type":"DataOut","z":"6071e158.8de25","collection":"845fc459.19ca08","name":"","path":"/DC","error":false,"x":704.5714378356934,"y":435.34520930051804,"wires":[["98310f58.cd6c2"]]},{"id":"bdd6650c.1cfa28","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"Plocount","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":888.3333282470703,"y":391.9166421890259,"wires":[["32187be4.324e14"]]},{"id":"457a5c14.49d984","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"Timedoutcount","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":887.5833206176758,"y":482.523775100708,"wires":[["32187be4.324e14"]]},{"id":"57e8d1ae.7ab0b","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"Phicount","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":887.6190185546875,"y":351.20233726501465,"wires":[["32187be4.324e14"]]},{"id":"98310f58.cd6c2","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"Dirtcount","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":888.2975387573242,"y":435.95229482650757,"wires":[["32187be4.324e14"]]},{"id":"b85356f0.022f78","type":"inject","z":"6071e158.8de25","name":"Alarm 4","topic":"alarm","payload":"4","payloadType":"num","repeat":"","crontab":"","once":false,"x":126.99999237060547,"y":2812.9165058135986,"wires":[["3d4e64d9.cba27c"]]},{"id":"32187be4.324e14","type":"vis in","z":"6071e158.8de25","language":"en","x":1229.944465637207,"y":330.25000190734863,"wires":[[]]},{"id":"be68a2b9.24281","type":"range","z":"6071e158.8de25","minin":"0","maxin":"3600","minout":"0","maxout":"1","action":"scale","round":true,"name":"","x":859.4999771118164,"y":193.25000190734863,"wires":[["36b782ad.5f8efe"]]},{"id":"5df69567.13fd6c","type":"range","z":"6071e158.8de25","minin":"0","maxin":"3600","minout":"0","maxout":"1","action":"scale","round":true,"name":"","x":858.0000381469727,"y":151.25000190734863,"wires":[["8ed571a3.fc054"]]},{"id":"8ed571a3.fc054","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"brpermhrs","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1018.5717544555664,"y":148.52388191223145,"wires":[["32187be4.324e14"]]},{"id":"74e7472b.e22408","type":"range","z":"6071e158.8de25","minin":"0","maxin":"60","minout":"0","maxout":"1","action":"scale","round":true,"name":"","x":858.0000381469727,"y":233.25000190734863,"wires":[["db55d026.e9c55"]]},{"id":"db55d026.e9c55","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"bvpermmins","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1017.8216323852539,"y":234.13101387023926,"wires":[["32187be4.324e14"]]},{"id":"abef2c69.04097","type":"vis in","z":"6071e158.8de25","language":"en","x":103.4999771118164,"y":1429.2499561309814,"wires":[["34e7fd4e.b2e7a2"]]},{"id":"b9bf575.e3bb4a8","type":"range","z":"6071e158.8de25","minin":"0","maxin":"60","minout":"0","maxout":"1","action":"scale","round":true,"name":"","x":859.9999771118164,"y":109.97607612609863,"wires":[["8f4cefd3.8fa8c"]]},{"id":"8f4cefd3.8fa8c","type":"change","z":"6071e158.8de25","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"brpermmins","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1018.9999771118164,"y":106.24995613098145,"wires":[["32187be4.324e14"]]},{"id":"8f290c17.54134","type":"inject","z":"6071e158.8de25","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":820.4999771118164,"y":630.2499561309814,"wires":[["c0e58294.baf14"]]},{"id":"7502cf4f.42c69","type":"inject","z":"6071e158.8de25","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":true,"x":883.4999771118164,"y":950.2499561309814,"wires":[["700e21f7.b6c3"]]},{"id":"10c69599.b2063a","type":"delay","z":"6071e158.8de25","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":220.4999771118164,"y":876.2499561309814,"wires":[["a559507e.5f8b2","18d20b21.291dc5"]]},{"id":"48cbdaea.1b02a4","type":"vis in","z":"12124d8b.4d0582","language":"en","x":176,"y":117,"wires":[["29494d94.d40442"]]},{"id":"29494d94.d40442","type":"switch","z":"12124d8b.4d0582","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"remote_connection","vt":"str"}],"checkall":"true","outputs":1,"x":337,"y":116,"wires":[["9df80f41.6bec","21e74a80.1824b6"]]},{"id":"21e74a80.1824b6","type":"exec","z":"12124d8b.4d0582","command":"sudo vncserver","addpay":false,"append":"","useSpawn":"","timer":"","name":"","x":529,"y":119.5,"wires":[[],[],[]]},{"id":"9df80f41.6bec","type":"debug","z":"12124d8b.4d0582","name":"","active":true,"console":"false","complete":"false","x":525,"y":216,"wires":[]},{"id":"89ac7e2a.328a2","type":"trigger","z":"2c485e.00c557a2","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"500","extend":false,"units":"ms","reset":"","name":"","x":94,"y":323,"wires":[["5621a756.197a48"]]},{"id":"a0913a65.8cf968","type":"exec","z":"ef48c238.0f7e8","command":"sudo i2cset -y 1 0x6b 0x08 0x00","addpay":true,"append":"","useSpawn":"","timer":"","name":"","x":433,"y":130.5,"wires":[[],[],[]]},{"id":"fc84ce1f.2c3b9","type":"inject","z":"ef48c238.0f7e8","name":"","topic":"","payload":"1","payloadType":"str","repeat":"","crontab":"","once":true,"x":100,"y":91,"wires":[["a0913a65.8cf968"]]},{"id":"1371b728.bbef19","type":"comment","z":"ef48c238.0f7e8","name":"Scale A/D 0-5.2 Volts DC","info":"","x":163,"y":36,"wires":[]},{"id":"42aa3990.d9b408","type":"inject","z":"8e16fc15.cc08a","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"x":405,"y":217,"wires":[["ca412788.466ae8"]]},{"id":"61391860.d3c098","type":"debug","z":"2c485e.00c557a2","name":"","active":false,"console":"false","complete":"false","x":634.4444444444445,"y":182.22222222222223,"wires":[]},{"id":"495b891e.731a78","type":"debug","z":"2c485e.00c557a2","name":"Filter","active":false,"console":"false","complete":"payload","x":578.8888549804688,"y":483.33331298828125,"wires":[]},{"id":"acce9aa5.0a89a8","type":"debug","z":"2c485e.00c557a2","name":"","active":true,"console":"false","complete":"false","x":685.5555419921875,"y":441.111083984375,"wires":[]},{"id":"93d63a53.0dc328","type":"debug","z":"2c485e.00c557a2","name":"","active":false,"console":"false","complete":"false","x":627.7777709960938,"y":146.66665649414062,"wires":[]},{"id":"a5ab98d8.80f0b8","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":598.9523914882116,"y":1274.333311012813,"wires":[["a4ca79b5.9b7558","f5c33323.2e1ec"]]},{"id":"6b746fc.648659","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":592.9523914882116,"y":1334.333311012813,"wires":[["b0ecc98c.27df38","51242b38.1a6d14","604d5e12.2e0ff"]]},{"id":"f5c33323.2e1ec","type":"bigexec","z":"effccbe2.760e38","name":"Flush wlan0","command":"sudo ","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":817.9523914882116,"y":1275.833311012813,"wires":[[],[],[]]},{"id":"51242b38.1a6d14","type":"bigexec","z":"effccbe2.760e38","name":"Set wlan0 Static IP and Broadcast IP","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":897.9523914882116,"y":1340.333311012813,"wires":[[],[],[]]},{"id":"dc7b34a4.ea16a8","type":"inject","z":"effccbe2.760e38","name":"Set wlan0 Static Routes","topic":"","payload":"ip route add 192.168.0.1 dev wlan0","payloadType":"str","repeat":"","crontab":"","once":false,"x":755.2024154663086,"y":1699.083384513855,"wires":[["ec6204c2.c68d48"]]},{"id":"ec6204c2.c68d48","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":935.2024154663086,"y":1699.083384513855,"wires":[["2721e418.c8d4dc"]]},{"id":"2721e418.c8d4dc","type":"bigexec","z":"effccbe2.760e38","name":"Set wlan0 Static Routes","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":1202.2024154663086,"y":1698.083384513855,"wires":[[],[],[]]},{"id":"49724c5e.6c38c4","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":588.9523914882116,"y":1393.333311012813,"wires":[["16f9244.0ac41dc"]]},{"id":"16f9244.0ac41dc","type":"bigexec","z":"effccbe2.760e38","name":"Set wlan0 Netmask","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":841.9523914882116,"y":1403.333311012813,"wires":[[],[],[]]},{"id":"f769df83.3d627","type":"inject","z":"effccbe2.760e38","name":"Remove Gateway","topic":"","payload":" route del default gw 192.168.0.1 dev wlan0","payloadType":"str","repeat":"","crontab":"","once":false,"x":747.2024078369141,"y":1742.8333902359009,"wires":[["577a2b0c.e04194"]]},{"id":"3a2f4c69.a642a4","type":"switch","z":"effccbe2.760e38","name":"wlan0","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"wip1","vt":"str"},{"t":"eq","v":"wip2","vt":"str"},{"t":"eq","v":"wip3","vt":"str"},{"t":"eq","v":"wip4","vt":"str"},{"t":"eq","v":"wnet1","vt":"str"},{"t":"eq","v":"wnet2","vt":"str"},{"t":"eq","v":"wnet3","vt":"str"},{"t":"eq","v":"wnet4","vt":"str"},{"t":"eq","v":"wbr1","vt":"str"},{"t":"eq","v":"wbr2","vt":"str"},{"t":"eq","v":"wbr3","vt":"str"},{"t":"eq","v":"wbr4","vt":"str"},{"t":"eq","v":"wrt1","vt":"str"},{"t":"eq","v":"wrt2","vt":"str"},{"t":"eq","v":"wrt3","vt":"str"},{"t":"eq","v":"wrt4","vt":"str"},{"t":"eq","v":"wgt1","vt":"str"},{"t":"eq","v":"wgt2","vt":"str"},{"t":"eq","v":"wgt3","vt":"str"},{"t":"eq","v":"wgt4","vt":"str"}],"checkall":"true","outputs":20,"x":232.6190242767334,"y":386.33331871032715,"wires":[["360b35f8.fc63aa","cfc9e835.5211d8"],["4112c15c.6e4eb"],["cc5c971f.154c48"],["b61ac85a.bbbc28"],["8eea4376.a62d2"],["fd3baa3d.69bd58"],["9235ebc5.2ee2a8"],["19f604be.9c1b9b"],["432aa73f.08bdf8"],["480d36c0.a907e8"],["a2987bbb.809da8"],["cebf1e9b.efa87"],["a2d0bcc2.c9235"],["35f66eaf.7eb7e2"],["346792ca.f8d9ae"],["9e7642c5.f847"],["ae1c9b6a.5a2f78"],["1877d1eb.fbb56e"],["d28e254b.6f2528"],["b37f194e.78e858"]]},{"id":"ebc63b11.bee9d8","type":"function","z":"effccbe2.760e38","name":"global get ip","func":"msg.payload = global.get('wip1')+\".\"+global.get('wip2')+\".\"+global.get('wip3')+\".\"+global.get('wip4');\nmsg.topic = 'wlan0';\nreturn msg;","outputs":1,"noerr":0,"x":780.7024059295654,"y":93,"wires":[["cb6e811e.cf8f1"]]},{"id":"4112c15c.6e4eb","type":"function","z":"effccbe2.760e38","name":"IP","func":"\nvar ip2 = global.set('wip2', msg.payload);\nmsg.topic = 'wip2';\n\nreturn msg;","outputs":1,"noerr":0,"x":408.6190242767334,"y":292.33331871032715,"wires":[["ebc63b11.bee9d8","733ede0d.b59ee"]]},{"id":"cc5c971f.154c48","type":"function","z":"effccbe2.760e38","name":"IP","func":"\nvar ip3 = global.set('wip3', msg.payload);\nmsg.topic = 'wip3';\n\nreturn msg;","outputs":1,"noerr":0,"x":410.6190242767334,"y":327.33331871032715,"wires":[["ebc63b11.bee9d8","c7e1a3e4.7d7c3"]]},{"id":"b61ac85a.bbbc28","type":"function","z":"effccbe2.760e38","name":"IP","func":"\nvar ip4 = global.set('wip4', msg.payload);\nmsg.topic = 'wip4';\n\nreturn msg;","outputs":1,"noerr":0,"x":414.9523677825928,"y":362.99999046325684,"wires":[["ebc63b11.bee9d8","27fd3aa0.9c4c36"]]},{"id":"8eea4376.a62d2","type":"function","z":"effccbe2.760e38","name":"NET","func":"\nvar net1 = global.set('wnet1', msg.payload);\nmsg.topic = 'wnet1';\n\nreturn msg;","outputs":1,"noerr":0,"x":411.6190242767334,"y":400.33331871032715,"wires":[["f1f5de28.10c77","64890294.62452c"]]},{"id":"fd3baa3d.69bd58","type":"function","z":"effccbe2.760e38","name":"NET","func":"\nvar net2 = global.set('wnet2', msg.payload);\nmsg.topic = 'wnet2';\n\nreturn msg;","outputs":1,"noerr":0,"x":412.6190242767334,"y":435.33331871032715,"wires":[["f1f5de28.10c77","7bd12d87.8b0984"]]},{"id":"9235ebc5.2ee2a8","type":"function","z":"effccbe2.760e38","name":"NET","func":"\nvar net3 = global.set('wnet3', msg.payload);\nmsg.topic = 'wnet3';\n\nreturn msg;","outputs":1,"noerr":0,"x":414.6190242767334,"y":470.33331871032715,"wires":[["f1f5de28.10c77","1ca8c1fb.69f99e"]]},{"id":"19f604be.9c1b9b","type":"function","z":"effccbe2.760e38","name":"NET","func":"\nvar net4 = global.set('wnet4', msg.payload);\nmsg.topic = 'wnet4';\n\nreturn msg;","outputs":1,"noerr":0,"x":415.6190242767334,"y":504.33331871032715,"wires":[["f1f5de28.10c77","14059510.529bdb"]]},{"id":"432aa73f.08bdf8","type":"function","z":"effccbe2.760e38","name":"BR","func":"\nvar br1 = global.set('wbr1', msg.payload);\nmsg.topic = 'wbr1';\n\nreturn msg;","outputs":1,"noerr":0,"x":416.6190242767334,"y":542.3333187103271,"wires":[["4601902c.255e4","7b723d5.701edc4"]]},{"id":"480d36c0.a907e8","type":"function","z":"effccbe2.760e38","name":"BR","func":"\nvar br2 = global.set('wbr2', msg.payload);\nmsg.topic = 'wbr2';\n\nreturn msg;","outputs":1,"noerr":0,"x":417.6190242767334,"y":577.3333187103271,"wires":[["4601902c.255e4","6c31aee9.8d055"]]},{"id":"a2987bbb.809da8","type":"function","z":"effccbe2.760e38","name":"BR","func":"\nvar br3 = global.set('wbr3', msg.payload);\nmsg.topic = 'wbr3';\n\nreturn msg;","outputs":1,"noerr":0,"x":419.6190242767334,"y":612.3333187103271,"wires":[["4601902c.255e4","625cd605.445278"]]},{"id":"cebf1e9b.efa87","type":"function","z":"effccbe2.760e38","name":"BR","func":"\nvar br4 = global.set('wbr4', msg.payload);\nmsg.topic = 'wbr4';\n\nreturn msg;","outputs":1,"noerr":0,"x":423.47615814208984,"y":646.3333120346069,"wires":[["4601902c.255e4","a8c46826.a8dad8"]]},{"id":"a2d0bcc2.c9235","type":"function","z":"effccbe2.760e38","name":"RT","func":"\nvar rt1 = global.set('wrt1', msg.payload);\nmsg.topic = 'wrt1';\n\nreturn msg;","outputs":1,"noerr":0,"x":425.6190242767334,"y":681.3333187103271,"wires":[["f2ea8719.947658"]]},{"id":"35f66eaf.7eb7e2","type":"function","z":"effccbe2.760e38","name":"RT","func":"\nvar rt2 = global.set('wrt2', msg.payload);\nmsg.topic = 'wrt2';\n\nreturn msg;","outputs":1,"noerr":0,"x":426.6190242767334,"y":716.3333187103271,"wires":[["2bedddcd.c9ce22"]]},{"id":"346792ca.f8d9ae","type":"function","z":"effccbe2.760e38","name":"RT","func":"\nvar rt3 = global.set('wrt3', msg.payload);\nmsg.topic = 'wrt3';\n\nreturn msg;","outputs":1,"noerr":0,"x":428.6190242767334,"y":751.3333187103271,"wires":[["f876ef87.28271"]]},{"id":"9e7642c5.f847","type":"function","z":"effccbe2.760e38","name":"RT","func":"\nvar rt4 = global.set('wrt4', msg.payload);\nmsg.topic = 'wrt4';\n\nreturn msg;","outputs":1,"noerr":0,"x":429.6190242767334,"y":785.3333187103271,"wires":[["78508094.8adda"]]},{"id":"ae1c9b6a.5a2f78","type":"function","z":"effccbe2.760e38","name":"GT","func":"\nvar gt1 = global.set('wgt1', msg.payload);\nmsg.topic = 'wgt1';\n\nreturn msg;","outputs":1,"noerr":0,"x":431.6190242767334,"y":818.3333187103271,"wires":[["21434bd5.992f44","93aea3dc.0c052"]]},{"id":"1877d1eb.fbb56e","type":"function","z":"effccbe2.760e38","name":"GT","func":"\nvar gt2 = global.set('wgt2', msg.payload);\nmsg.topic = 'wgt2';\n\nreturn msg;","outputs":1,"noerr":0,"x":432.6190242767334,"y":853.3333187103271,"wires":[["21434bd5.992f44","55dbdf80.c7e4d"]]},{"id":"d28e254b.6f2528","type":"function","z":"effccbe2.760e38","name":"GT","func":"\nvar gt3 = global.set('wgt3', msg.payload);\nmsg.topic = 'wgt3';\n\nreturn msg;","outputs":1,"noerr":0,"x":434.6190242767334,"y":888.3333187103271,"wires":[["21434bd5.992f44","e33e50c4.0312f"]]},{"id":"b37f194e.78e858","type":"function","z":"effccbe2.760e38","name":"GT","func":"\nvar gt4 = global.set('wgt4', msg.payload);\nmsg.topic = 'wgt4';\n\nreturn msg;","outputs":1,"noerr":0,"x":435.6190242767334,"y":922.3333187103271,"wires":[["21434bd5.992f44","8ef84805.490b48"]]},{"id":"f1f5de28.10c77","type":"function","z":"effccbe2.760e38","name":"global get netmask","func":"msg.payload = global.get('wnet1')+\".\"+global.get('wnet2')+\".\"+global.get('wnet3')+\".\"+global.get('wnet4');\nmsg.topic = 'wlan0_net';\nreturn msg;","outputs":1,"noerr":0,"x":777.3810520172119,"y":171.82142734527588,"wires":[["94137c6.f91858"]]},{"id":"4601902c.255e4","type":"function","z":"effccbe2.760e38","name":"global get broadcast","func":"msg.payload = global.get('wbr1')+\".\"+global.get('wbr2')+\".\"+global.get('wbr3')+\".\"+global.get('wbr4');\nmsg.topic = 'wlan0_br';\nreturn msg;","outputs":1,"noerr":0,"x":780.0595569610596,"y":133.9642791748047,"wires":[["73962062.4ddae"]]},{"id":"58c4bff6.7d738","type":"function","z":"effccbe2.760e38","name":"global get router","func":"msg.payload = global.get('wrt1')+\".\"+global.get('wrt2')+\".\"+global.get('wrt3')+\".\"+global.get('wrt4');\nmsg.topic = 'wlan0_rt';\nreturn msg;","outputs":1,"noerr":0,"x":784.8810195922852,"y":214.49999618530273,"wires":[["b7cb93c1.f8d24"]]},{"id":"21434bd5.992f44","type":"function","z":"effccbe2.760e38","name":"global get gateway","func":"msg.payload = global.get('wgt1')+\".\"+global.get('wgt2')+\".\"+global.get('wgt3')+\".\"+global.get('wgt4');\nmsg.topic = 'wlan0_gt';\nreturn msg;","outputs":1,"noerr":0,"x":781.3096580505371,"y":260.0357208251953,"wires":[["382920d3.ef762"]]},{"id":"a4ca79b5.9b7558","type":"function","z":"effccbe2.760e38","name":"Set wlan0 ip & broadcast address ","func":"msg.payload = \"ip addr add \"+global.get('wlan0_ip')+\"/24 broadcast \"+global.get('wlan0_broadcast')+\" dev wlan0\"\n\n//msg.payload = global.get('gt1')+\".\"+global.get('gt2')+\".\"+global.get('gt3')+\".\"+global.get('gt4');\nreturn msg;\n","outputs":1,"noerr":0,"x":349.70243726457875,"y":1321.3333234105792,"wires":[["6b746fc.648659"]]},{"id":"c61f087d.fc1968","type":"function","z":"effccbe2.760e38","name":"flush wlan0 ip address ","func":"msg.payload = \"ip addr flush dev wlan0\"\nreturn msg;\n","outputs":1,"noerr":0,"x":306.66672406877797,"y":1271.3333586965289,"wires":[["a5ab98d8.80f0b8"]]},{"id":"360b35f8.fc63aa","type":"function","z":"effccbe2.760e38","name":"IP","func":"\nvar ip1 = global.set('wip1', msg.payload);\nmsg.topic = 'wip1';\n\nreturn msg;","outputs":1,"noerr":0,"x":405.4761714935303,"y":259.904748916626,"wires":[["ebc63b11.bee9d8","effd71d.31dd89"]]},{"id":"b0ecc98c.27df38","type":"function","z":"effccbe2.760e38","name":"Set wlan0 netmask","func":"msg.payload = \"ifconfig wlan0 netmask \"+global.get('wlan0_netmask')\nreturn msg;\n","outputs":1,"noerr":0,"x":349.5238331386022,"y":1387.0476054464068,"wires":[["49724c5e.6c38c4","d2cf9211.c3c38"]]},{"id":"5dd376c4.39e6b8","type":"vis in","z":"effccbe2.760e38","language":"en","x":77.6190242767334,"y":342.33331871032715,"wires":[["3a2f4c69.a642a4"]]},{"id":"f81ace61.e2fec","type":"function","z":"effccbe2.760e38","name":"global get network password","func":"msg.payload = global.get('wnet_password');\nmsg.topic = 'wnet_password';\nreturn msg;","outputs":1,"noerr":0,"x":1443.9682072230748,"y":1614.825410774776,"wires":[[]]},{"id":"effd71d.31dd89","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.2380142211914,"y":321.8094205856323,"wires":[["7c87e175.405a9","46fd263.bbbafd8"],[]]},{"id":"ac365c97.26454","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":1181.7459714374845,"y":1619.7460385806978,"wires":[["f81ace61.e2fec"]]},{"id":"cb6e811e.cf8f1","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/ip","x":1245.9524021148682,"y":95.74998760223389,"wires":[]},{"id":"73962062.4ddae","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/broadcast","x":1261.6667461395264,"y":131.4642848968506,"wires":[]},{"id":"94137c6.f91858","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/netmask","x":1251.6667461395264,"y":167.1785717010498,"wires":[]},{"id":"b7cb93c1.f8d24","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/router","x":1243.0952129364014,"y":202.8928508758545,"wires":[]},{"id":"382920d3.ef762","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/gateway","x":1251.6667461395264,"y":242.89286613464355,"wires":[]},{"id":"6ac0991f.1a74d8","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/ip","error":false,"x":1368.095157623291,"y":1275.6190476417542,"wires":[["db606f11.14621"]]},{"id":"e04be36d.96084","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/broadcast","error":false,"x":1385.2380322047643,"y":1309.9047793660845,"wires":[["ef11af30.28b1a"]]},{"id":"46e97b67.a3b374","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/netmask","error":false,"x":1381.9046783447266,"y":1349.1904830932617,"wires":[["387115a7.1a7bba"]]},{"id":"1a31c413.62e84c","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/gateway","error":false,"x":1375.2380322047643,"y":1411.333337715694,"wires":[["a5900a14.6d9248"]]},{"id":"3fed000c.7cf1c","type":"vis in","z":"effccbe2.760e38","language":"en","x":1138.0952442714147,"y":1214.1904753957476,"wires":[["93cbf91a.90bbe8","2f36718b.4a2c8e"]]},{"id":"93cbf91a.90bbe8","type":"switch","z":"effccbe2.760e38","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"wsave_password","vt":"str"}],"checkall":"true","outputs":1,"x":1192.142828805106,"y":1346.3333415303912,"wires":[["6ac0991f.1a74d8","e04be36d.96084","46e97b67.a3b374","1a31c413.62e84c"]]},{"id":"db606f11.14621","type":"function","z":"effccbe2.760e38","name":"wlan0","func":"\nvar wlan0_ip = global.set('wlan0_ip', msg.payload);\nmsg.topic = 'wlan0_ip';\nreturn msg;","outputs":1,"noerr":0,"x":1589.5237568446569,"y":1238.4761924062457,"wires":[["79130ca7.e576c4"]]},{"id":"387115a7.1a7bba","type":"function","z":"effccbe2.760e38","name":"netmask","func":"var wlan0_netmask = global.set('wlan0_netmask', msg.payload);\nmsg.topic = 'wlan0_netmask';\nreturn msg;","outputs":1,"noerr":0,"x":1576.2024029323034,"y":1317.2976197515216,"wires":[["c3469c1b.56d89"]]},{"id":"ef11af30.28b1a","type":"function","z":"effccbe2.760e38","name":"broacast","func":"var wlan0_broadcast = global.set('wlan0_broadcast', msg.payload);\nmsg.topic = 'wlan0_broadcast';\nreturn msg;","outputs":1,"noerr":0,"x":1593.880892617362,"y":1275.6904696737017,"wires":[["a9a4ab39.4e0978"]]},{"id":"81fe5795.d6d428","type":"function","z":"effccbe2.760e38","name":"router","func":"var wlan0_router = global.set('wlan0_router', msg.payload);\nmsg.topic = 'wlan0_router';\nreturn msg;","outputs":1,"noerr":0,"x":1573.7023705073766,"y":1359.9761885915484,"wires":[["a7e78778.e31238"]]},{"id":"a5900a14.6d9248","type":"function","z":"effccbe2.760e38","name":"gateway","func":"var wlan0_gateway = global.set('wlan0_gateway', msg.payload);\nmsg.topic = 'wlan0_gateway';\nreturn msg;","outputs":1,"noerr":0,"x":1580.1310089656286,"y":1405.511913231441,"wires":[["72f212a2.e106dc"]]},{"id":"79130ca7.e576c4","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1855.2381886073522,"y":1259.904759338924,"wires":[]},{"id":"c3469c1b.56d89","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1843.1668499537877,"y":1339.976190498897,"wires":[]},{"id":"a9a4ab39.4e0978","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1860.8453396388463,"y":1298.3690404210772,"wires":[]},{"id":"a7e78778.e31238","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1850.666817528861,"y":1382.654759338924,"wires":[]},{"id":"72f212a2.e106dc","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1847.095455987113,"y":1428.1904839788165,"wires":[]},{"id":"a3c3b595.d5bb48","type":"function","z":"effccbe2.760e38","name":"global get wlan0","func":"msg.payload = global.get('wlan0_ip');\n//msg.topic = 'wlan0_ip';\nreturn msg;","outputs":1,"noerr":0,"x":1418.095190865653,"y":1508.4761704717364,"wires":[["1c3babab.106924"]]},{"id":"74818e7e.19a91","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":1186.6666325160436,"y":1519.904777458736,"wires":[["a3c3b595.d5bb48"]]},{"id":"1c3babab.106924","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1805.2381046840123,"y":1514.1904830251422,"wires":[]},{"id":"338a590a.428516","type":"vis in","z":"effccbe2.760e38","language":"en","x":55,"y":1074.6666994094849,"wires":[["17a0f5fd.ab086a"]]},{"id":"17a0f5fd.ab086a","type":"switch","z":"effccbe2.760e38","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"wsave_password","vt":"str"}],"checkall":"true","outputs":1,"x":97.61903054373607,"y":1148.476293700082,"wires":[["19c199dd.d4d9c6"]]},{"id":"19c199dd.d4d9c6","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":252.1428680419922,"y":1152.047682762146,"wires":[["32bde616.448a7a"]]},{"id":"7c87e175.405a9","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/ip1","x":1237.8571949005127,"y":311.3332767486572,"wires":[]},{"id":"d6cd04fd.f616d8","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/ip2","x":1237.8571853637695,"y":345.6189842224121,"wires":[]},{"id":"8ae7e9e7.355538","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/ip3","x":1239.285774230957,"y":379.9047203063965,"wires":[]},{"id":"7a90ba6b.2c53f4","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/ip4","x":1240.7143630981445,"y":414.19042587280273,"wires":[]},{"id":"bff7ea5b.2e9188","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/net1","x":1239.2857360839844,"y":449.9047212600708,"wires":[]},{"id":"609d73be.acab9c","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/net2","x":1239.2857265472412,"y":484.1904287338257,"wires":[]},{"id":"a0497bfb.0d8ed8","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/net3","x":1240.7143154144287,"y":518.4761648178101,"wires":[]},{"id":"c8ac4ae7.485448","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/net4","x":1242.1429042816162,"y":552.7618703842163,"wires":[]},{"id":"da84c160.3adb1","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/br1","x":1242.1429138183594,"y":589.9046907424927,"wires":[]},{"id":"49a1bb74.c5a574","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/br2","x":1242.1429042816162,"y":624.1903982162476,"wires":[]},{"id":"324121.33d0bee","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/br3","x":1243.5714931488037,"y":658.4761343002319,"wires":[]},{"id":"8241967.addc568","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/br4","x":1245.0000820159912,"y":692.7618398666382,"wires":[]},{"id":"fc8889c7.0bde08","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/gt1","x":1252.6189880371094,"y":872.9999055862427,"wires":[]},{"id":"9c5a1dd8.fb8cc","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/gt2","x":1252.6189785003662,"y":907.2856130599976,"wires":[]},{"id":"fb2982a6.23c4f","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/gt3","x":1254.0475673675537,"y":941.5713491439819,"wires":[]},{"id":"70c115dc.ea869c","type":"DataIn","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","update":false,"path":"/gt4","x":1255.4761562347412,"y":975.8570547103882,"wires":[]},{"id":"76b7525.18d47ac","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/ip1","error":false,"x":1576.5833168029772,"y":241.21430015563942,"wires":[["1c1c76d7.1eef19"]]},{"id":"df57af8.396e55","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/ip2","error":false,"x":1576.5833168029776,"y":314.2143001556394,"wires":[["1841f764.a9c4b9"]]},{"id":"62169ac1.30ecd4","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/ip3","error":false,"x":1575.8333168029776,"y":347.4643001556394,"wires":[["ed4f4028.4ba67"]]},{"id":"297b9e2c.1955d2","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/ip4","error":false,"x":1575.833316802978,"y":379.46430015563953,"wires":[["b753f038.75f15"]]},{"id":"80ab998a.4d5218","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/net1","error":false,"x":1575.8333168029776,"y":413.7143001556394,"wires":[["54fce99e.9568b8"]]},{"id":"f8c78eae.38382","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/net2","error":false,"x":1575.833316802978,"y":445.71430015563953,"wires":[["9797cfee.43379"]]},{"id":"3dbfca8f.31b106","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/net3","error":false,"x":1575.083316802978,"y":478.96430015563953,"wires":[["125184.e49b7e7c"]]},{"id":"8d4cd862.763608","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/net4","error":false,"x":1575.0833168029785,"y":510.96430015563965,"wires":[["41af7256.80429c"]]},{"id":"4b7565f5.5a507c","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/br1","error":false,"x":1572.0833168029776,"y":543.7143001556394,"wires":[["8046668d.395e88"]]},{"id":"2141f83e.f27ce8","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/br2","error":false,"x":1572.083316802978,"y":575.7143001556394,"wires":[["bca75f06.d0869"]]},{"id":"164afb80.f60874","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/br3","error":false,"x":1571.333316802978,"y":608.9643001556394,"wires":[["4c363ce2.bcf5f4"]]},{"id":"70ac96fd.9c02b8","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/br4","error":false,"x":1571.3333168029785,"y":640.9643001556396,"wires":[["887d9e10.d283c"]]},{"id":"f7a08d58.d7095","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/gt1","error":false,"x":1568.3333168029776,"y":804.9643001556394,"wires":[["165a3e5d.ec77f2"]]},{"id":"a5415aca.3ecf08","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/gt2","error":false,"x":1568.333316802978,"y":836.9643001556396,"wires":[["5d8205d0.dbc87c"]]},{"id":"268844f2.61868c","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/gt3","error":false,"x":1567.583316802978,"y":870.2143001556396,"wires":[["1b761bd2.3b5784"]]},{"id":"514bbc2c.a9c954","type":"DataOut","z":"effccbe2.760e38","collection":"63bebb30.430614","name":"","path":"/gt4","error":false,"x":1567.5833168029785,"y":902.2143001556396,"wires":[["7c87f485.437cfc"]]},{"id":"599b1166.3940d","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"","payloadType":"str","repeat":"20","crontab":"","once":true,"x":1388.3332939147936,"y":294.96429634094216,"wires":[["76b7525.18d47ac","df57af8.396e55","62169ac1.30ecd4","297b9e2c.1955d2","80ab998a.4d5218","f8c78eae.38382","3dbfca8f.31b106","8d4cd862.763608"]]},{"id":"863f49c2.7239a8","type":"inject","z":"effccbe2.760e38","name":"Add Gateway","topic":"","payload":" route add default gw 192.168.0.1 dev wlan0","payloadType":"str","repeat":"","crontab":"","once":false,"x":350.5356979370117,"y":1550.5000534057617,"wires":[["c203db2f.82bea8"]]},{"id":"67617ee8.c3173","type":"bigexec","z":"effccbe2.760e38","name":"Set Gateway","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":810.369026184082,"y":1469.7499914169312,"wires":[[],[],[]]},{"id":"c203db2f.82bea8","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":589.369026184082,"y":1457.7499914169312,"wires":[["67617ee8.c3173"]]},{"id":"d2cf9211.c3c38","type":"function","z":"effccbe2.760e38","name":"Add wlan0 gateway","func":"msg.payload = \"route add default gw \"+global.get('wlan0_gateway')+\" dev wlan0\"\nreturn msg;\n\n //route del default gw 192.168.0.1 dev wlan0","outputs":1,"noerr":0,"x":337.61903381347656,"y":1455.500012397766,"wires":[["c203db2f.82bea8"]]},{"id":"2f36718b.4a2c8e","type":"switch","z":"effccbe2.760e38","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"wactive_save","vt":"str"}],"checkall":"true","outputs":1,"x":1399.761848449707,"y":1201.3927946090698,"wires":[["9f268783.bd3b28"]]},{"id":"9f268783.bd3b28","type":"function","z":"effccbe2.760e38","name":"active_save","func":"\nvar wlan0_ip = global.set('wactive_save', msg.payload);\nmsg.topic = 'wactive_save';\nreturn msg;","outputs":1,"noerr":0,"x":1591.0118713378906,"y":1200.142809867859,"wires":[["887e520a.f2863"]]},{"id":"733ede0d.b59ee","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":799.0476150512695,"y":357.2856969833374,"wires":[["d6cd04fd.f616d8"],[]]},{"id":"c7e1a3e4.7d7c3","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":798.7619094848633,"y":392.42858028411865,"wires":[["8ae7e9e7.355538"],[]]},{"id":"27fd3aa0.9c4c36","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.9047317504883,"y":425.7142858505249,"wires":[["7a90ba6b.2c53f4"],[]]},{"id":"64890294.62452c","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.476203918457,"y":460.1428442001343,"wires":[["bff7ea5b.2e9188"],[]]},{"id":"7bd12d87.8b0984","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":799.2858047485352,"y":495.61912059783936,"wires":[["609d73be.acab9c"],[]]},{"id":"1ca8c1fb.69f99e","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":799.0000991821289,"y":530.7620038986206,"wires":[["a0497bfb.0d8ed8"],[]]},{"id":"14059510.529bdb","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":801.1429214477539,"y":564.0477094650269,"wires":[["c8ac4ae7.485448"],[]]},{"id":"7b723d5.701edc4","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":801.9047317504883,"y":600.1428747177124,"wires":[["da84c160.3adb1"],[]]},{"id":"6c31aee9.8d055","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.7143325805664,"y":635.6191511154175,"wires":[["49a1bb74.c5a574"],[]]},{"id":"625cd605.445278","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.4286270141602,"y":670.7620344161987,"wires":[["324121.33d0bee"],[]]},{"id":"a8c46826.a8dad8","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":802.5714492797852,"y":704.047739982605,"wires":[["8241967.addc568"],[]]},{"id":"f2ea8719.947658","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":803.3333206176758,"y":738.7142858505249,"wires":[[],[]]},{"id":"2bedddcd.c9ce22","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":802.1429214477539,"y":774.19056224823,"wires":[[],[]]},{"id":"f876ef87.28271","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":801.8572158813477,"y":809.3334455490112,"wires":[[],[]]},{"id":"78508094.8adda","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":804.0000381469727,"y":842.6191511154175,"wires":[[],[]]},{"id":"93aea3dc.0c052","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":804.7619094848633,"y":875.8571691513062,"wires":[["fc8889c7.0bde08"],[]]},{"id":"55dbdf80.c7e4d","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":803.5715103149414,"y":911.3334455490112,"wires":[["9c5a1dd8.fb8cc"],[]]},{"id":"e33e50c4.0312f","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":803.2858047485352,"y":946.4763288497925,"wires":[["fb2982a6.23c4f"],[]]},{"id":"8ef84805.490b48","type":"function","z":"effccbe2.760e38","name":"Active Changes ","func":"if (global.get ('wactive_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":805.4286270141602,"y":979.7620344161987,"wires":[["70c115dc.ea869c"],[]]},{"id":"1c1c76d7.1eef19","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wip1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6191329956055,"y":262.85713243484497,"wires":[["6d3511e1.0dbfa"]]},{"id":"1841f764.a9c4b9","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wip2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.0476150512695,"y":298.5714330673218,"wires":[["6d3511e1.0dbfa"]]},{"id":"ed4f4028.4ba67","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wip3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.619026184082,"y":334.2856969833374,"wires":[["6d3511e1.0dbfa"]]},{"id":"b753f038.75f15","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wip4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.619026184082,"y":369.99999141693115,"wires":[["6d3511e1.0dbfa"]]},{"id":"54fce99e.9568b8","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wnet1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1736.1904373168945,"y":405.857138633728,"wires":[["6d3511e1.0dbfa"]]},{"id":"9797cfee.43379","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wnet2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6189193725586,"y":441.57143926620483,"wires":[["6d3511e1.0dbfa"]]},{"id":"125184.e49b7e7c","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wnet3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1736.190330505371,"y":477.28570318222046,"wires":[["6d3511e1.0dbfa"]]},{"id":"41af7256.80429c","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wnet4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1736.190330505371,"y":512.9999976158142,"wires":[["6d3511e1.0dbfa"]]},{"id":"8046668d.395e88","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wbr1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.0476150512695,"y":551.5714330673218,"wires":[["51fd59db.fc6e58"]]},{"id":"bca75f06.d0869","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wbr2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1740.4760971069336,"y":587.2857336997986,"wires":[["51fd59db.fc6e58"]]},{"id":"4c363ce2.bcf5f4","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wbr3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.047508239746,"y":622.9999976158142,"wires":[["51fd59db.fc6e58"]]},{"id":"887d9e10.d283c","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wbr4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.047508239746,"y":658.714292049408,"wires":[["51fd59db.fc6e58"]]},{"id":"440a3c12.cfe094","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wrt1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6189193725586,"y":694.5714392662048,"wires":[["51fd59db.fc6e58"]]},{"id":"db3b5cc3.c23ba","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wrt2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.0474014282227,"y":730.2857398986816,"wires":[["51fd59db.fc6e58"]]},{"id":"d9cc5e80.0b2bc","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wrt3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6188125610352,"y":766.0000038146973,"wires":[["51fd59db.fc6e58"]]},{"id":"1de8ddc0.8a8ba2","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wrt4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6188125610352,"y":801.714298248291,"wires":[["51fd59db.fc6e58"]]},{"id":"165a3e5d.ec77f2","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wgt1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.619026184082,"y":834.4285802841187,"wires":[["b69e8891.5ee8f8"]]},{"id":"5d8205d0.dbc87c","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wgt2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.047508239746,"y":870.1428809165955,"wires":[["b69e8891.5ee8f8"]]},{"id":"1b761bd2.3b5784","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wgt3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6189193725586,"y":905.8571448326111,"wires":[["b69e8891.5ee8f8"]]},{"id":"7c87f485.437cfc","type":"change","z":"effccbe2.760e38","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"wgt4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6189193725586,"y":941.5714392662048,"wires":[["b69e8891.5ee8f8"]]},{"id":"6d3511e1.0dbfa","type":"vis in","z":"effccbe2.760e38","language":"en","x":1967.8571014404297,"y":275.38098430633545,"wires":[[]]},{"id":"cfc9e835.5211d8","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":423.3333206176758,"y":218.7142858505249,"wires":[]},{"id":"51fd59db.fc6e58","type":"vis in","z":"effccbe2.760e38","language":"en","x":1979.285530090332,"y":567.9999914169312,"wires":[[]]},{"id":"b69e8891.5ee8f8","type":"vis in","z":"effccbe2.760e38","language":"en","x":2002.619026184082,"y":767.9999914169312,"wires":[[]]},{"id":"91b777cd.4b7ce8","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"","payloadType":"str","repeat":"20","crontab":"","once":true,"x":1380.9522972106934,"y":541.3332929611206,"wires":[["4b7565f5.5a507c","2141f83e.f27ce8","164afb80.f60874","70ac96fd.9c02b8"]]},{"id":"98ad8a7d.cfaa58","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"","payloadType":"str","repeat":"20","crontab":"","once":true,"x":1384.2856521606445,"y":784.6666173934937,"wires":[["f7a08d58.d7095","a5415aca.3ecf08","268844f2.61868c","514bbc2c.a9c954"]]},{"id":"46fd263.bbbafd8","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1036.6666679382324,"y":296.66665744781494,"wires":[]},{"id":"887e520a.f2863","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1829.9998779296875,"y":1178.333251953125,"wires":[]},{"id":"368d15de.246eba","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"0","payloadType":"str","repeat":"","crontab":"","once":false,"x":936.6666666666665,"y":1061.6666666666665,"wires":[["70c115dc.ea869c","fb2982a6.23c4f","9c5a1dd8.fb8cc","fc8889c7.0bde08","8241967.addc568","324121.33d0bee","49a1bb74.c5a574","da84c160.3adb1","c8ac4ae7.485448","a0497bfb.0d8ed8","609d73be.acab9c","bff7ea5b.2e9188","7a90ba6b.2c53f4","8ae7e9e7.355538","d6cd04fd.f616d8","7c87e175.405a9"]]},{"id":"12dab1c6.2d639e","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":582.2857208251953,"y":1319.9999704360962,"wires":[["6f6dc31d.f6d64c","3c9cdd85.274c92"]]},{"id":"11ba9d60.c93343","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":576.2857208251953,"y":1379.9999704360962,"wires":[["95b96350.1f776","19341525.7fc2eb"]]},{"id":"3c9cdd85.274c92","type":"bigexec","z":"b06e8bbc.e7da68","name":"Flush eth0","command":"sudo ","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":801.2857208251953,"y":1321.4999704360962,"wires":[[],[],[]]},{"id":"19341525.7fc2eb","type":"bigexec","z":"b06e8bbc.e7da68","name":"Set eth0 Static IP and Broadcast IP","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":871.2857208251953,"y":1385.9999704360962,"wires":[[],[],[]]},{"id":"9ac86489.75f568","type":"inject","z":"b06e8bbc.e7da68","name":"Set wlan0 Static Routes","topic":"","payload":"ip route add 192.168.0.1 dev eth0","payloadType":"str","repeat":"","crontab":"","once":false,"x":755.2024154663086,"y":1743.083384513855,"wires":[["a5c3d7b1.59f158"]]},{"id":"a5c3d7b1.59f158","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":935.2024154663086,"y":1743.083384513855,"wires":[["b3b02ace.19df78"]]},{"id":"b3b02ace.19df78","type":"bigexec","z":"b06e8bbc.e7da68","name":"Set eth0 Static Routes","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":1192.2024154663086,"y":1742.083384513855,"wires":[[],[],[]]},{"id":"d77c452d.911168","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":572.2857208251953,"y":1438.9999704360962,"wires":[["336c1820.acf538"]]},{"id":"336c1820.acf538","type":"bigexec","z":"b06e8bbc.e7da68","name":"Set eth0 Netmask","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":825.2857208251953,"y":1448.9999704360962,"wires":[[],[],[]]},{"id":"582901d7.b6f34","type":"inject","z":"b06e8bbc.e7da68","name":"Remove Gateway","topic":"","payload":" route del default gw 192.168.0.1 dev eth0","payloadType":"str","repeat":"","crontab":"","once":false,"x":747.2024078369141,"y":1786.8333902359009,"wires":[["ce063d2a.34f63"]]},{"id":"5b6d76d8.94c838","type":"switch","z":"b06e8bbc.e7da68","name":"eth0","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"ip1","vt":"str"},{"t":"eq","v":"ip2","vt":"str"},{"t":"eq","v":"ip3","vt":"str"},{"t":"eq","v":"ip4","vt":"str"},{"t":"eq","v":"net1","vt":"str"},{"t":"eq","v":"net2","vt":"str"},{"t":"eq","v":"net3","vt":"str"},{"t":"eq","v":"net4","vt":"str"},{"t":"eq","v":"br1","vt":"str"},{"t":"eq","v":"br2","vt":"str"},{"t":"eq","v":"br3","vt":"str"},{"t":"eq","v":"br4","vt":"str"},{"t":"eq","v":"rt1","vt":"str"},{"t":"eq","v":"rt2","vt":"str"},{"t":"eq","v":"rt3","vt":"str"},{"t":"eq","v":"rt4","vt":"str"},{"t":"eq","v":"gt1","vt":"str"},{"t":"eq","v":"gt2","vt":"str"},{"t":"eq","v":"gt3","vt":"str"},{"t":"eq","v":"gt4","vt":"str"}],"checkall":"true","outputs":20,"x":232.6190242767334,"y":430.33331871032715,"wires":[["c56675c5.a44ce8"],["8e64a3cd.c6844"],["1631813e.7e956f"],["ccb20b82.b6ac78"],["e9e352a2.d2b7"],["4c668224.293a6c"],["2d95c97d.0468b6"],["df0b81fc.b3f1c"],["c2eee248.05d51"],["3445f09a.ea4ea"],["2bb92d83.362982"],["997a3f71.ba007"],["63b4b808.6bbf98"],["d7957416.caa2f8"],["c90d9eac.7ba58"],["febffc4.b9992"],["733a3dea.7c9184"],["4a832be5.1f82f4"],["e819ba1b.0050e8"],["e93bb9.b9b80448"]]},{"id":"ddb22956.13a628","type":"function","z":"b06e8bbc.e7da68","name":"global get ip","func":"msg.payload = global.get('ip1')+\".\"+global.get('ip2')+\".\"+global.get('ip3')+\".\"+global.get('ip4');\nmsg.topic = 'eth0';\nreturn msg;","outputs":1,"noerr":0,"x":780.7024059295654,"y":137,"wires":[["8e68dd93.938ad"]]},{"id":"8e64a3cd.c6844","type":"function","z":"b06e8bbc.e7da68","name":"IP","func":"\nvar ip2 = global.set('ip2', msg.payload);\nmsg.topic = 'ip2';\n\nreturn msg;","outputs":1,"noerr":0,"x":408.6190242767334,"y":336.33331871032715,"wires":[["ddb22956.13a628","34e1cc23.3e9c34"]]},{"id":"1631813e.7e956f","type":"function","z":"b06e8bbc.e7da68","name":"IP","func":"\nvar ip3 = global.set('ip3', msg.payload);\nmsg.topic = 'ip3';\n\nreturn msg;","outputs":1,"noerr":0,"x":410.6190242767334,"y":371.33331871032715,"wires":[["ddb22956.13a628","bba82bb7.153468"]]},{"id":"ccb20b82.b6ac78","type":"function","z":"b06e8bbc.e7da68","name":"IP","func":"\nvar ip4 = global.set('ip4', msg.payload);\nmsg.topic = 'ip4';\n\nreturn msg;","outputs":1,"noerr":0,"x":414.9523677825928,"y":406.99999046325684,"wires":[["ddb22956.13a628","ab0f2bcd.155658"]]},{"id":"e9e352a2.d2b7","type":"function","z":"b06e8bbc.e7da68","name":"NET","func":"\nvar net1 = global.set('net1', msg.payload);\nmsg.topic = 'net1';\n\nreturn msg;","outputs":1,"noerr":0,"x":411.6190242767334,"y":444.33331871032715,"wires":[["5c8f418.b54bfc","4ebff2bf.f6ceac"]]},{"id":"4c668224.293a6c","type":"function","z":"b06e8bbc.e7da68","name":"NET","func":"\nvar net2 = global.set('net2', msg.payload);\nmsg.topic = 'net2';\n\nreturn msg;","outputs":1,"noerr":0,"x":412.6190242767334,"y":479.33331871032715,"wires":[["5c8f418.b54bfc","9c6cbdcf.e340b"]]},{"id":"2d95c97d.0468b6","type":"function","z":"b06e8bbc.e7da68","name":"NET","func":"\nvar net3 = global.set('net3', msg.payload);\nmsg.topic = 'net3';\n\nreturn msg;","outputs":1,"noerr":0,"x":414.6190242767334,"y":514.3333187103271,"wires":[["5c8f418.b54bfc","bb1c90a1.45836"]]},{"id":"df0b81fc.b3f1c","type":"function","z":"b06e8bbc.e7da68","name":"NET","func":"\nvar net4 = global.set('net4', msg.payload);\nmsg.topic = 'net4';\n\nreturn msg;","outputs":1,"noerr":0,"x":415.6190242767334,"y":548.3333187103271,"wires":[["5c8f418.b54bfc","d0716b9d.e28a28"]]},{"id":"c2eee248.05d51","type":"function","z":"b06e8bbc.e7da68","name":"BR","func":"\nvar br1 = global.set('br1', msg.payload);\nmsg.topic = 'br1';\n\nreturn msg;","outputs":1,"noerr":0,"x":416.6190242767334,"y":586.3333187103271,"wires":[["eef61e10.68b21","54ad067c.355018"]]},{"id":"3445f09a.ea4ea","type":"function","z":"b06e8bbc.e7da68","name":"BR","func":"\nvar br2 = global.set('br2', msg.payload);\nmsg.topic = 'br2';\n\nreturn msg;","outputs":1,"noerr":0,"x":417.6190242767334,"y":621.3333187103271,"wires":[["eef61e10.68b21","b9b2e28a.10cf2"]]},{"id":"2bb92d83.362982","type":"function","z":"b06e8bbc.e7da68","name":"BR","func":"\nvar br3 = global.set('br3', msg.payload);\nmsg.topic = 'br3';\n\nreturn msg;","outputs":1,"noerr":0,"x":419.6190242767334,"y":656.3333187103271,"wires":[["eef61e10.68b21","16bc019d.a55e9e"]]},{"id":"997a3f71.ba007","type":"function","z":"b06e8bbc.e7da68","name":"BR","func":"\nvar br4 = global.set('br4', msg.payload);\nmsg.topic = 'br4';\n\nreturn msg;","outputs":1,"noerr":0,"x":423.47615814208984,"y":690.3333120346069,"wires":[["eef61e10.68b21","95caf0f.ecfd31"]]},{"id":"63b4b808.6bbf98","type":"function","z":"b06e8bbc.e7da68","name":"RT","func":"\nvar rt1 = global.set('rt1', msg.payload);\nmsg.topic = 'rt1';\n\nreturn msg;","outputs":1,"noerr":0,"x":425.6190242767334,"y":725.3333187103271,"wires":[["fcc09991.a63768"]]},{"id":"d7957416.caa2f8","type":"function","z":"b06e8bbc.e7da68","name":"RT","func":"\nvar rt2 = global.set('rt2', msg.payload);\nmsg.topic = 'rt2';\n\nreturn msg;","outputs":1,"noerr":0,"x":426.6190242767334,"y":760.3333187103271,"wires":[["fe966fe2.20841"]]},{"id":"c90d9eac.7ba58","type":"function","z":"b06e8bbc.e7da68","name":"RT","func":"\nvar rt3 = global.set('rt3', msg.payload);\nmsg.topic = 'rt3';\n\nreturn msg;","outputs":1,"noerr":0,"x":428.6190242767334,"y":795.3333187103271,"wires":[["a8bf5ead.87bef"]]},{"id":"febffc4.b9992","type":"function","z":"b06e8bbc.e7da68","name":"RT","func":"\nvar rt4 = global.set('rt4', msg.payload);\nmsg.topic = 'rt4';\n\nreturn msg;","outputs":1,"noerr":0,"x":429.6190242767334,"y":829.3333187103271,"wires":[["c6c1d74a.8bc468"]]},{"id":"733a3dea.7c9184","type":"function","z":"b06e8bbc.e7da68","name":"GT","func":"\nvar gt1 = global.set('gt1', msg.payload);\nmsg.topic = 'gt1';\n\nreturn msg;","outputs":1,"noerr":0,"x":431.6190242767334,"y":862.3333187103271,"wires":[["e01d1247.a34bb","6f4466aa.8a17e8"]]},{"id":"4a832be5.1f82f4","type":"function","z":"b06e8bbc.e7da68","name":"GT","func":"\nvar gt2 = global.set('gt2', msg.payload);\nmsg.topic = 'gt2';\n\nreturn msg;","outputs":1,"noerr":0,"x":432.6190242767334,"y":897.3333187103271,"wires":[["e01d1247.a34bb","e4ad137a.8acbf"]]},{"id":"e819ba1b.0050e8","type":"function","z":"b06e8bbc.e7da68","name":"GT","func":"\nvar gt3 = global.set('gt3', msg.payload);\nmsg.topic = 'gt3';\n\nreturn msg;","outputs":1,"noerr":0,"x":434.6190242767334,"y":932.3333187103271,"wires":[["e01d1247.a34bb","952e0938.a4e788"]]},{"id":"e93bb9.b9b80448","type":"function","z":"b06e8bbc.e7da68","name":"GT","func":"\nvar gt4 = global.set('gt4', msg.payload);\nmsg.topic = 'gt4';\n\nreturn msg;","outputs":1,"noerr":0,"x":435.6190242767334,"y":966.3333187103271,"wires":[["e01d1247.a34bb","3f075711.ea7708"]]},{"id":"5c8f418.b54bfc","type":"function","z":"b06e8bbc.e7da68","name":"global get netmask","func":"msg.payload = global.get('net1')+\".\"+global.get('net2')+\".\"+global.get('net3')+\".\"+global.get('net4');\nmsg.topic = 'eth0_net';\nreturn msg;","outputs":1,"noerr":0,"x":777.3810520172119,"y":215.82142734527588,"wires":[["33599132.814dfe"]]},{"id":"eef61e10.68b21","type":"function","z":"b06e8bbc.e7da68","name":"global get broadcast","func":"msg.payload = global.get('br1')+\".\"+global.get('br2')+\".\"+global.get('br3')+\".\"+global.get('br4');\nmsg.topic = 'eth0_br';\nreturn msg;","outputs":1,"noerr":0,"x":780.0595569610596,"y":177.9642791748047,"wires":[["1eaab4d5.a1fe6b"]]},{"id":"a568f27a.4c0a6","type":"function","z":"b06e8bbc.e7da68","name":"global get router","func":"msg.payload = global.get('rt1')+\".\"+global.get('rt2')+\".\"+global.get('rt3')+\".\"+global.get('rt4');\nmsg.topic = 'eth0_rt';\nreturn msg;","outputs":1,"noerr":0,"x":784.8810195922852,"y":258.49999618530273,"wires":[["9337befd.0fdf1"]]},{"id":"e01d1247.a34bb","type":"function","z":"b06e8bbc.e7da68","name":"global get gateway","func":"msg.payload = global.get('gt1')+\".\"+global.get('gt2')+\".\"+global.get('gt3')+\".\"+global.get('gt4');\nmsg.topic = 'eth0_gt';\nreturn msg;","outputs":1,"noerr":0,"x":781.3096580505371,"y":304.0357208251953,"wires":[["199dac79.9d5574","f753e0fe.492a8"]]},{"id":"6f6dc31d.f6d64c","type":"function","z":"b06e8bbc.e7da68","name":"Set eth0 ip & broadcast address ","func":"msg.payload = \"ip addr add \"+global.get('eth0_ip')+\"/24 broadcast \"+global.get('eth0_broadcast')+\" dev eth0\"\n\n//msg.payload = global.get('gt1')+\".\"+global.get('gt2')+\".\"+global.get('gt3')+\".\"+global.get('gt4');\nreturn msg;\n","outputs":1,"noerr":0,"x":323.0357666015625,"y":1366.9999828338623,"wires":[["11ba9d60.c93343"]]},{"id":"d2b5504.03411b","type":"function","z":"b06e8bbc.e7da68","name":"flush eth0 ip address ","func":"msg.payload = \"ip addr flush dev eth0\"\nreturn msg;\n","outputs":1,"noerr":0,"x":290.0000534057617,"y":1317.000018119812,"wires":[["12dab1c6.2d639e"]]},{"id":"c56675c5.a44ce8","type":"function","z":"b06e8bbc.e7da68","name":"IP","func":"\nvar ip1 = global.set('ip1', msg.payload);\nmsg.topic = 'ip1';\n\nreturn msg;","outputs":1,"noerr":0,"x":405.4761714935303,"y":303.904748916626,"wires":[["ddb22956.13a628","810de751.0c5b18"]]},{"id":"95b96350.1f776","type":"function","z":"b06e8bbc.e7da68","name":"Set eth0 netmask","func":"msg.payload = \"ifconfig eth0 netmask \"+global.get('eth0_netmask')\nreturn msg;\n","outputs":1,"noerr":0,"x":332.85716247558594,"y":1432.71426486969,"wires":[["d77c452d.911168","902e3476.9d87b8"]]},{"id":"ec051f87.b9bdf","type":"vis in","z":"b06e8bbc.e7da68","language":"en","x":77.6190242767334,"y":386.33331871032715,"wires":[["5b6d76d8.94c838"]]},{"id":"f2eb9f28.ef819","type":"function","z":"b06e8bbc.e7da68","name":"global get network password","func":"msg.payload = global.get('net_password');\nmsg.topic = 'net_password';\nreturn msg;","outputs":1,"noerr":0,"x":1443.9682072230748,"y":1658.825410774776,"wires":[[]]},{"id":"810de751.0c5b18","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.2380142211914,"y":365.8094205856323,"wires":[["4f78b9d.cb75f48"],[]]},{"id":"65272055.3837b","type":"inject","z":"b06e8bbc.e7da68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":1181.7459714374845,"y":1663.7460385806978,"wires":[["f2eb9f28.ef819"]]},{"id":"8e68dd93.938ad","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/ip","x":1245.9524021148682,"y":139.7499876022339,"wires":[]},{"id":"1eaab4d5.a1fe6b","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/broadcast","x":1261.6667461395264,"y":175.4642848968506,"wires":[]},{"id":"33599132.814dfe","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/netmask","x":1251.6667461395264,"y":211.1785717010498,"wires":[]},{"id":"9337befd.0fdf1","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/router","x":1243.0952129364014,"y":246.8928508758545,"wires":[]},{"id":"199dac79.9d5574","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/gateway","x":1251.6667461395264,"y":286.89286613464355,"wires":[]},{"id":"fa6e4a88.9d3c38","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/ip","error":false,"x":1368.095157623291,"y":1319.6190476417542,"wires":[["d1aa5f79.ce43b"]]},{"id":"d63c4416.717da8","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/broadcast","error":false,"x":1385.2380322047643,"y":1353.9047793660845,"wires":[["f69dfbfe.9945d8"]]},{"id":"634c97fb.728448","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/netmask","error":false,"x":1375.2380322047643,"y":1388.1904849324908,"wires":[["c5a28569.f247d8"]]},{"id":"9c393ab4.f436f8","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/gateway","error":false,"x":1375.2380322047643,"y":1455.333337715694,"wires":[["f2ae5426.757ce8"]]},{"id":"da69b7af.593ea8","type":"vis in","z":"b06e8bbc.e7da68","language":"en","x":1138.0952442714147,"y":1258.1904753957476,"wires":[["f7bbb714.1f9818","55f2a0fd.66b4f"]]},{"id":"f7bbb714.1f9818","type":"switch","z":"b06e8bbc.e7da68","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"save_password","vt":"str"}],"checkall":"true","outputs":1,"x":1192.142828805106,"y":1390.3333415303912,"wires":[["fa6e4a88.9d3c38","d63c4416.717da8","634c97fb.728448","9c393ab4.f436f8"]]},{"id":"d1aa5f79.ce43b","type":"function","z":"b06e8bbc.e7da68","name":"eth0","func":"\nvar wlan0_ip = global.set('eth0_ip', msg.payload);\nmsg.topic = 'eth0_ip';\nreturn msg;","outputs":1,"noerr":0,"x":1589.5237568446569,"y":1282.4761924062457,"wires":[["cdee55a7.67cb68"]]},{"id":"c5a28569.f247d8","type":"function","z":"b06e8bbc.e7da68","name":"netmask","func":"var wlan0_netmask = global.set('eth0_netmask', msg.payload);\nmsg.topic = 'eth0_netmask';\nreturn msg;","outputs":1,"noerr":0,"x":1576.2024029323034,"y":1361.2976197515216,"wires":[["e91cb3ee.863a9"]]},{"id":"f69dfbfe.9945d8","type":"function","z":"b06e8bbc.e7da68","name":"broacast","func":"var wlan0_broadcast = global.set('eth0_broadcast', msg.payload);\nmsg.topic = 'eth0_broadcast';\nreturn msg;","outputs":1,"noerr":0,"x":1593.880892617362,"y":1319.6904696737017,"wires":[["84aacbd6.5f00a8"]]},{"id":"f7211e52.7384b","type":"function","z":"b06e8bbc.e7da68","name":"router","func":"var wlan0_router = global.set('eth0_router', msg.payload);\nmsg.topic = 'eth0_router';\nreturn msg;","outputs":1,"noerr":0,"x":1573.7023705073766,"y":1403.9761885915484,"wires":[["e0c3157f.cee9e8"]]},{"id":"f2ae5426.757ce8","type":"function","z":"b06e8bbc.e7da68","name":"gateway","func":"var wlan0_gateway = global.set('eth0_gateway', msg.payload);\nmsg.topic = 'eth0_gateway';\nreturn msg;","outputs":1,"noerr":0,"x":1580.1310089656286,"y":1449.511913231441,"wires":[["c8bcfc9a.af419"]]},{"id":"cdee55a7.67cb68","type":"debug","z":"b06e8bbc.e7da68","name":"","active":true,"console":"false","complete":"false","x":1855.2381886073522,"y":1303.904759338924,"wires":[]},{"id":"e91cb3ee.863a9","type":"debug","z":"b06e8bbc.e7da68","name":"","active":true,"console":"false","complete":"false","x":1843.1668499537877,"y":1383.976190498897,"wires":[]},{"id":"84aacbd6.5f00a8","type":"debug","z":"b06e8bbc.e7da68","name":"","active":true,"console":"false","complete":"false","x":1860.8453396388463,"y":1342.3690404210772,"wires":[]},{"id":"e0c3157f.cee9e8","type":"debug","z":"b06e8bbc.e7da68","name":"","active":true,"console":"false","complete":"false","x":1850.666817528861,"y":1426.654759338924,"wires":[]},{"id":"c8bcfc9a.af419","type":"debug","z":"b06e8bbc.e7da68","name":"","active":true,"console":"false","complete":"false","x":1847.095455987113,"y":1472.1904839788165,"wires":[]},{"id":"65e43cfc.758d34","type":"function","z":"b06e8bbc.e7da68","name":"global get eth0","func":"msg.payload = global.get('eth0_ip');\n//msg.topic = 'wlan0_ip';\nreturn msg;","outputs":1,"noerr":0,"x":1418.095190865653,"y":1552.4761704717364,"wires":[["25c29720.cdd708"]]},{"id":"601c7085.fb79a","type":"inject","z":"b06e8bbc.e7da68","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":1186.6666325160436,"y":1563.904777458736,"wires":[["65e43cfc.758d34"]]},{"id":"25c29720.cdd708","type":"debug","z":"b06e8bbc.e7da68","name":"","active":true,"console":"false","complete":"false","x":1805.2381046840123,"y":1558.1904830251422,"wires":[]},{"id":"daa5a42e.127d18","type":"vis in","z":"b06e8bbc.e7da68","language":"en","x":55,"y":1118.6666994094849,"wires":[["92a43fbf.6fe4d"]]},{"id":"92a43fbf.6fe4d","type":"switch","z":"b06e8bbc.e7da68","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"save_password","vt":"str"}],"checkall":"true","outputs":1,"x":97.61903054373602,"y":1192.476293700082,"wires":[["8dc50168.aa4e8"]]},{"id":"8dc50168.aa4e8","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":252.1428680419922,"y":1196.047682762146,"wires":[["c9196096.f46d8"]]},{"id":"4f78b9d.cb75f48","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/ip1","x":1237.8571949005127,"y":355.3332767486572,"wires":[]},{"id":"94ce27c7.e57f08","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/ip2","x":1237.8571853637695,"y":389.6189842224121,"wires":[]},{"id":"4d2dcb7e.0b0204","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/ip3","x":1239.285774230957,"y":423.9047203063965,"wires":[]},{"id":"7d2d386d.ee4f98","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/ip4","x":1240.7143630981445,"y":458.19042587280273,"wires":[]},{"id":"fc011e64.189c2","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/net1","x":1239.2857360839844,"y":493.9047212600708,"wires":[]},{"id":"634b0a2a.9bf734","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/net2","x":1239.2857265472412,"y":528.1904287338257,"wires":[]},{"id":"216c56ec.808c5a","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/net3","x":1240.7143154144287,"y":562.4761648178101,"wires":[]},{"id":"545d1c52.032b84","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/net4","x":1242.1429042816162,"y":596.7618703842163,"wires":[]},{"id":"595f7c73.1016d4","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/br1","x":1242.1429138183594,"y":633.9046907424927,"wires":[]},{"id":"c3aec884.43d548","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/br2","x":1242.1429042816162,"y":668.1903982162476,"wires":[]},{"id":"679eb3f1.d3aa1c","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/br3","x":1243.5714931488037,"y":702.4761343002319,"wires":[]},{"id":"8559923f.bd37f","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/br4","x":1245.0000820159912,"y":736.7618398666382,"wires":[]},{"id":"20f82bb4.b1eb14","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/gt1","x":1252.6189880371094,"y":916.9999055862427,"wires":[]},{"id":"2eaaf43b.b75b8c","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/gt2","x":1252.6189785003662,"y":951.2856130599976,"wires":[]},{"id":"ba215aad.a122b8","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/gt3","x":1254.0475673675537,"y":985.5713491439819,"wires":[]},{"id":"e56cea3c.4d2ca8","type":"DataIn","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","update":false,"path":"/gt4","x":1255.4761562347412,"y":1019.8570547103882,"wires":[]},{"id":"184337c9.224858","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/ip1","error":false,"x":1576.5833168029772,"y":326.2143001556394,"wires":[["286e7cfd.9b3da4"]]},{"id":"9c0ee21.cafaf2","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/ip2","error":false,"x":1576.5833168029776,"y":358.2143001556394,"wires":[["5e5856f0.6a16b8"]]},{"id":"6b40f4f9.9ee80c","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/ip3","error":false,"x":1575.8333168029776,"y":391.4643001556394,"wires":[["1a8309c3.c08636"]]},{"id":"4acff82f.e476d8","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/ip4","error":false,"x":1575.833316802978,"y":423.46430015563953,"wires":[["3a8d670a.e88828"]]},{"id":"78a80f12.da7e3","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/net1","error":false,"x":1575.8333168029776,"y":457.7143001556394,"wires":[["cf5d4968.32ab48"]]},{"id":"9c571ee1.86251","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/net2","error":false,"x":1575.833316802978,"y":489.71430015563953,"wires":[["2babef27.4d7c3"]]},{"id":"a0a40703.6081c8","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/net3","error":false,"x":1575.083316802978,"y":522.9643001556395,"wires":[["c1396151.e901a"]]},{"id":"bec14c9b.9e822","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/net4","error":false,"x":1575.0833168029785,"y":554.9643001556396,"wires":[["e158816c.78bc"]]},{"id":"423779c9.0646d8","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/br1","error":false,"x":1572.0833168029776,"y":587.7143001556394,"wires":[["e0021e78.e5bbd"]]},{"id":"f4e14e27.54faf","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/br2","error":false,"x":1572.083316802978,"y":619.7143001556394,"wires":[["9fe4f238.ba40b"]]},{"id":"ff72ae9f.a9e7d","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/br3","error":false,"x":1571.333316802978,"y":652.9643001556394,"wires":[["6f0259ab.9ea858"]]},{"id":"e988a433.fc6858","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/br4","error":false,"x":1571.3333168029785,"y":684.9643001556396,"wires":[["ded49c1c.471b1"]]},{"id":"5fb5c9f6.7e0318","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/gt1","error":false,"x":1568.3333168029776,"y":848.9643001556394,"wires":[["48332113.93467"]]},{"id":"68c0401f.3bed1","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/gt2","error":false,"x":1568.333316802978,"y":880.9643001556396,"wires":[["3602e0d8.f3182"]]},{"id":"1bbdb426.cbe77c","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/gt3","error":false,"x":1567.583316802978,"y":914.2143001556396,"wires":[["2f25f383.b2253c"]]},{"id":"345c7701.aeeee8","type":"DataOut","z":"b06e8bbc.e7da68","collection":"6d847241.48231c","name":"","path":"/gt4","error":false,"x":1567.5833168029785,"y":946.2143001556396,"wires":[["be6f9677.c5d398"]]},{"id":"a58a9931.b22f28","type":"inject","z":"b06e8bbc.e7da68","name":"","topic":"","payload":"","payloadType":"str","repeat":"20","crontab":"","once":true,"x":1388.3332939147936,"y":338.96429634094216,"wires":[["184337c9.224858","9c0ee21.cafaf2","6b40f4f9.9ee80c","4acff82f.e476d8","78a80f12.da7e3","9c571ee1.86251","a0a40703.6081c8","bec14c9b.9e822"]]},{"id":"c785661e.e304b8","type":"inject","z":"b06e8bbc.e7da68","name":"Add Gateway","topic":"","payload":" route add default gw 192.168.0.1 dev eth0","payloadType":"str","repeat":"","crontab":"","once":false,"x":350.5356979370117,"y":1594.5000534057617,"wires":[["b8d4683b.6e4578"]]},{"id":"61121397.41380c","type":"bigexec","z":"b06e8bbc.e7da68","name":"Set Gateway","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":810.369026184082,"y":1513.7499914169312,"wires":[[],[],[]]},{"id":"b8d4683b.6e4578","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":589.369026184082,"y":1501.7499914169312,"wires":[["61121397.41380c"]]},{"id":"902e3476.9d87b8","type":"function","z":"b06e8bbc.e7da68","name":"Add eth0 gateway","func":"msg.payload = \"route add default gw \"+global.get('eth0_gateway')+\" dev eth0\"\nreturn msg;\n\n //route del default gw 192.168.0.1 dev wlan0","outputs":1,"noerr":0,"x":337.61903381347656,"y":1499.500012397766,"wires":[["b8d4683b.6e4578"]]},{"id":"55f2a0fd.66b4f","type":"switch","z":"b06e8bbc.e7da68","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"active_save","vt":"str"}],"checkall":"true","outputs":1,"x":1399.761848449707,"y":1245.3927946090698,"wires":[["9bfdf7ed.ea1568"]]},{"id":"9bfdf7ed.ea1568","type":"function","z":"b06e8bbc.e7da68","name":"active_save","func":"\nvar wlan0_ip = global.set('active_save', msg.payload);\nmsg.topic = 'active_save';\nreturn msg;","outputs":1,"noerr":0,"x":1591.0118713378906,"y":1244.142809867859,"wires":[[]]},{"id":"34e1cc23.3e9c34","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":799.0476150512695,"y":401.2856969833374,"wires":[["94ce27c7.e57f08"],[]]},{"id":"bba82bb7.153468","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":798.7619094848633,"y":436.42858028411865,"wires":[["4d2dcb7e.0b0204"],[]]},{"id":"ab0f2bcd.155658","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.9047317504883,"y":469.7142858505249,"wires":[["7d2d386d.ee4f98"],[]]},{"id":"4ebff2bf.f6ceac","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.476203918457,"y":504.1428442001343,"wires":[["fc011e64.189c2"],[]]},{"id":"9c6cbdcf.e340b","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":799.2858047485352,"y":539.6191205978394,"wires":[["634b0a2a.9bf734"],[]]},{"id":"bb1c90a1.45836","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":799.0000991821289,"y":574.7620038986206,"wires":[["216c56ec.808c5a"],[]]},{"id":"d0716b9d.e28a28","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":801.1429214477539,"y":608.0477094650269,"wires":[["545d1c52.032b84"],[]]},{"id":"54ad067c.355018","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":801.9047317504883,"y":644.1428747177124,"wires":[["595f7c73.1016d4"],[]]},{"id":"b9b2e28a.10cf2","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.7143325805664,"y":679.6191511154175,"wires":[["c3aec884.43d548"],[]]},{"id":"16bc019d.a55e9e","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":800.4286270141602,"y":714.7620344161987,"wires":[["679eb3f1.d3aa1c"],[]]},{"id":"95caf0f.ecfd31","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":802.5714492797852,"y":748.047739982605,"wires":[["8559923f.bd37f"],[]]},{"id":"fcc09991.a63768","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":803.3333206176758,"y":782.7142858505249,"wires":[[],[]]},{"id":"fe966fe2.20841","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":802.1429214477539,"y":818.19056224823,"wires":[[],[]]},{"id":"a8bf5ead.87bef","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":801.8572158813477,"y":853.3334455490112,"wires":[[],[]]},{"id":"c6c1d74a.8bc468","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":804.0000381469727,"y":886.6191511154175,"wires":[[],[]]},{"id":"6f4466aa.8a17e8","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":804.7619094848633,"y":919.8571691513062,"wires":[["20f82bb4.b1eb14"],[]]},{"id":"e4ad137a.8acbf","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":803.5715103149414,"y":955.3334455490112,"wires":[["2eaaf43b.b75b8c"],[]]},{"id":"952e0938.a4e788","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":803.2858047485352,"y":990.4763288497925,"wires":[["ba215aad.a122b8"],[]]},{"id":"3f075711.ea7708","type":"function","z":"b06e8bbc.e7da68","name":"Active Changes ","func":"if (global.get ('active_save') == 1) {\nmsg.payload = msg.payload;\nreturn msg;\n} else\nmsg.payload = null;\nreturn msg.none;","outputs":"2","noerr":0,"x":805.4286270141602,"y":1023.7620344161987,"wires":[["e56cea3c.4d2ca8"],[]]},{"id":"286e7cfd.9b3da4","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"ip1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6191329956055,"y":306.85713243484497,"wires":[["6b32f758.4a7338"]]},{"id":"5e5856f0.6a16b8","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"ip2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.0476150512695,"y":342.5714330673218,"wires":[["6b32f758.4a7338"]]},{"id":"1a8309c3.c08636","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"ip3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.619026184082,"y":378.2856969833374,"wires":[["6b32f758.4a7338"]]},{"id":"3a8d670a.e88828","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"ip4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.619026184082,"y":413.99999141693115,"wires":[["6b32f758.4a7338"]]},{"id":"cf5d4968.32ab48","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"net1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1736.1904373168945,"y":449.857138633728,"wires":[["6b32f758.4a7338"]]},{"id":"2babef27.4d7c3","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"net2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6189193725586,"y":485.57143926620483,"wires":[["6b32f758.4a7338"]]},{"id":"c1396151.e901a","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"net3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1736.190330505371,"y":521.2857031822205,"wires":[["6b32f758.4a7338"]]},{"id":"e158816c.78bc","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"net4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1736.190330505371,"y":556.9999976158142,"wires":[["6b32f758.4a7338"]]},{"id":"e0021e78.e5bbd","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"br1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.0476150512695,"y":595.5714330673218,"wires":[["9f55f2aa.6fcd5"]]},{"id":"9fe4f238.ba40b","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"br2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1740.4760971069336,"y":631.2857336997986,"wires":[["9f55f2aa.6fcd5"]]},{"id":"6f0259ab.9ea858","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"br3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.047508239746,"y":666.9999976158142,"wires":[["9f55f2aa.6fcd5"]]},{"id":"ded49c1c.471b1","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"br4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.047508239746,"y":702.714292049408,"wires":[["9f55f2aa.6fcd5"]]},{"id":"7509ae04.5a514","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"rt1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6189193725586,"y":738.5714392662048,"wires":[["9f55f2aa.6fcd5"]]},{"id":"c6711a67.ec3f88","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"rt2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.0474014282227,"y":774.2857398986816,"wires":[["9f55f2aa.6fcd5"]]},{"id":"f65790c7.228b7","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"rt3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6188125610352,"y":810.0000038146973,"wires":[["9f55f2aa.6fcd5"]]},{"id":"bc950d14.6476b","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"rt4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6188125610352,"y":845.714298248291,"wires":[["9f55f2aa.6fcd5"]]},{"id":"48332113.93467","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"gt1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.619026184082,"y":878.4285802841187,"wires":[["d0688362.5d8dd"]]},{"id":"3602e0d8.f3182","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"gt2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1739.047508239746,"y":914.1428809165955,"wires":[["d0688362.5d8dd"]]},{"id":"2f25f383.b2253c","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"gt3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6189193725586,"y":949.8571448326111,"wires":[["d0688362.5d8dd"]]},{"id":"be6f9677.c5d398","type":"change","z":"b06e8bbc.e7da68","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"gt4","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1737.6189193725586,"y":985.5714392662048,"wires":[["d0688362.5d8dd"]]},{"id":"6b32f758.4a7338","type":"vis in","z":"b06e8bbc.e7da68","language":"en","x":1967.8571014404297,"y":319.38098430633545,"wires":[[]]},{"id":"9f55f2aa.6fcd5","type":"vis in","z":"b06e8bbc.e7da68","language":"en","x":1979.285530090332,"y":611.9999914169312,"wires":[[]]},{"id":"d0688362.5d8dd","type":"vis in","z":"b06e8bbc.e7da68","language":"en","x":2002.619026184082,"y":811.9999914169312,"wires":[[]]},{"id":"cb38c3ba.e90e6","type":"inject","z":"b06e8bbc.e7da68","name":"","topic":"","payload":"","payloadType":"str","repeat":"20","crontab":"","once":true,"x":1380.9522972106934,"y":585.3332929611206,"wires":[["423779c9.0646d8","f4e14e27.54faf","ff72ae9f.a9e7d","e988a433.fc6858"]]},{"id":"fb5591f3.93e3b","type":"inject","z":"b06e8bbc.e7da68","name":"","topic":"","payload":"","payloadType":"str","repeat":"20","crontab":"","once":true,"x":1384.2856521606445,"y":828.6666173934937,"wires":[["5fb5c9f6.7e0318","68c0401f.3bed1","1bbdb426.cbe77c","345c7701.aeeee8"]]},{"id":"8349d406.608c98","type":"inject","z":"b06e8bbc.e7da68","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":136.33333206176758,"y":1030.3333339691162,"wires":[["8dc50168.aa4e8"]]},{"id":"6edbc029.9be4f","type":"inject","z":"b06e8bbc.e7da68","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":117.14286041259766,"y":1467.142822265625,"wires":[["902e3476.9d87b8"]]},{"id":"f753e0fe.492a8","type":"debug","z":"b06e8bbc.e7da68","name":"","active":true,"console":"false","complete":"false","x":1048.5714111328125,"y":324.28570556640625,"wires":[]},{"id":"7c51c78a.09bca8","type":"bigexec","z":"b06e8bbc.e7da68","name":"Set Gateway","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":1178.333251953125,"y":1814.9998779296875,"wires":[[],[],[]]},{"id":"ce063d2a.34f63","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":931.6666259765625,"y":1796.6666259765625,"wires":[["7c51c78a.09bca8"]]},{"id":"c9196096.f46d8","type":"function","z":"b06e8bbc.e7da68","name":"Revove eth0 Gateway","func":"msg.payload = \"route del default gw \"+global.get('eth0_gateway')+\" dev eth0\"\nreturn msg;\n\n //route del default gw 192.168.0.1 dev wlan0","outputs":1,"noerr":0,"x":300.9524154663086,"y":1265.0000042915344,"wires":[["7946d003.fa2ae"]]},{"id":"7946d003.fa2ae","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":574.785774230957,"y":1267.3332977294922,"wires":[["e5e085a6.9b3348","617fe49d.c8f9cc"]]},{"id":"e5e085a6.9b3348","type":"bigexec","z":"b06e8bbc.e7da68","name":"Remove Gateway","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":817.4524078369141,"y":1265.999882698059,"wires":[[],[],[]]},{"id":"617fe49d.c8f9cc","type":"delay","z":"b06e8bbc.e7da68","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":93.33333587646484,"y":1313.3333854675293,"wires":[["d2b5504.03411b"]]},{"id":"71dbc53a.08c6ac","type":"bigexec","z":"effccbe2.760e38","name":"Set Gateway","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":823.1666706630162,"y":1225,"wires":[[],[],[]]},{"id":"8fb0568b.f39e78","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":602.1666706630162,"y":1213,"wires":[["71dbc53a.08c6ac","c2f68f8c.1e286"]]},{"id":"32bde616.448a7a","type":"function","z":"effccbe2.760e38","name":"Revove wlan0 Gateway","func":"msg.payload = \"route del default gw \"+global.get('wlan0_gateway')+\" dev wlan0\"\nreturn msg;\n\n //route del default gw 192.168.0.1 dev wlan0","outputs":1,"noerr":0,"x":353.33331298828125,"y":1210.6667032923017,"wires":[["8fb0568b.f39e78"]]},{"id":"c2f68f8c.1e286","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":121.66667175292969,"y":1271.6666746139526,"wires":[["c61f087d.fc1968"]]},{"id":"5663fba5.2de714","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"1","payloadType":"str","repeat":"","crontab":"","once":false,"x":123.33333969116211,"y":1033.3333721160889,"wires":[["19c199dd.d4d9c6"]]},{"id":"717f1f07.7715b","type":"bigexec","z":"effccbe2.760e38","name":"Set Gateway","command":"sudo","commandArgs":"","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"argument","x":1170,"y":1758.333251953125,"wires":[[],[],[]]},{"id":"577a2b0c.e04194","type":"delay","z":"effccbe2.760e38","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":949,"y":1746.333251953125,"wires":[["717f1f07.7715b"]]},{"id":"604d5e12.2e0ff","type":"debug","z":"effccbe2.760e38","name":"","active":true,"console":"false","complete":"false","x":1021.6666259765625,"y":1256.6666259765625,"wires":[]},{"id":"e13f8ad2.719628","type":"inject","z":"b06e8bbc.e7da68","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":1134.9999999999998,"y":1128.3333333333333,"wires":[["fa6e4a88.9d3c38","d63c4416.717da8","634c97fb.728448","9c393ab4.f436f8"]]},{"id":"a59b9481.1dc3d8","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"1","payloadType":"str","repeat":"","crontab":"","once":false,"x":1084.9999999999998,"y":1134.9999999999998,"wires":[["6ac0991f.1a74d8","e04be36d.96084","1a31c413.62e84c","46e97b67.a3b374"]]},{"id":"e24ef240.486f9","type":"inject","z":"effccbe2.760e38","name":"","topic":"","payload":"1","payloadType":"str","repeat":"","crontab":"","once":false,"x":1225,"y":1106.6666259765625,"wires":[["46e97b67.a3b374"]]},{"id":"64a650b2.79e52","type":"modbus-write","z":"4575c9f5.6d3c98","name":"","showStatusActivities":true,"unitid":"","dataType":"HoldingRegister","adr":"3","quantity":"1","server":"c7bf2fd0.3893d","x":566,"y":237,"wires":[[],[]]},{"id":"f88d2c72.88fa2","type":"vis in","z":"4575c9f5.6d3c98","language":"en","x":152,"y":213,"wires":[["dd4be568.8701a8"]]},{"id":"dd4be568.8701a8","type":"switch","z":"4575c9f5.6d3c98","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"speed","vt":"str"}],"checkall":"true","outputs":1,"x":336,"y":205,"wires":[["64a650b2.79e52"]]},{"id":"b5d7aca6.0af81","type":"inject","z":"4575c9f5.6d3c98","name":"","topic":"","payload":"6000","payloadType":"str","repeat":"","crontab":"","once":false,"x":106,"y":134,"wires":[["64a650b2.79e52"]]},{"id":"16660337.e8b88d","type":"inject","z":"4575c9f5.6d3c98","name":"","topic":"","payload":"5000","payloadType":"str","repeat":"","crontab":"","once":false,"x":107,"y":93,"wires":[["64a650b2.79e52"]]},{"id":"f5c364a0.86f2f8","type":"modbus-write","z":"4575c9f5.6d3c98","name":"","showStatusActivities":true,"unitid":"","dataType":"Coil","adr":"16384","quantity":"1","server":"c7bf2fd0.3893d","x":569,"y":318,"wires":[[],[]]},{"id":"c5a086cc.8a4ca8","type":"inject","z":"4575c9f5.6d3c98","name":"","topic":"","payload":"1","payloadType":"str","repeat":"","crontab":"","once":false,"x":186,"y":295,"wires":[["f5c364a0.86f2f8"]]},{"id":"60226085.03dc5","type":"inject","z":"4575c9f5.6d3c98","name":"","topic":"","payload":"0","payloadType":"str","repeat":"","crontab":"","once":false,"x":192,"y":338,"wires":[["f5c364a0.86f2f8"]]},{"id":"c1a25e7a.a2879","type":"bigexec","z":"ad95d4a5.52ad28","name":"git pull","command":"sudo ","commandArgs":"git pull","minError":1,"minWarning":1,"cwd":"modules","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"triggerNoStdin","x":428,"y":383.5,"wires":[["7e2bfdb1.239f54"],[],[]]},{"id":"4d108709.9ff7c8","type":"inject","z":"ad95d4a5.52ad28","name":"","topic":"","payload":"","payloadType":"num","repeat":"","crontab":"","once":false,"x":211,"y":393,"wires":[["c1a25e7a.a2879"]]},{"id":"7e2bfdb1.239f54","type":"delay","z":"ad95d4a5.52ad28","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":585,"y":373,"wires":[["9dac647f.ccae38"]]},{"id":"9dac647f.ccae38","type":"bigexec","z":"ad95d4a5.52ad28","name":"copy to node red","command":"sudo","commandArgs":"cp /home/pi/modules/flows.json /home/pi/.node-red/flows_casi.json","minError":1,"minWarning":1,"cwd":"","shell":true,"extraArgumentProperty":"","envProperty":"","format":"","limiter":true,"payloadIs":"triggerNoStdin","x":806,"y":381.5,"wires":[[],[],[]]},{"id":"d084a6d4.cb5298","type":"inject","z":"ad95d4a5.52ad28","name":"test","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":252,"y":492,"wires":[[]]}]
